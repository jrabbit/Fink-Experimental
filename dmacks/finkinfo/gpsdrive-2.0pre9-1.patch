diff -Nurd -x'*~' gpsdrive-2.0pre9.orig/configure.ac gpsdrive-2.0pre9/configure.ac
--- gpsdrive-2.0pre9.orig/configure.ac	2003-06-22 22:10:50.000000000 -0400
+++ gpsdrive-2.0pre9/configure.ac	2003-06-23 01:59:18.000000000 -0400
@@ -152,7 +152,7 @@
 dnl ************************
 dnl Checks for header files.
 dnl ************************
-AC_CHECK_HEADERS(sys/types.h sys/termios.h termio.h termios.h sys/stat.h fcntl.h stdio.h unistd.h  netdb.h X11/X.h)
+AC_CHECK_HEADERS(sys/types.h sys/termios.h termio.h termios.h sys/stat.h fcntl.h stdio.h unistd.h  netdb.h X11/X.h linux/inet.h)
 
 
 dnl Checks select argument types
@@ -225,6 +225,13 @@
         echo "Using $CC $CFLAGS"
 ])
 
+dnl ************************
+dnl crypt.h and libcrypt
+dnl ************************
+AC_CHECK_HEADERS(crypt.h)
+AC_CHECK_LIB(crypt,crypt)
+
+
 
 CFLAGS="$CFLAGS -Imysql"
 
diff -Nurd -x'*~' gpsdrive-2.0pre9.orig/src/Makefile.am gpsdrive-2.0pre9/src/Makefile.am
--- gpsdrive-2.0pre9.orig/src/Makefile.am	2003-06-22 22:10:51.000000000 -0400
+++ gpsdrive-2.0pre9/src/Makefile.am	2003-06-23 01:59:55.000000000 -0400
@@ -12,7 +12,7 @@
 LIBS=
 
 # gpsdrive_LDADD= $(GLIB_LIBS) $(GTK_LIBS) $(PIXLIBS)
-gpsdrive_LDADD=@LIBS@ -lcrypt
+gpsdrive_LDADD=@LIBS@
 #gpsdrive_LDADD= @XLIBS@
 # gpsdrive_CFLAGS=@CFLAGS@
 # libgpsd_a_CFLAGS=@CFLAGS@
@@ -52,7 +52,7 @@
 gpsdrive_DATA = gpsdrivesplash.png friendsicon.png map_GPSWORLD.jpg
 
 server_SOURCES=server.c
-server_LDADD = $(LDADD) $(LIBINTL) -lcrypt
+server_LDADD = $(LDADD) $(LIBINTL)
 
 client_SOURCES=client.c
-client_LDADD = $(LDADD) $(LIBINTL) -lcrypt
+client_LDADD = $(LDADD) $(LIBINTL)
diff -Nurd -x'*~' gpsdrive-2.0pre9.orig/src/Makefile.in gpsdrive-2.0pre9/src/Makefile.in
--- gpsdrive-2.0pre9.orig/src/Makefile.in	2003-06-22 22:10:51.000000000 -0400
+++ gpsdrive-2.0pre9/src/Makefile.in	2003-06-23 01:14:55.000000000 -0400
@@ -156,7 +156,7 @@
 bin_PROGRAMS = $(PRG1) gpsdrive gpsd  friendsd2 server client
 
 # gpsdrive_LDADD= $(GLIB_LIBS) $(GTK_LIBS) $(PIXLIBS)
-gpsdrive_LDADD = @LIBS@ -lcrypt
+gpsdrive_LDADD = @LIBS@
 #gpsdrive_LDADD= @XLIBS@
 # gpsdrive_CFLAGS=@CFLAGS@
 # libgpsd_a_CFLAGS=@CFLAGS@
@@ -189,10 +189,10 @@
 gpsdrive_DATA = gpsdrivesplash.png friendsicon.png map_GPSWORLD.jpg
 
 server_SOURCES = server.c
-server_LDADD = $(LDADD) $(LIBINTL) -lcrypt
+server_LDADD = $(LDADD) $(LIBINTL)
 
 client_SOURCES = client.c
-client_LDADD = $(LDADD) $(LIBINTL) -lcrypt
+client_LDADD = $(LDADD) $(LIBINTL)
 subdir = src
 mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
 CONFIG_HEADER = $(top_builddir)/config.h
diff -Nurd -x'*~' gpsdrive-2.0pre9.orig/src/client.c gpsdrive-2.0pre9/src/client.c
--- gpsdrive-2.0pre9.orig/src/client.c	2003-06-22 22:10:51.000000000 -0400
+++ gpsdrive-2.0pre9/src/client.c	2003-06-23 02:12:02.000000000 -0400
@@ -50,12 +50,17 @@
 #include <stdlib.h>
 #include <string.h>
 #include <unistd.h>
+#ifdef HAVE_CRYPT_H
 #include <crypt.h>
+#endif
 #include <sys/stat.h>
 #include <fcntl.h>
+#ifdef HAVE_LINUX_INET_H
 #include "linux/inet.h"
+#endif
 #include <unistd.h>
 #include <time.h>
+typedef unsigned int socklen_t;
 
 
 #define	SERV_UDP_PORT	50123
diff -Nurd -x'*~' gpsdrive-2.0pre9.orig/src/friends.c gpsdrive-2.0pre9/src/friends.c
--- gpsdrive-2.0pre9.orig/src/friends.c	2003-06-22 22:10:51.000000000 -0400
+++ gpsdrive-2.0pre9/src/friends.c	2003-06-23 02:06:24.000000000 -0400
@@ -57,13 +57,18 @@
 #include <stdlib.h>
 #include <string.h>
 #include <unistd.h>
+#ifdef HAVE_CRYPT_H
 #include <crypt.h>
+#endif
 #include <sys/stat.h>
 #include <fcntl.h>
+#ifdef HAVE_LINUX_INET_H
 #include "linux/inet.h"
+#endif
 #include <unistd.h>
 #include <time.h>
 #include <gpsdrive.h>
+typedef unsigned int socklen_t;
 
 #define	SERV_UDP_PORT	50123
 
diff -Nurd -x'*~' gpsdrive-2.0pre9.orig/src/friendsd.c gpsdrive-2.0pre9/src/friendsd.c
--- gpsdrive-2.0pre9.orig/src/friendsd.c	2003-06-22 22:10:51.000000000 -0400
+++ gpsdrive-2.0pre9/src/friendsd.c	2003-06-23 02:09:55.000000000 -0400
@@ -60,10 +60,13 @@
 #include <stdlib.h>
 #include <string.h>
 #include <signal.h>
+#ifdef HAVE_LINUX_INET_H
 #include "linux/inet.h"
+#endif
 #include <fcntl.h>
 #include <netdb.h>
 #include <gpsdrive.h>
+typedef unsigned int socklen_t;
 
 #define MAXMESG 2048
 
diff -Nurd -x'*~' gpsdrive-2.0pre9.orig/src/gpsdrive.c gpsdrive-2.0pre9/src/gpsdrive.c
--- gpsdrive-2.0pre9.orig/src/gpsdrive.c	2003-06-22 22:10:51.000000000 -0400
+++ gpsdrive-2.0pre9/src/gpsdrive.c	2003-06-23 00:59:21.000000000 -0400
@@ -1922,7 +1922,7 @@
     }
   if ((j != 11) && (j != 12))
     {
-      g_print ("\nGPRMC: wrong number of fields (%d)", j);
+      g_print ("\nGPRMC: wrong number of fields (%ld)", j);
       return;
     }
 
@@ -1933,7 +1933,7 @@
     {
       g_print ("\nRMC Fields:\n");
       for (i = 0; i < j; i++)
-	g_print ("\n%d:%s", i, field[i]);
+	g_print ("\n%ld:%s", i, field[i]);
     }
   sprintf (b, "%c%c:%c%c.%c%c ", field[1][0], field[1][1], field[1][2],
 	   field[1][3], field[1][4], field[1][5]);
@@ -8734,9 +8734,11 @@
   /*** Mod by Arms */
   GtkRequisition requ, *reqptr;
   GtkWidget *mainnotebook;
+#ifndef NOPLUGINS
   GModule *mod1;
   void (*modulefunction) ();
   gchar *modpath;
+#endif
   time_t now = time (NULL);
   struct tm *st = localtime (&now);
   void *handle;
@@ -8829,7 +8831,9 @@
 
   if (usesql)
     {
-      handle = dlopen ("libmysqlclient.so", RTLD_LAZY);
+      handle = dlopen ("@PREFIX@/lib/mysql/libmysqlclient.10.dylib", RTLD_LAZY);
+      if (!handle)
+	handle = dlopen ("libmysqlclient.so", RTLD_LAZY);
       if (!handle)
 	handle = dlopen ("libmysqlclient.so.10", RTLD_LAZY);
       if (!handle)
@@ -9304,6 +9308,7 @@
   setupfunction[mod_setupcounter] = &(friendssetup);
   friendsplace = mod_setupcounter;
 
+#ifndef NOPLUGINS
   if (useplugins)
     {
 /*  fly module */
@@ -9343,6 +9348,7 @@
 	  setupfunction[mod_setupcounter] = modulefunction;
 	}
     }
+#endif
 
 
   mainwindow = gtk_window_new (GTK_WINDOW_TOPLEVEL);
diff -Nurd -x'*~' gpsdrive-2.0pre9.orig/src/server.c gpsdrive-2.0pre9/src/server.c
--- gpsdrive-2.0pre9.orig/src/server.c	2003-06-22 22:10:51.000000000 -0400
+++ gpsdrive-2.0pre9/src/server.c	2003-06-23 02:10:56.000000000 -0400
@@ -53,10 +53,13 @@
 #include <stdlib.h>
 #include <string.h>
 #include <signal.h>
+#ifdef HAVE_LINUX_INET_H
 #include "linux/inet.h"
+#endif
 #include <fcntl.h>
 #include <netdb.h>
 #include <gpsdrive.h>
+typedef unsigned int socklen_t;
 
 #define MAXMESG 2048
 
