Info2: <<
Package: openoffice.org-%type_pkg[lang]
Description: Language Pack(%type_pkg[lang]) for OpenOffice.org
Version: 2.0.0
Revision: 11rc1
Type: lang (af ar bg ca cs cy da de el en-gb eo es et eu fi fr gl he hi-in hu it ja km kn-in ko lt ms nb nl nn ns pl pt pt-br ru sk
 sl sv th tn tr xh zh-cn zh-tw zu)
License: LGPL
Maintainer: Todai Fink Team <fink@sodan.ecc.u-tokyo.ac.jp>

BuildDepends: <<
  x11-dev, ant, bison, fileutils, system-java14-dev,
  archive-zip-pm586,
  libjpeg, expat, freetype219, libwpd-0.8-dev, libxml2,
  db42-ssl | db42,
  libsablot-dev, libsablot, unixodbc2 | unixodbc2-nox,
  sane-backends, libcurl3-ssl | libcurl3,
  libsndfile1-dev,
  portaudio, neon24-ssl | neon24,
  mozilla-dev, libart2,
  atk1, audiofile, esound, gconf2-dev, libgettext3-dev, glib2-dev,
  gnome-keyring-dev (>= 0.4.3-1), gnome-vfs2-ssl-dev | gnome-vfs2-dev,
  gtk+2-dev, libbonobo2-dev, libbonoboui2-dev, libglade2,
  libgnome2-dev, libgnomecanvas2-dev, libgnomeprint2.2-dev,
  libgnomeprintui2.2-dev, libgnomeui2-dev, libiconv-dev, 
  orbit2-dev, pango1-xft2-dev, pcre, pkgconfig, popt, vte-dev, 
  python24, 
  boost1.32-py23 | boost1.32-py24,
  autoconf2.5
<<

Depends: <<
  x11, system-java14, system-perl,
  libjpeg-shlibs, expat-shlibs, libwpd-0.8-shlibs, libxml2-shlibs,
  db42-ssl-shlibs | db42-shlibs, db42-ssl-java,
  libsablot-shlibs, unixodbc2-shlibs | unixodbc2-nox-shlibs,
  sane-backends-shlibs, libcurl3-ssl-shlibs | libcurl3-shlibs,
  libsndfile1-shlibs,
  portaudio-shlibs, neon24-ssl-shlibs | neon24-shlibs,
  python24-shlibs, 
  boost1.32-py23-shlibs | boost1.32-py24-shlibs, 
  mozilla-shlibs, mozilla-mailnews, libart2-shlibs,
  fondu, openoffice.org (=%v-%r)
<<

# FIXME -- workaround
Replaces: <<
  openoffice.org-af, openoffice.org-ar, openoffice.org-bg, openoffice.org-ca,
  openoffice.org-cs, openoffice.org-cy, openoffice.org-da, openoffice.org-de,
  openoffice.org-el, openoffice.org-en-gb, openoffice.org-eo, openoffice.org-es,
  openoffice.org-et, openoffice.org-eu, openoffice.org-fi, openoffice.org-fr,
  openoffice.org-gl, openoffice.org-he, openoffice.org-hi-in, openoffice.org-hu,
  openoffice.org-it, openoffice.org-ja, openoffice.org-km, openoffice.org-kn-in,
  openoffice.org-ko, openoffice.org-lt, openoffice.org-ms, openoffice.org-nb,
  openoffice.org-nl openoffice.org-nn, openoffice.org-ns, openoffice.org-pl,
  openoffice.org-pt, openoffice.org-pt-br, openoffice.org-ru, openoffice.org-sk,
  openoffice.org-sl, openoffice.org-sv, openoffice.org-th, openoffice.org-tn,
  openoffice.org-tr, openoffice.org-xh, openoffice.org-zh-cn, openoffice.org-zh-tw,
  openoffice.org-zu, openoffice.org
<<

CustomMirror: <<
#aus-AU: http://openoffice.mirrors.ilisys.com.au/contrib/rc/2.0.0rc1/
aus-AU: ftp://mirror.pacific.net.au/OpenOffice/contrib/rc/2.0.0rc1/
aus-AU: http://mirror.pacific.net.au/openoffice/contrib/rc/2.0.0rc1/
aus-AU: ftp://ftp.planetmirror.com/pub/openoffice/contrib/rc/2.0.0rc1/
aus-AU: http://public.planetmirror.com/pub/openoffice/contrib/rc/2.0.0rc1/
eur-AT: http://gd.tuwien.ac.at/office/openoffice/contrib/rc/2.0.0rc1/
eur-AT: ftp://gd.tuwien.ac.at/office/openoffice/contrib/rc/2.0.0rc1/
eur-BE: http://ftp.belnet.be/pub/mirror/ftp.openoffice.org/contrib/rc/2.0.0rc1/
eur-BE: ftp://ftp.scarlet.be/pub/openoffice/contrib/rc/2.0.0rc1/
eur-BE: http://ftp.scarlet.be/pub/openoffice/contrib/rc/2.0.0rc1/
eur-BE: ftp://ftp.openoffice.skynet.be/pub/ftp.openoffice.org/contrib/rc/2.0.0rc1/
sam-BR: http://linorg.usp.br/OpenOffice.org/contrib/rc/2.0.0rc1/
sam-BR: ftp://ftp.pucpr.br/openoffice/contrib/rc/2.0.0rc1/
nam-CA: ftp://openoffice.mirror.cygnal.ca/openoffice/contrib/rc/2.0.0rc1/
nam-CA: http://openoffice.mirror.cygnal.ca/contrib/rc/2.0.0rc1/
nam-CA: http://gulus.USherbrooke.ca/pub/appl/openoffice/contrib/rc/2.0.0rc1/
eur-CZ: http://ftp.sh.cvut.cz/MIRRORS/OpenOffice/contrib/rc/2.0.0rc1/
eur-CZ: ftp://ftp.sh.cvut.cz/MIRRORS/OpenOffice/contrib/rc/2.0.0rc1/
eur-DK: http://mirrors.sunsite.dk/openoffice/contrib/rc/2.0.0rc1/
eur-DK: ftp://sunsite.dk/mirrors/openoffice/contrib/rc/2.0.0rc1/
eur-FR: ftp://openoffice.cict.fr/openoffice/contrib/rc/2.0.0rc1/
eur-FR: ftp://ftp.free.fr/mirrors/ftp.openoffice.org/contrib/rc/2.0.0rc1/
eur-DE: ftp://ftp.tu-chemnitz.de/pub/openoffice/contrib/rc/2.0.0rc1/
eur-DE: ftp://sunsite.informatik.rwth-aachen.de/pub/mirror/OpenOffice/contrib/rc/2.0.0rc1/
eur-DE: ftp://ftp.leo.org/pub/comp/general/office/openoffice/contrib/rc/2.0.0rc1/
eur-DE: http://ftp.leo.org/pub/comp/general/office/openoffice/contrib/rc/2.0.0rc1/
eur-DE: ftp://ftp.join.uni-muenster.de/pub/software/OpenOffice/contrib/rc/2.0.0rc1/
eur-DE: ftp://openoffice.tu-bs.de/OpenOffice.org/contrib/rc/2.0.0rc1/
eur-DE: http://ftp.stardiv.de/pub/OpenOffice.org/contrib/rc/2.0.0rc1/
eur-DE: ftp://ftp-stud.fht-esslingen.de/pub/Mirrors/ftp.openoffice.org/contrib/rc/2.0.0rc1/
eur-DE: http://mirror.xaranet.de/openoffice/contrib/rc/2.0.0rc1/
eur-GR: http://www.ellak.gr/pub/openoffice/contrib/rc/2.0.0rc1/
eur-GR: http://ftp.ntua.gr/pub/openoffice/contrib/rc/2.0.0rc1/
eur-GR: ftp://ftp.ntua.gr/pub/openoffice/contrib/rc/2.0.0rc1/
eur-HU: http://ftp.fsf.hu/OpenOffice.org/contrib/rc/2.0.0rc1/
#eur-HU: ftp://ftp.fsf.hu/OpenOffice.org/
eur-IE: ftp://ftp.heanet.ie/mirrors/openoffice.org/contrib/rc/2.0.0rc1/
eur-IE: http://ftp.heanet.ie/mirrors/openoffice.org/contrib/rc/2.0.0rc1/
asi-JP: ftp://ftp.kddlabs.co.jp/office/openoffice/contrib/rc/2.0.0rc1/
asi-JP: http://www.ring.gr.jp/archives/misc/openoffice/contrib/rc/2.0.0rc1/
asi-JP: ftp://ftp.ring.gr.jp/pub/misc/openoffice/contrib/rc/2.0.0rc1/
#eur-LT: http://files.akl.lt/OpenOffice.org/
#asi-MY: http://mymirror.asiaosc.org/openoffice/contrib/rc/2.0.0rc1/
eur-NL: http://ftp.nluug.nl/pub/office/openoffice/contrib/rc/2.0.0rc1/
eur-NL: ftp://ftp.snt.utwente.nl/pub/software/openoffice/contrib/rc/2.0.0rc1/
eur-NL: http://vlaai.snt.utwente.nl/pub/software/openoffice/contrib/rc/2.0.0rc1/
eur-PL: ftp://ftp.man.poznan.pl/pub/openoffice/contrib/rc/2.0.0rc1/
eur-PL: ftp://ftp.openoffice.pl/OpenOffice.ORG/contrib/rc/2.0.0rc1/
#eur-PT: http://ftpdem.ubi.pt/OpenOffice
eur-PT: http://mirrors.oninet.pt/openoffice/contrib/rc/2.0.0rc1/
#eur-PT: http://tux.cprm.net/pub/openoffice.org/
#eur-PT: ftp://tux.cprm.net/pub/openoffice.org/
eur-RO: ftp://ftp.iasi.roedu.net/pub/mirrors/openoffice.org/contrib/rc/2.0.0rc1/
eur-RO: http://ftp.iasi.roedu.net/mirrors/openoffice.org/contrib/rc/2.0.0rc1/
eur-YU: ftp://mirror.etf.bg.ac.yu/openoffice.org/contrib/rc/2.0.0rc1/
eur-YU: http://mirror.etf.bg.ac.yu/openoffice/contrib/rc/2.0.0rc1/
asi-SG: ftp://mirror.averse.net/pub/openoffice/contrib/rc/2.0.0rc1/
asi-SG: http://mirror.averse.net/openoffice/contrib/rc/2.0.0rc1/
eur-SI: ftp://ftp.bevc.net/mirrors/openoffice/contrib/rc/2.0.0rc1/
eur-SI: http://mirrors.bevc.net/openoffice/contrib/rc/2.0.0rc1/
eur-SI: http://www.wsection.com/openoffice/contrib/rc/2.0.0rc1/
asi-KR: ftp://ftp.kr.freebsd.org/pub/openoffice/contrib/rc/2.0.0rc1/
eur-ES: http://ftp.rediris.es/ftp/mirror/openoffice.org/contrib/rc/2.0.0rc1/
eur-ES: ftp://ftp.rediris.es/mirror/openoffice.org/contrib/rc/2.0.0rc1/
eur-SE: http://ftp.sunet.se/pub/Office/OpenOffice.org/contrib/rc/2.0.0rc1/
eur-CH: ftp://sunsite.cnlab-switch.ch/mirror/OpenOffice/contrib/rc/2.0.0rc1/
eur-CH: http://mirror.switch.ch/ftp/mirror/openoffice/contrib/rc/2.0.0rc1/
eur-CH: ftp://mirror.switch.ch/mirror/openoffice/contrib/rc/2.0.0rc1/
eur-UK: http://www.mirror.ac.uk/mirror/sunsite.dk/openoffice/contrib/rc/2.0.0rc1/
#eur-UK: ftp://mirrors.blueyonder.co.uk/sites/openoffice.org
#eur-UK: http://openoffice.blueyonder.co.uk
eur-UK: ftp://ftp.mirror.ac.uk/mirror/sunsite.dk/openoffice/contrib/rc/2.0.0rc1/
eur-UK: http://www.mirror.ac.uk/mirror/sunsite.dk/openoffice/contrib/rc/2.0.0rc1/
nam-US: http://www.binarycode.org/openoffice/contrib/rc/2.0.0rc1/
nam-US: http://mirrors.ibiblio.org/pub/mirrors/openoffice/contrib/rc/2.0.0rc1/
nam-US: ftp://ftp.ibiblio.org/pub/mirrors/openoffice/contrib/rc/2.0.0rc1/
nam-US: ftp://ftp.ussg.iu.edu/pub/openoffice/contrib/rc/2.0.0rc1/
nam-US: http://mirrors.isc.org/pub/openoffice/contrib/rc/2.0.0rc1/
nam-US: http://www.online-mirror.org/openoffice/contrib/rc/2.0.0rc1/
nam-US: ftp://openoffice.mirrors.pair.com/contrib/rc/2.0.0rc1/
nam-US: http://openoffice.mirrors.pair.com/contrib/rc/2.0.0rc1/
nam-US: ftp://openofficeorg.secsup.org/pub/software/openoffice/contrib/rc/2.0.0rc1/
nam-US: http://openofficeorg.secsup.org/contrib/rc/2.0.0rc1/
nam-US: http://openoffice.mirror.wrpn.net/contrib/rc/2.0.0rc1/
asi-TW: ftp://ftp.nctu.edu.tw/UNIX/OpenOffice/contrib/rc/2.0.0rc1/
<<
Source: mirror:custom:OOo_%vrc1_050928_src.tar.gz
SourceDirectory: OOo_%v_src
Source-MD5: 994f41c050885cef0521d2a75fd32477

PatchScript: <<
  /usr/bin/patch -p0 < %a/openoffice.org.patch
  /usr/bin/patch -p0 < %a/openoffice.org.macosx.patch || true
<<

SetCC: gcc-3.3
SetCXX: g++-3.3
SetCPPFLAGS: -I%p/include/db4 -I%p/include/boost
ConfigureParams: <<
  --with-gnu-cp=%p/bin/cp \
  --with-package-format=portable \
  --with-x --x-includes=/usr/X11R6/include --x-libraries=/usr/X11R6/lib \
  --with-jdk-home=/Library/Java/Home --with-ant-home=%p/lib/ant \
  --disable-crashdump \
  --with-build-version="%v-%r; Built with Fink <http://fink.sourceforge.net>" \
  --enable-libart \
  --with-system-db \
  --with-db-jar=%p/share/java/db42-ssl-java/db.jar \
  --with-system-libwpd \
  --with-system-sablot \
  --with-system-odbc-headers \
  --with-system-sane-header \
  --with-system-xrender-headers \
  --with-system-curl \
  --with-system-sndfile \
  --with-system-portaudio \
  --with-system-neon \
  --with-system-stdlibs \
  --with-system-zlib \
  --with-system-jpeg \
  --with-system-expat \
  --with-system-mozilla \
  \
  --enable-gtk \
  --with-system-freetype
<<
#  --with-system-boost \
#  --with-system-python
#  --with-system-libxml \

GCC: 3.3
CompileScript: <<
  #!/bin/bash

  set -e

  echo "Welcome to OpenOffice.org build script!"
  echo ""
  echo "1. This building process may take a week or more,"
  echo "   and often fails with an error."
  echo "2. This building process may consume much of your disk space,"
  echo "   possibly up to 10GB."
  echo "3. This building process needs your own WindowServer process."
  echo "   i.e, it is not possible to build through simple SSH connection."
  echo "   This is because the building process uses /usr/bin/osacompile ."
  echo ""
  echo "If you faced a building problem, feel free to mail the maintainer,"
  echo "with your build log. You can obtain the log by executing this line:"
  echo "   /usr/bin/tail -1000 %b/%n-%v-%r.buildlog |"
  echo "      bzip2 > ~/Desktop/%n-%v-%r.buildlog.tail.bz2"
  echo "(Note: execute the command in one line.)"
  echo ""
  echo "The mail address is: Todai Fink Team <fink@sodan.ecc.u-tokyo.ac.jp>"
  echo ""
  echo "Please understand this Fink package is still experimental."
  echo ""
  echo "If you are ready, press RETURN/ENTER to proceed..."

  read -t 60 || true

  # Record the time
  STARTTIME=`/bin/date +"%%F %%T %%Z(%%z)"`

  set -v

  # $X_LDFLAGS is needed to configure X correctly.  
  export X_LDFLAGS=$LDFLAGS

  # $PKG_CONFIG_PATH is needed to configure freetype219; not working?
  export PKG_CONFIG_PATH=%p/lib/freetype219/lib/pkgconfig

  if [ "%type_raw[lang]" == "en-gb" ]; then
    OOO_LANG=en-GB
  elif [ "%type_raw[lang]" == "hi-in" ]; then
    OOO_LANG=hi-IN
  elif [ "%type_raw[lang]" == "kn-in" ]; then
    OOO_LANG=kn-IN
  elif [ "%type_raw[lang]" == "pt-br" ]; then
    OOO_LANG=pt-BR
  elif [ "%type_raw[lang]" == "zh-cn" ]; then
    OOO_LANG=zh-CN
  elif [ "%type_raw[lang]" == "zh-tw" ]; then
    OOO_LANG=zh-TW
  else
    OOO_LANG=%type_pkg[lang]
  fi

  (cd config_office && autoconf && ./configure --with-lang=$OOO_LANG %c) 2>&1 | /usr/bin/tee -a %n-%v-%r.buildlog
  ./bootstrap                                      2>&1 | /usr/bin/tee -a %n-%v-%r.buildlog
  . MacosxEnv.Set.sh

  # Because we are using %p, $SOLARINC and $SOLARLIB need modified  
  export SOLARINC=`echo $SOLARINC | /usr/bin/sed -e"s|-I/usr/X11R6/include -I/usr/X11R6/include/freetype2|-I%p/include/db4 -I%p/lib/freetype219/include/freetype2 -I%p/lib/freetype219/include -I%p/include -I/usr/X1186/include|g"`
  export SOLARLIB=`echo $SOLARLIB | /usr/bin/sed -e"s|-L/usr/lib|-L%p/lib/freetype219/lib -L%p/lib -L/usr/lib|g"`

  # Include libdb_java-4.2.jnilib to DYLD_LIBRARY_PATH so that Java can find it
  /bin/mkdir FINKLIBS
  /bin/ln -s %p/lib/libdb_java-4.2.jnilib FINKLIBS
  export DYLD_LIBRARY_PATH="$DYLD_LIBRARY_PATH:%b/FINKLIBS"

  # Retry forever to build OOo until success!
  until [ -n "$succeeded" ]; do
    dmake 2>&1 | /usr/bin/tee -a %n-%v-%r.buildlog
    if [ ${PIPESTATUS[0]} == 0 ]; then
      succeeded=TRUE
      continue
    fi
    set > %n-%v-%r.env.sh
    echo "Build faild with an error."
    echo "Now you can get rid of the cause by hand, or call for help."
    echo "The build directory is:"
    echo "  %b"
    echo "Environmental variable is available here:"
    echo "  %b/%n-%v-%r.env.sh"
    echo "and the full log file is available here:"
    echo "  %b/%n-%v-%r.buildlog"
    echo ""
    echo "Press RETURN/ENTER to exit or input any key to restart dmake..."
    read input
    [ -n "$input" ] || false
  done

  # Build the language pack
  (cd instsetoo_native/util && dmake ooolanguagepack)

  set +v
  # Record the time and disk usage
  ENDTIME=`/bin/date +"%%F %%T %%Z(%%z)"`
  DISKUSAGE=`/usr/bin/du -sh %b | /usr/bin/cut -f1`

  echo "Congratulations! The building process of OpenOffice.org has completed!"
  echo "   Started:   $STARTTIME"
  echo "   Completed: $ENDTIME"
  echo "   $DISKUSAGE is used for this building process (not including tarball)."
<<

InstallScript: <<
  #!/bin/bash -ev
  if [ "%type_raw[lang]" == "en-gb" ]; then
    OOO_LANG=en-GB
  elif [ "%type_raw[lang]" == "hi-in" ]; then
    OOO_LANG=hi-IN
  elif [ "%type_raw[lang]" == "kn-in" ]; then
    OOO_LANG=kn-IN
  elif [ "%type_raw[lang]" == "pt-br" ]; then
    OOO_LANG=pt-BR
  elif [ "%type_raw[lang]" == "zh-cn" ]; then
    OOO_LANG=zh-CN
  elif [ "%type_raw[lang]" == "zh-tw" ]; then
    OOO_LANG=zh-TW
  else
    OOO_LANG=%type_pkg[lang]
  fi

  /usr/bin/tar xf instsetoo_native/unxmacxp.pro/OpenOffice_languagepack/install/$OOO_LANG/darwin-*/openofficeorg-$OOO_LANG.sw -C %i

  /bin/mv %i/{Applications,lib}
  /bin/mv %i/lib/{openoffice.org*,%n}

  /usr/bin/install -m 755 -d %i/share/doc/%n
  /bin/cp instsetoo_native/unxmacxp.pro/OpenOffice_languagepack/install/$OOO_LANG/darwin-*/openofficeorg-$OOO_LANG.license %i/share/doc/%n/LICENSE
<<

Homepage: http://www.openoffice.org/

DescPackaging: <<
This package has a bug that some language packs have the same file (i.e. Conflicts).
If you uninstall language pack, and if you find something strange,
please reinstall ooo and language packs. (e.g. `fink reinstall openoffice.org`)
<<
<<
