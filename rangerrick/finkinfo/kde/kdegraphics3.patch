Index: kdvi/Makefile.am
===================================================================
RCS file: /home/kde/kdegraphics/kdvi/Makefile.am,v
retrieving revision 1.83
diff -u -u -r1.83 Makefile.am
--- kdvi/Makefile.am	20 Aug 2003 07:04:56 -0000	1.83
+++ kdvi/Makefile.am	4 Nov 2003 13:58:24 -0000
@@ -1,5 +1,5 @@
 # set the include path for X, qt and KDE
-INCLUDES= -I$(top_srcdir)/kviewshell $(all_includes) $(LIBFREETYPE_CFLAGS)
+INCLUDES= -I$(top_srcdir)/kviewshell $(LIBFREETYPE_CFLAGS) $(all_includes)
 # claim, which subdirectories you want to install
 SUBDIRS = . pix
 
Index: ksvg/impl/libs/libtext2path/src/Makefile.am
===================================================================
RCS file: /home/kde/kdegraphics/ksvg/impl/libs/libtext2path/src/Makefile.am,v
retrieving revision 1.8
diff -u -u -r1.8 Makefile.am
--- ksvg/impl/libs/libtext2path/src/Makefile.am	28 Sep 2003 20:25:14 -0000	1.8
+++ ksvg/impl/libs/libtext2path/src/Makefile.am	4 Nov 2003 13:58:24 -0000
@@ -1,7 +1,7 @@
 lib_LTLIBRARIES = libtext2path.la
 
 KDE_CXXFLAGS = $(USE_EXCEPTIONS)
-INCLUDES = $(FRIBIDI_CFLAGS) $(FREETYPE_CFLAGS) $(all_includes)
+INCLUDES = $(FREETYPE_CFLAGS) $(FRIBIDI_CFLAGS) $(all_includes)
 
 libtext2path_includedir=$(includedir)/libtext2path-0.1
 libtext2path_include_HEADERS = BezierPath.h Glyph.h GlyphTracer.h
? ksvg/plugin/backends/libart/GlyphTracerLibart.loT
Index: ksvg/plugin/backends/libart/Makefile.am
===================================================================
RCS file: /home/kde/kdegraphics/ksvg/plugin/backends/libart/Makefile.am,v
retrieving revision 1.3
diff -u -u -r1.3 Makefile.am
--- ksvg/plugin/backends/libart/Makefile.am	23 Sep 2003 19:27:17 -0000	1.3
+++ ksvg/plugin/backends/libart/Makefile.am	4 Nov 2003 14:29:18 -0000
@@ -8,4 +8,4 @@
 kde_services_DATA = ksvglibartcanvas.desktop
 
 KDE_CXXFLAGS = $(USE_EXCEPTIONS)
-INCLUDES = $(KDE_INCLUDES) $(LIBART_CFLAGS) $(FREETYPE_CFLAGS) $(FONTCONFIG_CFLAGS) -I$(top_srcdir)/ksvg/dom -I$(top_srcdir)/ksvg/impl -I$(top_srcdir)/ksvg/ecma -I$(top_srcdir)/ksvg/core -I$(top_srcdir)/ksvg/impl/libs/art_support -I$(top_srcdir)/ksvg/impl/libs/libtext2path/src $(all_includes)
+INCLUDES = $(FREETYPE_CFLAGS) $(FONTCONFIG_CFLAGS) $(KDE_INCLUDES) $(LIBART_CFLAGS) -I$(top_srcdir)/ksvg/dom -I$(top_srcdir)/ksvg/impl -I$(top_srcdir)/ksvg/ecma -I$(top_srcdir)/ksvg/core -I$(top_srcdir)/ksvg/impl/libs/art_support -I$(top_srcdir)/ksvg/impl/libs/libtext2path/src $(all_includes)
? kghostview/dummy.cpp
Index: kghostview/Makefile.am
===================================================================
RCS file: /home/kde/kdegraphics/kghostview/Makefile.am,v
retrieving revision 1.79
diff -u -u -r1.79 Makefile.am
--- kghostview/Makefile.am	19 Aug 2003 20:52:12 -0000	1.79
+++ kghostview/Makefile.am	4 Nov 2003 15:46:09 -0000
@@ -4,16 +4,16 @@
 
 ####### Files
 
-bin_PROGRAMS = 	kghostview
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = 	kghostview.la
 kde_module_LTLIBRARIES = libkghostviewpart.la
-noinst_LTLIBRARIES = libdscparse.la
+noinst_LTLIBRARIES = libdscparse.la libkghostview_common.la
 
-libkghostviewpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) -module
-libkghostviewpart_la_LIBADD = $(LIB_KFILE) $(LIB_KPARTS) -lkdeprint \
-	libdscparse.la
-
-# Check "make final" after making changes to the following line!!
-libkghostviewpart_la_SOURCES = kgvshell.cpp kgvdocument.cpp kgv_miniwidget.cpp \
+libkghostview_common_la_LDFLAGS = $(all_libraries) $(KDE_RPATH)
+libkghostview_common_la_LIBADD  = $(LIB_KFILE) $(LIB_KPARTS) \
+	$(LIB_KDEPRINT) libdscparse.la
+libkghostview_common_la_SOURCES = kgvshell.cpp kgvdocument.cpp kgv_miniwidget.cpp \
 	marklist.cpp logwindow.cpp infodialog.cpp \
 	kgvpageview.cpp ps.c kgv_view.cpp scrollbox.cpp  kgvpagedecorator.cpp \
 	kgvconfigdialog.cpp kgvmainwidget.cpp \
@@ -21,9 +21,18 @@
 	fullscreenfilter.cpp kgvfactory.cpp \
     generalsettingswidget.ui gssettingswidget.ui thumbnailservice.cpp
 
-kghostview_SOURCES = main.cpp
-kghostview_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kghostview_LDADD = libkghostviewpart.la
+libkghostviewpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) -module
+libkghostviewpart_la_LIBADD  = libkghostview_common.la
+libkghostviewpart_la_SOURCES = dummy.cpp
+
+dummy.cpp:
+	echo > dummy.cpp
+
+# Check "make final" after making changes to the following line!!
+
+kghostview_la_SOURCES = main.cpp
+kghostview_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+kghostview_la_LIBADD = libkghostview_common.la
 
 libdscparse_la_LDFLAGS = $(all_libraries) -no-undefined
 libdscparse_la_LIBADD = $(LIB_QT)
Index: kghostview/main.cpp
===================================================================
RCS file: /home/kde/kdegraphics/kghostview/main.cpp,v
retrieving revision 1.67
diff -u -u -r1.67 main.cpp
--- kghostview/main.cpp	15 Sep 2003 13:07:29 -0000	1.67
+++ kghostview/main.cpp	4 Nov 2003 15:46:09 -0000
@@ -43,7 +43,7 @@
     KCmdLineLastOption
 };
 
-int main( int argc, char** argv )
+extern "C" int kdemain( int argc, char** argv )
 {
     KCmdLineArgs::init( argc, argv, KGVPart::createAboutData() );
     KCmdLineArgs::addCmdLineOptions( options );
