
--- example/Makefile.am	25 Apr 2003 15:43:28 -0000	1.1.1.3
+++ example/Makefile.am	7 Jul 2003 01:46:23 -0000
@@ -9,19 +9,12 @@
 libexamplepart_la_LIBADD = $(LIB_KOFFICEUI)
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = example.la
+bin_PROGRAMS = 
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = example.la
 example_la_SOURCES = main.cc
-example_la_LDFLAGS = $(all_libraries) -module -avoid-version
+example_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
 example_la_LIBADD = $(LIB_KOFFICEUI)
-
-## The executable
-bin_PROGRAMS = example
-example_SOURCES = dummy.cc
-example_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-example_LDADD = example.la
-
-dummy.cc:
-	echo > dummy.cc
 
 METASOURCES = AUTO
 noinst_HEADERS =  example_part.h \
--- filters/karbon/ai/Makefile.am	25 Apr 2003 15:43:29 -0000	1.1.1.3
+++ filters/karbon/ai/Makefile.am	26 Apr 2003 02:07:12 -0000	1.3
@@ -2,7 +2,7 @@
 
 libkarbonaiimport_la_LIBADD = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 libkarbonaiimport_la_LDFLAGS = \
 	$(all_libraries) \
--- filters/karbon/eps/Makefile.am	25 Apr 2003 15:43:29 -0000	1.1.1.3
+++ filters/karbon/eps/Makefile.am	26 Apr 2003 02:07:13 -0000	1.3
@@ -9,7 +9,7 @@
 libkarbonepsexport_la_LDFLAGS = $(KDE_PLUGIN)
 libkarbonepsexport_la_LIBADD  = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 libkarbonepsimport_la_SOURCES = epsimport.cc pscommentlexer.cc
 libkarbonepsimport_la_LDFLAGS = $(KDE_PLUGIN)
--- filters/karbon/kontour/Makefile.am	25 Apr 2003 15:43:30 -0000	1.1.1.2
+++ filters/karbon/kontour/Makefile.am	27 Apr 2003 19:04:23 -0000	1.2
@@ -11,7 +11,7 @@
 
 libkarbonkontourimport_la_SOURCES = kontourimport.cpp
 libkarbonkontourimport_la_LDFLAGS = -module $(KDE_PLUGIN)
-libkarbonkontourimport_la_LIBADD = $(KOFFICE_LIBS) ../../../karbon/libkarbonpart.la
+libkarbonkontourimport_la_LIBADD = $(KOFFICE_LIBS) ../../../karbon/libkarbonpart_shared.la
 
 METASOURCES = AUTO
 
--- filters/karbon/msod/Makefile.am	25 Apr 2003 15:43:30 -0000	1.1.1.1
+++ filters/karbon/msod/Makefile.am	27 Apr 2003 19:04:23 -0000	1.2
@@ -2,7 +2,7 @@
 
 INCLUDES= -I$(srcdir) $(KOFFICE_INCLUDES) $(all_includes)
 libkarbonmsodimport_la_LDFLAGS	= -module -avoid-version -no-undefined $(all_libraries)
-libkarbonmsodimport_la_LIBADD = $(KOFFICE_LIBS)
+libkarbonmsodimport_la_LIBADD = $(KOFFICE_LIBS) $(LIBZ)
 
 ####### Files
 
--- filters/karbon/oodraw/Makefile.am	25 Apr 2003 15:43:30 -0000	1.1.1.1
+++ filters/karbon/oodraw/Makefile.am	27 Apr 2003 19:04:23 -0000	1.2
@@ -14,7 +14,7 @@
 liboodrawimport_la_SOURCES = oodrawimport.cc
 liboodrawimport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
 liboodrawimport_la_LIBADD  = ../../liboofilter/liboofilter.la \
-							../../../karbon/libkarbonpart.la \
+							../../../karbon/libkarbonpart_shared.la \
 							$(KOFFICE_LIBS)
 
 METASOURCES = AUTO
--- filters/karbon/png/Makefile.am	25 Apr 2003 15:43:30 -0000	1.1.1.2
+++ filters/karbon/png/Makefile.am	26 Apr 2003 02:07:13 -0000	1.3
@@ -3,7 +3,7 @@
 libkarbonpngexport_la_LDFLAGS = $(KDE_PLUGIN)
 libkarbonpngexport_la_LIBADD = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 INCLUDES = \
 	$(KOFFICE_INCLUDES) $(KOPAINTER_INCLUDES) \
--- filters/karbon/svg/Makefile.am	25 Apr 2003 15:43:31 -0000	1.1.1.3
+++ filters/karbon/svg/Makefile.am	26 Apr 2003 02:07:14 -0000	1.3
@@ -3,12 +3,12 @@
 libkarbonsvgexport_la_LDFLAGS = $(KDE_PLUGIN)
 libkarbonsvgexport_la_LIBADD = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 libkarbonsvgimport_la_LDFLAGS = $(KDE_PLUGIN)
 libkarbonsvgimport_la_LIBADD = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 INCLUDES = \
 	$(KOFFICE_INCLUDES) \
--- filters/karbon/wmf/Makefile.am	5 Jul 2003 18:31:01 -0000	1.1.1.3
+++ filters/karbon/wmf/Makefile.am	6 Jul 2003 14:11:25 -0000	1.3
@@ -12,12 +12,11 @@
 kde_module_LTLIBRARIES = libwmfimport.la libwmfexport.la
 
 libwmfimport_la_LDFLAGS = -module $(KDE_PLUGIN)
-libwmfimport_la_LIBADD = $(KOFFICE_LIBS) $(LIB_KOWMF) ../../../karbon/libkarbonpart.la
-#libwmfimport_la_LIBADD = $(KOFFICE_LIBS) $(LIB_KOWMF) ../../../karbon/libkarbonpart.la
+libwmfimport_la_LIBADD = $(KOFFICE_LIBS) $(LIB_KOWMF) ../../../karbon/libkarbonpart_shared.la
 libwmfimport_la_SOURCES = wmfimport.cc wmfimportparser.cc
 
 libwmfexport_la_LDFLAGS = -module $(KDE_PLUGIN)
-libwmfexport_la_LIBADD = $(KOFFICE_LIBS) $(LIB_KOWMF) ../../../karbon/libkarbonpart.la
+libwmfexport_la_LIBADD = $(KOFFICE_LIBS) $(LIB_KOWMF) ../../../karbon/libkarbonpart_shared.la
 libwmfexport_la_SOURCES = wmfexport.cc
 
 noinst_HEADERS = wmfimport.h wmfimportparser.h wmfexport.h 
--- filters/karbon/xcf/Makefile.am	25 Apr 2003 15:43:31 -0000	1.1.1.1
+++ filters/karbon/xcf/Makefile.am	27 Apr 2003 19:04:24 -0000	1.2
@@ -3,7 +3,7 @@
 libkarbonxcfexport_la_LDFLAGS = $(KDE_PLUGIN)
 libkarbonxcfexport_la_LIBADD = \
 	$(LIB_KOFFICEUI) \
-	../../../karbon/libkarbonpart.la
+	../../../karbon/libkarbonpart_shared.la
 
 INCLUDES = \
 	$(KOFFICE_INCLUDES) $(KOPAINTER_INCLUDES) \
--- filters/kspread/csv/Makefile.am	25 Apr 2003 15:43:38 -0000	1.1.1.2
+++ filters/kspread/csv/Makefile.am	26 Apr 2003 02:07:15 -0000	1.3
@@ -9,11 +9,11 @@
 
 libcsvimport_la_SOURCES = csvimport.cc xmltree.cc csvdialog.cpp dialogui.ui
 libcsvimport_la_LDFLAGS	= $(all_libraries) -module -avoid-version -no-undefined 
-libcsvimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libcsvimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la
 
 libcsvexport_la_SOURCES = csvexport.cc csvexportdialog.cpp exportdialogui.ui
 libcsvexport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libcsvexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libcsvexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la
 
 METASOURCES = AUTO
 
--- filters/kspread/gnumeric/Makefile.am	25 Apr 2003 15:43:38 -0000	1.1.1.2
+++ filters/kspread/gnumeric/Makefile.am	27 Apr 2003 19:04:24 -0000	1.5
@@ -4,15 +4,15 @@
 	$(KOTEXT_INCLUDES) $(KOSCRIPT_INCLUDES) $(all_includes)
 
 ####### Files
-kde_module_LTLIBRARIES = libgnumericexport.la libgnumericimport.la 
+kde_module_LTLIBRARIES = libgnumericexport.la libgnumericimport.la
 
 libgnumericexport_la_SOURCES = gnumericexport.cc
 libgnumericexport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libgnumericexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libgnumericexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la $(LIBZ)
 
 libgnumericimport_la_SOURCES = gnumericimport.cc
 libgnumericimport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libgnumericimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libgnumericimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la $(LIBZ)
 
 METASOURCES = AUTO
 
--- filters/kspread/html/Makefile.am	25 Apr 2003 15:43:39 -0000	1.1.1.2
+++ filters/kspread/html/Makefile.am	26 Apr 2003 02:07:16 -0000	1.3
@@ -9,7 +9,7 @@
 
 libkspreadhtmlexport_la_SOURCES = htmlexport.cc
 libkspreadhtmlexport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libkspreadhtmlexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libkspreadhtmlexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la
 
 METASOURCES = AUTO
 
--- filters/kspread/opencalc/Makefile.am	25 Apr 2003 15:43:40 -0000	1.1.1.1
+++ filters/kspread/opencalc/Makefile.am	27 Apr 2003 19:04:24 -0000	1.2
@@ -8,11 +8,11 @@
 
 libopencalcexport_la_SOURCES = opencalcexport.cc opencalcstyleexport.cc
 libopencalcexport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libopencalcexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libopencalcexport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la
 
 libopencalcimport_la_SOURCES = opencalcimport.cc
 libopencalcimport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libopencalcimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la
+libopencalcimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la
 
 METASOURCES = AUTO
 
--- filters/kspread/qpro/Makefile.am	25 Apr 2003 15:43:41 -0000	1.1.1.2
+++ filters/kspread/qpro/Makefile.am	26 Apr 2003 02:07:16 -0000	1.3
@@ -13,7 +13,7 @@
 libqproimport_la_SOURCES = qproimport.cc qproformula.cc
 
 libqproimport_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libqproimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart.la \
+libqproimport_la_LIBADD  = $(KOFFICE_LIBS) ../../../kspread/libkspreadpart_shared.la \
 	libqpro/src/libqpro.la
 
 METASOURCES = AUTO
--- filters/kword/latex/import/parser/Makefile.am	25 Apr 2003 15:43:49 -0000	1.1.1.5
+++ filters/kword/latex/import/parser/Makefile.am	26 Apr 2003 02:07:18 -0000	1.6
@@ -1,7 +1,7 @@
 ####### General stuff
 
 INCLUDES= -I$(srcdir) $(all_includes)
-liblatexparser_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
+liblatexparser_la_LDFLAGS = $(all_libraries) -avoid-version -no-undefined
 liblatexparser_la_LIBADD  = -lm $(KOFFICE_LIBS)
 
 ####### Files
--- interfaces/Makefile.am	20 Jun 2002 04:43:14 -0000	1.1.1.1
+++ interfaces/Makefile.am	1 Jun 2003 14:59:32 -0000	1.2
@@ -3,7 +3,7 @@
 lib_LTLIBRARIES = libkochart.la
 
 libkochart_la_SOURCES = koChart.cc
-libkochart_la_LDFLAGS = $(all_libraries) -version-info 1:0:0
+libkochart_la_LDFLAGS = $(all_libraries) -version-info 1:0:0 -no-undefined
 libkochart_la_LIBADD = $(LIB_KOFFICECORE)
 METASOURCES = AUTO
 
--- karbon/Makefile.am	5 Jul 2003 18:31:46 -0000	1.1.1.6
+++ karbon/Makefile.am	7 Jul 2003 01:46:24 -0000
@@ -12,22 +12,24 @@
 
 SUBDIRS = commands visitors core shapes widgets dialogs dockers render tools . plugins data pics
 
-bin_PROGRAMS = karbon
+bin_PROGRAMS = 
+lib_LTLIBRARIES =
 
-lib_LTLIBRARIES = karbon.la
+noinst_LTLIBRARIES = libkarbonpart_shared.la
 kde_module_LTLIBRARIES = libkarbonbase.la libkarbonpart.la
+kdeinit_LTLIBRARIES = karbon.la
 
-libkarbonpart_la_SOURCES = karbon_factory.cc 	karbon_resourceserver.cc 	karbon_part.cc 	karbon_part_iface.cc 	karbon_part_iface.skel 	karbon_view.cc 	karbon_view_iface.cc 	karbon_view_iface.skel karbon_drag.cpp
+libkarbonpart_shared_la_SOURCES = karbon_factory.cc 	karbon_resourceserver.cc 	karbon_part.cc 	karbon_part_iface.cc 	karbon_part_iface.skel 	karbon_view.cc 	karbon_view_iface.cc 	karbon_view_iface.skel karbon_drag.cpp
 
 libkarbonbase_la_SOURCES = \
 	karbon_view_base.cc \
 	karbon_part_base.cc
 
-libkarbonbase_la_LDFLAGS = $(KDE_PLUGIN)
+libkarbonbase_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -no-undefined
 libkarbonbase_la_LIBADD = $(LIB_KOFFICEUI)
 
-libkarbonpart_la_LDFLAGS = $(KDE_PLUGIN) $(LIBFREETYPE_RPATH)
-libkarbonpart_la_LIBADD = $(LIB_KOFFICEUI) $(LIB_KOPAINTER) \
+libkarbonpart_shared_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version $(LIBFREETYPE_RPATH) -no-undefined
+libkarbonpart_shared_la_LIBADD = $(LIB_KOFFICEUI) $(LIB_KOPAINTER) \
 	dockers/libkarbondockers.la \
 	widgets/libkarbonwidgets.la \
 	render/libvpainter.la \
@@ -43,18 +45,15 @@
 	$(FONTCONFIG_LIBS) \
 	$(LIBFREETYPE_LIBS)
 
-libkarbonpart_la_METASOURCES = AUTO
+libkarbonpart_shared_la_METASOURCES = AUTO
 
-karbon_la_SOURCES = main.cc
-karbon_la_LDFLAGS = $(all_libraries) -module -avoid-version
-karbon_la_LIBADD = libkarbonpart.la
-
-karbon_SOURCES = dummy.cc
-karbon_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-karbon_LDADD = karbon.la
+libkarbonpart_la_SOURCES = libkarbonpart_init.cc
+libkarbonpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) -module
+libkarbonpart_la_LIBADD  = libkarbonpart_shared.la
 
-dummy.cc:
-	echo > dummy.cc
+karbon_la_SOURCES = main.cc
+karbon_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+karbon_la_LIBADD = libkarbonpart_shared.la
 
 noinst_HEADERS = \
 	karbon_factory.h \
--- karbon/configure.in.in	5 Jul 2003 18:31:45 -0000	1.1.1.5
+++ karbon/configure.in.in	6 Jul 2003 14:11:33 -0000	1.3
@@ -1,5 +1,5 @@
 
-KDE_FIND_PATH(freetype-config, FREETYPE_CONFIG, [${prefix}/bin ${exec_prefix}/bin /usr/local/bin /opt/local/bin], [
+KDE_FIND_PATH(freetype-config, FREETYPE_CONFIG, [/usr/X11R6/bin ${prefix}/bin ${exec_prefix}/bin /usr/local/bin /opt/local/bin], [
   AC_MSG_WARN([Could not find libfreetype anywhere, check http://www.freetype.org/])
 ])
 
--- karbon/dockers/Makefile.am	5 Jul 2003 18:31:48 -0000	1.1.1.3
+++ karbon/dockers/Makefile.am	6 Jul 2003 14:11:35 -0000	1.3
@@ -20,7 +20,6 @@
 	vtransformdocker.h
 
 libkarbondockers_la_SOURCES = \
-	dummy.cc \
 	vcolordocker.cc \
 	vdocumentdocker.cc \
 	vdocker.cc \
@@ -29,10 +28,3 @@
 	vtransformdocker.cc
 
 libkarbondockers_la_METASOURCES = AUTO
-
-DISTCLEANFILES = \
-	dummy.cc
-
-dummy.cc:
-	echo > dummy.cc
-
--- karbon/main.cc	5 Jul 2003 18:31:46 -0000	1.1.1.4
+++ karbon/main.cc	6 Jul 2003 21:05:00 -0000	1.2
@@ -34,7 +34,7 @@
 		KCmdLineLastOption
 	};
 
-int main( int argc, char* argv[] )
+extern "C" int kdemain( int argc, char* argv[] )
 {
 	KCmdLineArgs::init( argc, argv, KarbonFactory::aboutData() );
 	KCmdLineArgs::addCmdLineOptions( options );
--- karbon/plugins/flattenpath/Makefile.am	25 Apr 2003 15:44:10 -0000	1.1.1.1
+++ karbon/plugins/flattenpath/Makefile.am	27 Apr 2003 19:04:26 -0000	1.2
@@ -4,7 +4,7 @@
 
 karbon_flattenpathplugin_la_SOURCES = flattenpathplugin.cc
 karbon_flattenpathplugin_la_LIBADD = $(LIB_KPARTS) $(LIB_KOFFICEUI) \
-				../../libkarbonpart.la
+				../../libkarbonpart_shared.la
 
 karbon_flattenpathplugin_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
 
--- karbon/plugins/imagetool/Makefile.am	25 Apr 2003 15:44:10 -0000	1.1.1.1
+++ karbon/plugins/imagetool/Makefile.am	27 Apr 2003 19:04:26 -0000	1.2
@@ -4,7 +4,7 @@
 
 karbon_imagetoolplugin_la_SOURCES = imagetoolplugin.cc
 karbon_imagetoolplugin_la_LIBADD = $(LIB_KPARTS) $(LIB_KOFFICEUI) \
-				../../libkarbonpart.la
+				../../libkarbonpart_shared.la
 
 karbon_imagetoolplugin_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
 
--- karbon/plugins/insertknots/Makefile.am	25 Apr 2003 15:44:10 -0000	1.1.1.1
+++ karbon/plugins/insertknots/Makefile.am	27 Apr 2003 19:04:26 -0000	1.2
@@ -4,7 +4,7 @@
 
 karbon_insertknotsplugin_la_SOURCES = insertknotsplugin.cc
 karbon_insertknotsplugin_la_LIBADD = $(LIB_KPARTS) \
-					../../libkarbonpart.la
+					../../libkarbonpart_shared.la
 
 karbon_insertknotsplugin_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
 
--- karbon/plugins/roundcorners/Makefile.am	25 Apr 2003 15:44:10 -0000	1.1.1.1
+++ karbon/plugins/roundcorners/Makefile.am	27 Apr 2003 19:04:26 -0000	1.2
@@ -4,7 +4,7 @@
 
 karbon_roundcornersplugin_la_SOURCES = roundcornersplugin.cc
 karbon_roundcornersplugin_la_LIBADD = $(LIB_KPARTS) \
-					../../libkarbonpart.la
+					../../libkarbonpart_shared.la
 
 karbon_roundcornersplugin_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
 
--- karbon/plugins/shadoweffect/Makefile.am	25 Apr 2003 15:44:10 -0000	1.1.1.1
+++ karbon/plugins/shadoweffect/Makefile.am	27 Apr 2003 19:04:27 -0000	1.2
@@ -4,7 +4,7 @@
 
 karbon_shadoweffectplugin_la_SOURCES = shadoweffectplugin.cc vshadowdecorator.cc 
 karbon_shadoweffectplugin_la_LIBADD = $(LIB_KPARTS) $(LIB_KOFFICEUI) \
-					../../libkarbonpart.la
+					../../libkarbonpart_shared.la
 
 karbon_shadoweffectplugin_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
 
--- karbon/plugins/whirlpinch/Makefile.am	5 Jul 2003 18:31:49 -0000	1.1.1.2
+++ karbon/plugins/whirlpinch/Makefile.am	6 Jul 2003 14:11:37 -0000	1.3
@@ -4,7 +4,7 @@
 
 karbon_whirlpinchplugin_la_SOURCES = whirlpinchplugin.cc
 karbon_whirlpinchplugin_la_LIBADD = $(LIB_KPARTS) $(LIB_KOPAINTER) \
-				../../libkarbonpart.la
+				../../libkarbonpart_shared.la
 
 
 karbon_whirlpinchplugin_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
--- karbon/plugins/zoomtool/Makefile.am	25 Apr 2003 15:44:10 -0000	1.1.1.1
+++ karbon/plugins/zoomtool/Makefile.am	27 Apr 2003 19:04:27 -0000	1.2
@@ -4,7 +4,7 @@
 
 karbon_zoomtoolplugin_la_SOURCES = zoomtoolplugin.cc
 karbon_zoomtoolplugin_la_LIBADD = $(LIB_KPARTS) $(LIB_KOFFICEUI) \
-				../../libkarbonpart.la
+				../../libkarbonpart_shared.la
 
 karbon_zoomtoolplugin_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
 
--- karbon/widgets/Makefile.am	5 Jul 2003 18:31:54 -0000	1.1.1.3
+++ karbon/widgets/Makefile.am	6 Jul 2003 14:11:41 -0000	1.3
@@ -26,7 +26,6 @@
 	vtypebuttonbox.h
 
 libkarbonwidgets_la_SOURCES = \
-	dummy.cc \
 	vcanvas.cc \
 	vcolorslider.cc \
 	vcolordlg.cc \
@@ -42,10 +41,3 @@
 
 libkarbonwidgets_la_METASOURCES = \
 	AUTO
-
-DISTCLEANFILES = \
-	dummy.cc
-
-dummy.cc:
-	echo > dummy.cc
-
--- kchart/Makefile.am	25 Apr 2003 15:44:18 -0000	1.1.1.3
+++ kchart/Makefile.am	7 Jul 2003 01:46:26 -0000
@@ -2,6 +2,7 @@
 
 ## The part
 kde_module_LTLIBRARIES = libkchartpart.la
+
 libkchartpart_la_SOURCES = kchart_part.cc \
 	kchart_view.cc kchart_factory.cc \
 	kchartBarConfigDialog.cc \
@@ -33,25 +34,18 @@
 	KChartParamsIface.cc kchartHeaderFooterConfigPage.cc \
 	kchartLine3dConfigPage.cc kchartParameterPolarConfigPage.cc kchartPageLayout.cc
 
-libkchartpart_la_LDFLAGS = $(KDE_PLUGIN)
+libkchartpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) -module
 libkchartpart_la_LIBADD = $(top_builddir)/interfaces/libkochart.la \
                           $(LIB_KOFFICEUI) \
 			  kdchart/libkdchart.la			
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = kchart.la
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = kchart.la
 kchart_la_SOURCES = main.cc
 kchart_la_LDFLAGS = $(all_libraries) -avoid-version -module
 kchart_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kchart
-kchart_SOURCES = dummy.cc
-kchart_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kchart_LDADD = kchart.la
-
-dummy.cc:
-	echo > dummy.cc
 
 noinst_HEADERS =  kchart_part.h \
 		kchart_view.h kchart_factory.h \
--- kchart/kdchart/Makefile.am	20 Jun 2002 04:49:58 -0000	1.1.1.2
+++ kchart/kdchart/Makefile.am	1 Jun 2003 14:59:33 -0000	1.5
@@ -1,5 +1,7 @@
 lib_LTLIBRARIES = libkdchart.la
 
+libkdchart_la_LIBADD  = $(LIB_QT)
+libkdchart_la_LDFLAGS = $(all_libraries) -avoid-version -no-undefined
 libkdchart_la_SOURCES = KDChart.cpp 		\
 			KDChartAreaPainter.cpp	\
 			KDChartAxesPainter.cpp	\
--- kformula/Makefile.am	25 Apr 2003 15:45:03 -0000	1.1.1.4
+++ kformula/Makefile.am	7 Jul 2003 01:46:28 -0000
@@ -12,19 +12,12 @@
 libkformulapart_la_METASOURCES = AUTO
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = kformulamain.la
-kformulamain_la_SOURCES = main.cc
-kformulamain_la_LDFLAGS = $(all_libraries) -module -avoid-version
-kformulamain_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kformula
-kformula_SOURCES = dummy.cc
-kformula_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kformula_LDADD = kformulamain.la
-
-dummy.cc:
-	echo > dummy.cc
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = kformula.la
+kformula_la_SOURCES = main.cc
+kformula_la_LDFLAGS = $(all_libraries) -module -avoid-version
+kformula_la_LIBADD = $(LIB_KOFFICECORE)
 
 noinst_HEADERS =  kformula_doc.h \
 		  kformula_view.h kformula_factory.h \
--- kformula/main.cc	25 Apr 2003 15:45:03 -0000	1.1.1.3
+++ kformula/main.cc	6 Jul 2003 21:05:01 -0000	1.2
@@ -31,7 +31,7 @@
         KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KCmdLineArgs::init( argc, argv, newKFormulaAboutData() );
     KCmdLineArgs::addCmdLineOptions( options );
--- kivio/kiviopart/Makefile.am	5 Jul 2003 18:32:14 -0000	1.1.1.5
+++ kivio/kiviopart/Makefile.am	6 Jul 2003 21:05:01 -0000	1.8
@@ -1,7 +1,9 @@
 SUBDIRS = ui kiviosdk tools pics tiles stencils .
 
 kde_module_LTLIBRARIES = libkiviopart.la
-libkiviopart_la_LIBADD = \
+lib_LTLIBRARIES = libkiviopart_shared.la
+
+libkiviopart_shared_la_LIBADD = \
 		$(top_builddir)/kivio/kiviopart/tools/libtools.la\
 		$(top_builddir)/kivio/kiviopart/kiviosdk/libkiviosdk.la\
 		$(top_builddir)/kivio/kiviopart/ui/libui.la \
@@ -16,8 +18,8 @@
 	-I$(top_srcdir)/lib/kformula\
 	$(all_includes)
 
-libkiviopart_la_METASOURCES = AUTO
-libkiviopart_la_SOURCES = kivio_canvas.cpp kivio_doc.cpp kivio_factory.cpp kivio_tabbar.cpp 	kivio_view.cpp kivio_map.cpp kivio_page.cpp kivio_dlg_pageshow.cpp kivio_zoomaction.cpp 	kivio_icon_view.cpp kivio_config.cpp kivio_spawner_drag.cpp kivio_intra_stencil_data.cpp	kivio_stackbar.cpp stencilbarbutton.cpp stencilbardockmanager.cpp stencilbarmovemanager.cpp	tooldockbase.cpp tooldockmanager.cpp stencil_text_dlg.cpp kivio_grid_data.cpp kivio_guidelines.cpp	kivio_stencil_geometry_panel.cpp kivio_viewmanager_panel.cpp KIvioViewIface.skel	KIvioViewIface.cc KIvioDocIface.skel KIvioDocIface.cc KIvioMapIface.skel KIvioMapIface.cc	KIvioPageIface.skel KIvioPageIface.cc kivio_command.cc KIvioLayerIface.skel KIvioLayerIface.cc	kivioglobal.cpp kiviostencilsetaction.cpp kivioarrowheadaction.cpp KIvioStencilIface.skel	KIvioStencilIface.cc kiviodragobject.cpp
+libkiviopart_shared_la_METASOURCES = AUTO
+libkiviopart_shared_la_SOURCES = kivio_canvas.cpp kivio_doc.cpp kivio_factory.cpp kivio_tabbar.cpp 	kivio_view.cpp kivio_map.cpp kivio_page.cpp kivio_dlg_pageshow.cpp kivio_zoomaction.cpp 	kivio_icon_view.cpp kivio_config.cpp kivio_spawner_drag.cpp kivio_intra_stencil_data.cpp	kivio_stackbar.cpp stencilbarbutton.cpp stencilbardockmanager.cpp stencilbarmovemanager.cpp	tooldockbase.cpp tooldockmanager.cpp stencil_text_dlg.cpp kivio_grid_data.cpp kivio_guidelines.cpp	kivio_stencil_geometry_panel.cpp kivio_viewmanager_panel.cpp KIvioViewIface.skel	KIvioViewIface.cc KIvioDocIface.skel KIvioDocIface.cc KIvioMapIface.skel KIvioMapIface.cc	KIvioPageIface.skel KIvioPageIface.cc kivio_command.cc KIvioLayerIface.skel KIvioLayerIface.cc	kivioglobal.cpp kiviostencilsetaction.cpp kivioarrowheadaction.cpp KIvioStencilIface.skel	KIvioStencilIface.cc kiviodragobject.cpp
 
 EXTRA_DIST = \
 		main.cpp\
@@ -95,20 +97,18 @@
 		kiviodragobject.cpp
 
 
-lib_LTLIBRARIES = kivio.la
+bin_PROGRAMS =
+kdeinit_LTLIBRARIES = kivio.la
+
 kivio_la_SOURCES = main.cpp
 kivio_la_LDFLAGS = $(all_libraries) -module -avoid-version
 kivio_la_LIBADD = ../../lib/kofficecore/libkofficecore.la
 
-libkiviopart_la_LDFLAGS = -avoid-version -module $(all_libraries) -no-undefined
-
-bin_PROGRAMS = kivio
-kivio_SOURCES = dummy.cpp
-kivio_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kivio_LDADD = kivio.la
+libkiviopart_shared_la_LDFLAGS = -avoid-version $(all_libraries) -no-undefined
 
-dummy.cpp:
-	echo > dummy.cpp
+libkiviopart_la_SOURCES = dummy.cpp
+libkiviopart_la_LIBADD  = libkiviopart_shared.la
+libkiviopart_la_LDFLAGS = -avoid-version $(all_libraries) $(KDE_PLUGIN) -module
 
 kdelnk_DATA = kivio.desktop
 kdelnkdir = $(kde_appsdir)/Office
--- kivio/kiviopart/main.cpp	25 Apr 2003 15:45:13 -0000	1.1.1.4
+++ kivio/kiviopart/main.cpp	6 Jul 2003 21:05:02 -0000	1.2
@@ -30,7 +30,7 @@
   KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
   KCmdLineArgs::init( argc, argv, newKivioAboutData() );
   KCmdLineArgs::addCmdLineOptions( options );
--- kivio/plugins/kivioconnectortool/Makefile.am	5 Jul 2003 18:32:27 -0000	1.1.1.5
+++ kivio/plugins/kivioconnectortool/Makefile.am	6 Jul 2003 14:11:50 -0000	1.5
@@ -1,5 +1,6 @@
 SUBDIRS = straight_connector
-lib_LTLIBRARIES =libkivioconnectortool.la
+
+kde_module_LTLIBRARIES =libkivioconnectortool.la
 
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart\
@@ -23,7 +24,7 @@
 		kivio_connector_cursor1.xpm
 
 libkivioconnectortool_la_LDFLAGS = -module $(KDE_PLUGIN)
-libkivioconnectortool_la_LIBADD = $(all_libraries) $(LIB_KOPAINTER) $(top_builddir)/kivio/kiviopart/libkiviopart.la
+libkivioconnectortool_la_LIBADD = $(all_libraries) $(LIB_KOPAINTER) $(top_builddir)/kivio/kiviopart/libkiviopart_shared.la
 
 rc_DATA = kivioconnectortool.rc
 rcdir = $(kde_datadir)/kivio/kpartplugins
--- kivio/plugins/kivioconnectortool/straight_connector/Makefile.am	5 Jul 2003 18:32:27 -0000	1.1.1.5
+++ kivio/plugins/kivioconnectortool/straight_connector/Makefile.am	6 Jul 2003 14:11:52 -0000	1.8
@@ -6,7 +6,7 @@
 straight_connector_la_LDFLAGS = -module $(KDE_PLUGIN) $(all_libraries)
 
 # Hack to make it work (dave m)
-straight_connector_la_LIBADD = $(LIB_KOPAINTER) $(top_builddir)/kivio/kiviopart/libkiviopart.la
+straight_connector_la_LIBADD = $(LIB_KOPAINTER) $(top_builddir)/kivio/kiviopart/libkiviopart_shared.la
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart\
 	-I$(top_srcdir)/kivio/kiviopart/kiviosdk\
--- kivio/plugins/kivioselecttool/Makefile.am	5 Jul 2003 18:32:27 -0000	1.1.1.5
+++ kivio/plugins/kivioselecttool/Makefile.am	6 Jul 2003 14:11:55 -0000	1.5
@@ -1,5 +1,5 @@
-SUBDIRS = select_pics
-lib_LTLIBRARIES =libkivioselecttool.la
+SUBDIRS = select_pics 
+kde_module_LTLIBRARIES =libkivioselecttool.la
 
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart\
@@ -18,7 +18,7 @@
 		tool_select.h\
 		kivioselecttool.rc
 libkivioselecttool_la_LDFLAGS = -module $(KDE_PLUGIN)
-libkivioselecttool_la_LIBADD = $(LIB_KOTEXT) $(LIB_KOPAINTER) $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart.la
+libkivioselecttool_la_LIBADD = $(LIB_KOTEXT) $(LIB_KOPAINTER) $(all_libraries) $(top_builddir)/kivio/kiviopart/libkiviopart_shared.la
 
 rc_DATA = kivioselecttool.rc
 rcdir = $(kde_datadir)/kivio/kpartplugins
--- kivio/plugins/kiviotexttool/Makefile.am	5 Jul 2003 18:32:27 -0000	1.1.1.5
+++ kivio/plugins/kiviotexttool/Makefile.am	6 Jul 2003 14:11:59 -0000	1.5
@@ -1,4 +1,4 @@
-lib_LTLIBRARIES =libkiviotexttool.la
+kde_module_LTLIBRARIES =libkiviotexttool.la
 
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart\
--- kivio/plugins/kiviozoomtool/Makefile.am	5 Jul 2003 18:32:27 -0000	1.1.1.5
+++ kivio/plugins/kiviozoomtool/Makefile.am	6 Jul 2003 14:12:01 -0000	1.5
@@ -1,5 +1,5 @@
-SUBDIRS = zoom_pics
-lib_LTLIBRARIES =libkiviozoomtool.la
+SUBDIRS = zoom_pics 
+kde_module_LTLIBRARIES =libkiviozoomtool.la
 
 INCLUDES = -I$(top_srcdir)/kivio/kiviopart\
 	-I$(top_srcdir)/kivio/kiviopart/kiviosdk\
--- koshell/Makefile.am	25 Apr 2003 15:45:37 -0000	1.1.1.2
+++ koshell/Makefile.am	7 Jul 2003 01:46:29 -0000
@@ -2,19 +2,19 @@
 INCLUDES  = $(KOFFICE_INCLUDES) $(all_includes)
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = koshell.la
-koshell_la_SOURCES = koshell_main.cc koshell_shell.cc
-koshell_la_LDFLAGS = $(all_libraries) -avoid-version -module
-koshell_la_LIBADD = $(LIB_KOFFICEUI)
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = koshell.la
+noinst_LTLIBRARIES = libkoshell_shared.la
 
-## The executable
-bin_PROGRAMS = koshell
-koshell_SOURCES = dummy.cc
-koshell_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-koshell_LDADD = koshell.la
+libkoshell_shared_la_SOURCES = koshell_shell.cc
+libkoshell_shared_la_LDFLAGS = $(all_libraries) -avoid-version -no-undefined
+libkoshell_shared_la_LIBADD = $(LIB_KOFFICEUI)
 
-dummy.cc:
-	echo > dummy.cc
+koshell_la_SOURCES = koshell_main.cc
+koshell_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+koshell_la_LIBADD  = libkoshell_shared.la
+koshell_la_DEPENDENCIES = libkoshell_shared.la
 
 noinst_HEADERS = koshell_shell.h
 
--- koshell/koshell_main.cc	25 Apr 2003 15:45:36 -0000	1.1.1.6
+++ koshell/koshell_main.cc	6 Jul 2003 21:05:03 -0000	1.2
@@ -30,7 +30,7 @@
 static const char* description=I18N_NOOP("KOffice Workspace");
 static const char* version=VERSION;
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
   KAboutData * aboutData = new KAboutData( "koshell", I18N_NOOP("KOffice Workspace"),
      version, description, KAboutData::License_GPL,
--- kpresenter/Makefile.am	25 Apr 2003 15:45:57 -0000	1.1.1.4
+++ kpresenter/Makefile.am	7 Jul 2003 01:46:29 -0000
@@ -54,19 +54,12 @@
 libkpresenterpart_la_METASOURCES = AUTO
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = kpresenter.la
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = kpresenter.la
 kpresenter_la_SOURCES = main.cc
-kpresenter_la_LDFLAGS = $(all_libraries) -avoid-version -module
+kpresenter_la_LDFLAGS = $(all_libraries) -avoid-version $(KDE_RPATH) -module
 kpresenter_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kpresenter
-kpresenter_SOURCES = dummy.cc
-kpresenter_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kpresenter_LDADD = kpresenter.la
-
-dummy.cc:
-	echo > dummy.cc
 
 noinst_HEADERS = koPointArray.h kprcanvas.h kprpage.h kpresenter_doc.h kpresenter_view.h \
 		backdia.h styledia.h \
--- kpresenter/kpresenter_view.cc	5 Jul 2003 18:32:37 -0000	1.1.1.7
+++ kpresenter/kpresenter_view.cc	6 Jul 2003 14:12:02 -0000	1.11
@@ -4276,7 +4276,7 @@
     //(Laurent) deselect object when we change page.
     //otherwise you can change object properties on other page
     deSelectAllObjects();
-    m_pKPresenterDoc->repaint( FALSE );
+    m_pKPresenterDoc->repaint( (bool)FALSE );
 
     m_pKPresenterDoc->displayActivePage( page );
 
--- kpresenter/main.cc	5 Jul 2003 18:32:42 -0000	1.1.1.4
+++ kpresenter/main.cc	6 Jul 2003 21:05:04 -0000	1.2
@@ -32,7 +32,7 @@
 	KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KCmdLineArgs::init( argc, argv, newKPresenterAboutData() );
     KCmdLineArgs::addCmdLineOptions( options );
--- kspread/Makefile.am	25 Apr 2003 15:46:34 -0000	1.1.1.4
+++ kspread/Makefile.am	7 Jul 2003 01:46:29 -0000
@@ -3,10 +3,10 @@
 	$(KOSCRIPT_INCLUDES) -I$(top_srcdir)/interfaces \
 	 -I$(top_srcdir)/kchart/kdchart $(all_includes)
 
-kde_module_LTLIBRARIES = libkspreadpart.la
+kde_module_LTLIBRARIES = libkspreadpart.la libkspreadpart_shared.la
 
 ## The part
-libkspreadpart_la_SOURCES = kspread_locale.cc \
+libkspreadpart_shared_la_SOURCES = kspread_locale.cc \
 	kspread_dlg_formula.cc digest.cc \
 	kspread_functions.cc kspread_dlg_csv.cc \
 	kspread_canvas.cc kspread_functions_helper.cc \
@@ -45,26 +45,27 @@
 	kspread_selection.cc kspread_dlg_paperlayout.cc kspread_format.cc \
         kspread_sheetprint.cc
 
-libkspreadpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN)
-libkspreadpart_la_LIBADD = $(top_builddir)/interfaces/libkochart.la \
+libkspreadpart_shared_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version -no-undefined
+libkspreadpart_shared_la_LIBADD = $(top_builddir)/interfaces/libkochart.la \
 	$(LIB_KOSCRIPT) $(LIB_KOFFICEUI) $(LIB_KOTEXT) -lkspell
 
+libkspreadpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN)
+libkspreadpart_la_LIBADD  = libkspreadpart_shared.la
+libkspreadpart_la_SOURCES = dummy.cpp
+libkspreadpart_la_DEPENDENCIES = libkspreadpart_shared.la
+
+dummy.cpp:
+	echo > dummy.cpp
+
 METASOURCES = AUTO
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES =  kspread.la
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES =  kspread.la
 kspread_la_SOURCES = main.cc
 kspread_la_LDFLAGS = $(all_libraries) -avoid-version -module
-kspread_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kspread
-kspread_SOURCES = dummy.cc
-kspread_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kspread_LDADD = kspread.la
-
-dummy.cc:
-	echo > dummy.cc
+kspread_la_LIBADD = $(LIB_KOFFICECORE) libkspreadpart_shared.la
 
 noinst_HEADERS = kspread_doc.h kspread_functions.h kspread_functions_helper.h \
 	kspread_undo.h kspread_view.h kspread_tabbar.h \
--- kspread/main.cc	25 Apr 2003 15:46:34 -0000	1.1.1.3
+++ kspread/main.cc	6 Jul 2003 21:05:04 -0000	1.2
@@ -30,7 +30,7 @@
         KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
 
     KCmdLineArgs::init( argc, argv, newKSpreadAboutData() );
--- kspread/plugins/calculator/Makefile.am	25 Apr 2003 15:46:36 -0000	1.1.1.2
+++ kspread/plugins/calculator/Makefile.am	26 Apr 2003 02:07:38 -0000	1.3
@@ -9,7 +9,7 @@
 			main.cpp \
 			stats.cpp
 libkspreadcalc_la_LDFLAGS = -avoid-version -module -no-undefined
-libkspreadcalc_la_LIBADD = $(all_libraries) ../../libkspreadpart.la
+libkspreadcalc_la_LIBADD = $(all_libraries) ../../libkspreadpart_shared.la
 
 METASOURCES = AUTO
 
--- kugar/kudesigner/Makefile.am	5 Jul 2003 18:33:16 -0000	1.1.1.5
+++ kugar/kudesigner/Makefile.am	6 Jul 2003 21:05:05 -0000	1.5
@@ -4,30 +4,24 @@
 
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = libkudesignercore.la kudesigner.la
+lib_LTLIBRARIES = libkudesignercore.la
 libkudesignercore_la_SOURCES = kudesigner_view.cpp kudesigner_factory.cpp kudesigner_doc.cpp
-libkudesignercore_la_LDFLAGS = -avoid-version -module $(all_libraries) $(KDE_RPATH)
+libkudesignercore_la_LDFLAGS = -avoid-version $(all_libraries) $(KDE_RPATH)
 libkudesignercore_la_LIBADD = ../kudesigner_lib/libkudesignercommon.la $(LIB_KOFFICEUI) $(LIB_KPARTS) $(LIB_KOFFICECORE) $(LIB_KIO) $(LIB_KDEPRINT)
 
 ## The part
 kde_module_LTLIBRARIES = libkudesignerpart.la
 libkudesignerpart_la_SOURCES = kudesigner_part.cpp
-libkudesignerpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) $(KDE_RPATH)
+libkudesignerpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) $(KDE_RPATH) -module
 libkudesignerpart_la_LIBADD = libkudesignercore.la $(LIB_KOFFICEUI) $(LIB_KPARTS) $(LIB_KOFFICECORE)
 
+bin_PROGRAMS =
+kdeinit_LTLIBRARIES = kudesigner.la
+
 ## The kdeinit loadable module
 kudesigner_la_SOURCES = main.cpp
-kudesigner_la_LDFLAGS = $(all_libraries) -module -avoid-version
+kudesigner_la_LDFLAGS = $(all_libraries) -avoid-version $(KDE_PLUGIN) -module
 kudesigner_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kudesigner
-kudesigner_SOURCES = dummy.cc
-kudesigner_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kudesigner_LDADD = kudesigner.la
-
-dummy.cc:
-	echo > dummy.cc
 
 appsdir = $(kde_appsdir)/Office
 apps_DATA = kudesigner.desktop
--- kugar/kudesigner/main.cpp	5 Jul 2003 18:33:16 -0000	1.1.1.5
+++ kugar/kudesigner/main.cpp	7 Jul 2003 01:46:29 -0000
@@ -32,7 +32,7 @@
 	KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KLocale::setMainCatalogue("kugar");
     KCmdLineArgs::init( argc, argv, newKudesignerAboutData() );
--- kugar/part/Makefile.am	25 Apr 2003 15:46:43 -0000	1.1.1.2
+++ kugar/part/Makefile.am	7 Jul 2003 01:46:29 -0000
@@ -2,7 +2,7 @@
 
 kde_module_LTLIBRARIES = libkugarpart.la
 libkugarpart_la_SOURCES = kugar_part.cpp kugar_factory.cpp kugar_view.cpp
-libkugarpart_la_LDFLAGS = $(all_libraries) -module -avoid-version
+libkugarpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) -module -avoid-version
 libkugarpart_la_LIBADD = ../lib/libkugar.la $(LIB_KPARTS) $(LIB_KDEPRINT) $(LIB_KOFFICECORE)
 
 libkugarpart_la_METASOURCES = AUTO
@@ -26,16 +26,9 @@
 
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = kugar.la
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = kugar.la
 kugar_la_SOURCES = main.cpp
 kugar_la_LDFLAGS = $(all_libraries) -module -avoid-version
 kugar_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kugar
-kugar_SOURCES = dummy.cc
-kugar_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kugar_LDADD = kugar.la
-
-dummy.cc:
-	echo > dummy.cc
--- kugar/part/main.cpp	5 Jul 2003 18:33:21 -0000	1.1.1.2
+++ kugar/part/main.cpp	7 Jul 2003 01:46:29 -0000
@@ -28,7 +28,7 @@
   // INSERT YOUR COMMANDLINE OPTIONS HERE
 };
 
-int main(int argc, char *argv[])
+extern "C" int kdemain(int argc, char *argv[])
 {
 
 	KCmdLineArgs::init( argc, argv, newKugarAboutData() );
--- kword/Makefile.am	5 Jul 2003 18:33:34 -0000	1.1.1.5
+++ kword/Makefile.am	6 Jul 2003 21:05:06 -0000	1.6
@@ -1,3 +1,4 @@
+KDE_OPTIONS = nofinal
 
 KDE_CXXFLAGS = $(USE_RTTI)
 INCLUDES = $(KOFFICE_INCLUDES) -I$(top_srcdir)/lib/kformula \
@@ -48,7 +49,7 @@
 libkwordpart_la_LIBADD = $(LIB_KOFFICEUI) $(LIB_KOTEXT) ../lib/kformula/libkformula.la -lkspell $(LIBKOSPELL) ./libkwmailmerge_interface.la
 METASOURCES = AUTO
 
-lib_LTLIBRARIES = kword.la libkwmailmerge_interface.la
+lib_LTLIBRARIES = libkwmailmerge_interface.la
 
 ## The mailmerge interface library
 libkwmailmerge_interface_la_SOURCES = mailmerge_interface.cc mailmerge_interface.skel
@@ -61,18 +62,11 @@
 kwmailmerge_servicetypedir=$(kde_servicetypesdir)
 
 ## The kdeinit loadable module
+bin_PROGRAMS =
+kdeinit_LTLIBRARIES = kword.la
 kword_la_SOURCES = main.cc
-kword_la_LDFLAGS = $(all_libraries) -avoid-version -module
-kword_la_LIBADD = ../lib/kofficecore/libkofficecore.la
-
-## The executable
-bin_PROGRAMS = kword
-kword_SOURCES = dummy.cc
-kword_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kword_LDADD = kword.la
-
-dummy.cc:
-	echo > dummy.cc
+kword_la_LDFLAGS = $(all_libraries) -avoid-version $(KDE_PLUGIN) -module
+kword_la_LIBADD = $(LIB_KOFFICECORE)
 
 kdelnk_DATA = kword.desktop
 kdelnkdir = $(kde_appsdir)/Office
--- kword/main.cc	25 Apr 2003 15:46:57 -0000	1.1.1.3
+++ kword/main.cc	6 Jul 2003 21:05:06 -0000	1.2
@@ -28,7 +28,7 @@
 	KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KCmdLineArgs::init( argc, argv, newKWordAboutData());
     KCmdLineArgs::addCmdLineOptions( options );
