diff -uNr koffice-1.2.94/example/Makefile.am koffice-1.2.94-patched/example/Makefile.am
--- koffice-1.2.94/example/Makefile.am	Fri Dec 13 13:55:15 2002
+++ koffice-1.2.94-patched/example/Makefile.am	Fri Nov  7 20:50:13 2003
@@ -8,20 +8,13 @@
 libexamplepart_la_LDFLAGS = $(KDE_PLUGIN)
 libexamplepart_la_LIBADD = $(LIB_KOFFICEUI)
 
-## The kdeinit loadable module
-lib_LTLIBRARIES = example.la
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = example.la
+
 example_la_SOURCES = main.cc
 example_la_LDFLAGS = $(all_libraries) -module -avoid-version
 example_la_LIBADD = $(LIB_KOFFICEUI)
-
-## The executable
-bin_PROGRAMS = example
-example_SOURCES = dummy.cc
-example_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-example_LDADD = example.la
-
-dummy.cc:
-	echo > dummy.cc
 
 METASOURCES = AUTO
 noinst_HEADERS =  example_part.h \
diff -uNr koffice-1.2.94/example/main.cc koffice-1.2.94-patched/example/main.cc
--- koffice-1.2.94/example/main.cc	Thu May 15 08:31:41 2003
+++ koffice-1.2.94-patched/example/main.cc	Fri Nov  7 20:50:30 2003
@@ -32,7 +32,7 @@
 	KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KCmdLineArgs::init( argc, argv, newExampleAboutData() );
     KCmdLineArgs::addCmdLineOptions( options );
diff -uNr koffice-1.2.94/filters/kontour/latex/launcher/Makefile.am koffice-1.2.94-patched/filters/kontour/latex/launcher/Makefile.am
--- koffice-1.2.94/filters/kontour/latex/launcher/Makefile.am	Sun Jul 15 11:09:54 2001
+++ koffice-1.2.94-patched/filters/kontour/latex/launcher/Makefile.am	Fri Nov  7 20:54:31 2003
@@ -2,7 +2,9 @@
 
 INCLUDES= -I.. $(KOFFICE_INCLUDES) $(all_includes)
  
-bin_PROGRAMS = texlauncher
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = texlauncher.la
 
 texlauncher_SOURCES = texlauncher.cc
 texlauncher_LDADD = $(KOFFICE_LIBS) ../libtexgraphexport.la
diff -uNr koffice-1.2.94/filters/kontour/latex/launcher/texlauncher.cc koffice-1.2.94-patched/filters/kontour/latex/launcher/texlauncher.cc
--- koffice-1.2.94/filters/kontour/latex/launcher/texlauncher.cc	Sun Jul 15 11:09:54 2001
+++ koffice-1.2.94-patched/filters/kontour/latex/launcher/texlauncher.cc	Fri Nov  7 20:54:48 2003
@@ -6,7 +6,7 @@
 #include <koFilter.h>
 #include <koStore.h>
 
-int main(int argc, char* argv[])
+extern "C" int kdemain(int argc, char* argv[])
 {
 	kdDebug() << argv[0] << endl;
 	kdDebug() << argv[1] << endl;
diff -uNr koffice-1.2.94/karbon/Makefile.am koffice-1.2.94-patched/karbon/Makefile.am
--- koffice-1.2.94/karbon/Makefile.am	Mon Oct 27 08:17:35 2003
+++ koffice-1.2.94-patched/karbon/Makefile.am	Fri Nov  7 21:34:08 2003
@@ -12,22 +12,21 @@
 
 SUBDIRS = commands visitors core shapes widgets dialogs dockers render tools . plugins data pics
 
-bin_PROGRAMS = karbon
-
-lib_LTLIBRARIES = karbon.la
-kde_module_LTLIBRARIES = libkarbonbase.la libkarbonpart.la
-
-libkarbonpart_la_SOURCES = karbon_factory.cc 	karbon_resourceserver.cc 	karbon_part.cc 	karbon_part_iface.cc 	karbon_part_iface.skel 	karbon_view.cc 	karbon_view_iface.cc 	karbon_view_iface.skel karbon_drag.cpp
+bin_PROGRAMS = 
+lib_LTLIBRARIES = libkarboncommon.la libkarbonbase.la
+kdeinit_LTLIBRARIES = karbon.la
+kde_module_LTLIBRARIES = libkarbonpart.la
 
 libkarbonbase_la_SOURCES = \
 	karbon_view_base.cc \
 	karbon_part_base.cc
 
-libkarbonbase_la_LDFLAGS = $(KDE_PLUGIN)
+libkarbonbase_la_LDFLAGS = $(KDE_RPATH)
 libkarbonbase_la_LIBADD = $(LIB_KOFFICEUI)
 
-libkarbonpart_la_LDFLAGS = $(KDE_PLUGIN) $(LIBFREETYPE_RPATH)
-libkarbonpart_la_LIBADD = $(LIB_KOFFICEUI) $(LIB_KOPAINTER) \
+libkarboncommon_la_SOURCES = karbon_factory.cc 	karbon_resourceserver.cc 	karbon_part.cc 	karbon_part_iface.cc 	karbon_part_iface.skel 	karbon_view.cc 	karbon_view_iface.cc 	karbon_view_iface.skel karbon_drag.cpp
+libkarboncommon_la_LDFLAGS = $(KDE_PLUGIN) $(LIBFREETYPE_RPATH)
+libkarboncommon_la_LIBADD  = $(LIB_KOFFICEUI) $(LIB_KOPAINTER) \
 	dockers/libkarbondockers.la \
 	widgets/libkarbonwidgets.la \
 	render/libvpainter.la \
@@ -43,18 +42,17 @@
 	$(LIBFONTCONFIG_LIBS) \
 	$(LIBFREETYPE_LIBS)
 
+libkarbonpart_la_SOURCES = dummy.cpp
+libkarbonpart_la_LDFLAGS = $(KDE_PLUGIN) $(LIBFREETYPE_RPATH)
+libkarbonpart_la_LIBADD = libkarboncommon.la
 libkarbonpart_la_METASOURCES = AUTO
 
 karbon_la_SOURCES = main.cc
 karbon_la_LDFLAGS = $(all_libraries) -module -avoid-version
-karbon_la_LIBADD = libkarbonpart.la
-
-karbon_SOURCES = dummy.cc
-karbon_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-karbon_LDADD = karbon.la
+karbon_la_LIBADD = libkarboncommon.la
 
-dummy.cc:
-	echo > dummy.cc
+dummy.cpp:
+	echo > dummy.cpp
 
 noinst_HEADERS = \
 	karbon_factory.h \
diff -uNr koffice-1.2.94/karbon/main.cc koffice-1.2.94-patched/karbon/main.cc
--- koffice-1.2.94/karbon/main.cc	Thu May 15 08:31:42 2003
+++ koffice-1.2.94-patched/karbon/main.cc	Fri Nov  7 20:58:02 2003
@@ -34,7 +34,7 @@
 		KCmdLineLastOption
 	};
 
-int main( int argc, char* argv[] )
+extern "C" int kdemain( int argc, char* argv[] )
 {
 	KCmdLineArgs::init( argc, argv, KarbonFactory::aboutData() );
 	KCmdLineArgs::addCmdLineOptions( options );
diff -uNr koffice-1.2.94/kchart/Makefile.am koffice-1.2.94-patched/kchart/Makefile.am
--- koffice-1.2.94/kchart/Makefile.am	Mon Sep 22 07:06:03 2003
+++ koffice-1.2.94-patched/kchart/Makefile.am	Fri Nov  7 21:39:25 2003
@@ -1,5 +1,8 @@
 INCLUDES  = $(KOFFICE_INCLUDES) -I$(srcdir)/kdchart -I$(top_srcdir)/interfaces -I$(interfacedir) $(all_includes)
 
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+
 ## The part
 kde_module_LTLIBRARIES = libkchartpart.la
 libkchartpart_la_SOURCES = kchart_part.cc \
@@ -39,19 +42,10 @@
 			  kdchart/libkdchart.la			
 
 ## The kdeinit loadable module
-lib_LTLIBRARIES = kchart.la
+kdeinit_LTLIBRARIES = kchart.la
 kchart_la_SOURCES = main.cc
 kchart_la_LDFLAGS = $(all_libraries) -avoid-version -module
 kchart_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kchart
-kchart_SOURCES = dummy.cc
-kchart_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kchart_LDADD = kchart.la
-
-dummy.cc:
-	echo > dummy.cc
 
 noinst_HEADERS =  kchart_part.h \
 		kchart_view.h kchart_factory.h \
diff -uNr koffice-1.2.94/kchart/main.cc koffice-1.2.94-patched/kchart/main.cc
--- koffice-1.2.94/kchart/main.cc	Thu Jan 23 04:10:23 2003
+++ koffice-1.2.94-patched/kchart/main.cc	Fri Nov  7 21:35:28 2003
@@ -28,7 +28,7 @@
 	KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KCmdLineArgs::init( argc, argv, newKChartAboutData());
     KCmdLineArgs::addCmdLineOptions( options );
diff -uNr koffice-1.2.94/kformula/Makefile.am koffice-1.2.94-patched/kformula/Makefile.am
--- koffice-1.2.94/kformula/Makefile.am	Sat Jan 18 15:01:07 2003
+++ koffice-1.2.94-patched/kformula/Makefile.am	Fri Nov  7 21:40:54 2003
@@ -11,20 +11,13 @@
 libkformulapart_la_LIBADD = $(LIB_KOFFICEUI) $(LIB_KFORMULA) $(LIB_KOTEXT)
 libkformulapart_la_METASOURCES = AUTO
 
-## The kdeinit loadable module
-lib_LTLIBRARIES = kformulamain.la
-kformulamain_la_SOURCES = main.cc
-kformulamain_la_LDFLAGS = $(all_libraries) -module -avoid-version
-kformulamain_la_LIBADD = $(LIB_KOFFICECORE)
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = kformula.la
 
-## The executable
-bin_PROGRAMS = kformula
-kformula_SOURCES = dummy.cc
-kformula_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kformula_LDADD = kformulamain.la
-
-dummy.cc:
-	echo > dummy.cc
+kformula_la_SOURCES = main.cc
+kformula_la_LDFLAGS = $(all_libraries) -module -avoid-version
+kformula_la_LIBADD = $(LIB_KOFFICECORE)
 
 noinst_HEADERS =  kformula_doc.h \
 		  kformula_view.h kformula_factory.h \
diff -uNr koffice-1.2.94/kformula/main.cc koffice-1.2.94-patched/kformula/main.cc
--- koffice-1.2.94/kformula/main.cc	Thu Jan 23 04:10:23 2003
+++ koffice-1.2.94-patched/kformula/main.cc	Fri Nov  7 21:41:43 2003
@@ -31,7 +31,7 @@
         KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KCmdLineArgs::init( argc, argv, newKFormulaAboutData() );
     KCmdLineArgs::addCmdLineOptions( options );
diff -uNr koffice-1.2.94/kivio/kiviopart/Makefile.am koffice-1.2.94-patched/kivio/kiviopart/Makefile.am
--- koffice-1.2.94/kivio/kiviopart/Makefile.am	Mon Jul 14 10:07:53 2003
+++ koffice-1.2.94-patched/kivio/kiviopart/Makefile.am	Fri Nov  7 21:41:55 2003
@@ -37,31 +37,16 @@
 	KIvioStencilIface.cc kiviodragobject.cpp
 
 
-lib_LTLIBRARIES = kivio.la
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = kivio.la
 
 kivio_la_SOURCES = main.cpp
-
 kivio_la_LDFLAGS = $(all_libraries) -module -avoid-version
-
 kivio_la_LIBADD = ../../lib/kofficecore/libkofficecore.la
 
-
-bin_PROGRAMS = kivio
-
-kivio_SOURCES = dummy.cpp
-
-kivio_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-
-kivio_LDADD = kivio.la
-
-
-dummy.cpp:
-	echo > dummy.cpp
-
-
 kdelnk_DATA = kivio.desktop
 kdelnkdir = $(kde_appsdir)/Office
-
 
 rc_DATA = kivio.rc kivio_readonly.rc
 rcdir = $(kde_datadir)/kivio
diff -uNr koffice-1.2.94/koshell/Makefile.am koffice-1.2.94-patched/koshell/Makefile.am
--- koffice-1.2.94/koshell/Makefile.am	Sun Dec  8 16:12:27 2002
+++ koffice-1.2.94-patched/koshell/Makefile.am	Fri Nov  7 21:42:33 2003
@@ -1,20 +1,13 @@
 
 INCLUDES  = $(KOFFICE_INCLUDES) $(all_includes)
 
-## The kdeinit loadable module
-lib_LTLIBRARIES = koshell.la
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = koshell.la
+
 koshell_la_SOURCES = koshell_main.cc koshell_shell.cc
 koshell_la_LDFLAGS = $(all_libraries) -avoid-version -module
 koshell_la_LIBADD = $(LIB_KOFFICEUI)
-
-## The executable
-bin_PROGRAMS = koshell
-koshell_SOURCES = dummy.cc
-koshell_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-koshell_LDADD = koshell.la
-
-dummy.cc:
-	echo > dummy.cc
 
 noinst_HEADERS = koshell_shell.h
 
diff -uNr koffice-1.2.94/koshell/koshell_main.cc koffice-1.2.94-patched/koshell/koshell_main.cc
--- koffice-1.2.94/koshell/koshell_main.cc	Mon Jan 20 09:58:49 2003
+++ koffice-1.2.94-patched/koshell/koshell_main.cc	Fri Nov  7 21:42:44 2003
@@ -30,7 +30,7 @@
 static const char* description=I18N_NOOP("KOffice Workspace");
 static const char* version=VERSION;
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
   KAboutData * aboutData = new KAboutData( "koshell", I18N_NOOP("KOffice Workspace"),
      version, description, KAboutData::License_GPL,
diff -uNr koffice-1.2.94/kpresenter/Makefile.am koffice-1.2.94-patched/kpresenter/Makefile.am
--- koffice-1.2.94/kpresenter/Makefile.am	Mon Jul 14 10:08:13 2003
+++ koffice-1.2.94-patched/kpresenter/Makefile.am	Fri Nov  7 21:46:26 2003
@@ -53,20 +53,13 @@
 libkpresenterpart_la_LIBADD = autoformEdit/libaf.la $(LIB_KOFFICEUI) $(LIB_KOTEXT) -lkspell $(LIBKOSPELL) -lartskde -lkdefx
 libkpresenterpart_la_METASOURCES = AUTO
 
-## The kdeinit loadable module
-lib_LTLIBRARIES = kpresenter.la
+lib_LTLIBRARIES =
+bin_PROGRAMS =
+kdeinit_LTLIBRARIES = kpresenter.la
+
 kpresenter_la_SOURCES = main.cc
 kpresenter_la_LDFLAGS = $(all_libraries) -avoid-version -module
 kpresenter_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kpresenter
-kpresenter_SOURCES = dummy.cc
-kpresenter_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kpresenter_LDADD = kpresenter.la
-
-dummy.cc:
-	echo > dummy.cc
 
 noinst_HEADERS = koPointArray.h kprcanvas.h kprpage.h kpresenter_doc.h kpresenter_view.h \
 		backdia.h styledia.h \
diff -uNr koffice-1.2.94/kpresenter/main.cc koffice-1.2.94-patched/kpresenter/main.cc
--- koffice-1.2.94/kpresenter/main.cc	Fri Apr 25 09:52:27 2003
+++ koffice-1.2.94-patched/kpresenter/main.cc	Fri Nov  7 21:46:39 2003
@@ -32,7 +32,7 @@
 	KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KCmdLineArgs::init( argc, argv, newKPresenterAboutData() );
     KCmdLineArgs::addCmdLineOptions( options );
diff -uNr koffice-1.2.94/kspread/Makefile.am koffice-1.2.94-patched/kspread/Makefile.am
--- koffice-1.2.94/kspread/Makefile.am	Mon Oct 27 08:21:14 2003
+++ koffice-1.2.94-patched/kspread/Makefile.am	Fri Nov  7 21:48:21 2003
@@ -51,20 +51,13 @@
 
 METASOURCES = AUTO
 
-## The kdeinit loadable module
-lib_LTLIBRARIES =  kspread.la
+lib_LTLIBRARIES =
+bin_PROGRAMS =
+kdeinit_LTLIBRARIES = kspread.la
+
 kspread_la_SOURCES = main.cc
 kspread_la_LDFLAGS = $(all_libraries) -avoid-version -module
 kspread_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kspread
-kspread_SOURCES = dummy.cc
-kspread_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kspread_LDADD = kspread.la
-
-dummy.cc:
-	echo > dummy.cc
 
 noinst_HEADERS = kspread_doc.h kspread_functions.h kspread_functions_helper.h \
 	kspread_undo.h kspread_view.h kspread_tabbar.h \
diff -uNr koffice-1.2.94/kspread/main.cc koffice-1.2.94-patched/kspread/main.cc
--- koffice-1.2.94/kspread/main.cc	Thu Jan 23 04:10:24 2003
+++ koffice-1.2.94-patched/kspread/main.cc	Fri Nov  7 21:48:31 2003
@@ -30,7 +30,7 @@
         KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
 
     KCmdLineArgs::init( argc, argv, newKSpreadAboutData() );
diff -uNr koffice-1.2.94/kugar/kudesigner/Makefile.am koffice-1.2.94-patched/kugar/kudesigner/Makefile.am
--- koffice-1.2.94/kugar/kudesigner/Makefile.am	Fri May 30 16:07:52 2003
+++ koffice-1.2.94-patched/kugar/kudesigner/Makefile.am	Fri Nov  7 21:50:15 2003
@@ -2,6 +2,7 @@
 
 INCLUDES = -I$(srcdir)/../kudesigner_lib -I$(srcdir)/../lib $(KOFFICE_INCLUDES) $(all_includes)
 
+bin_PROGRAMS =
 
 ## The kdeinit loadable module
 lib_LTLIBRARIES = libkudesignercore.la kudesigner.la
@@ -15,19 +16,10 @@
 libkudesignerpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) $(KDE_RPATH)
 libkudesignerpart_la_LIBADD = libkudesignercore.la $(LIB_KOFFICEUI) $(LIB_KPARTS) $(LIB_KOFFICECORE)
 
-## The kdeinit loadable module
+kdeinit_LTLIBRARIES = kudesigner.la
 kudesigner_la_SOURCES = main.cpp
 kudesigner_la_LDFLAGS = $(all_libraries) -module -avoid-version
 kudesigner_la_LIBADD = $(LIB_KOFFICECORE)
-
-## The executable
-bin_PROGRAMS = kudesigner
-kudesigner_SOURCES = dummy.cc
-kudesigner_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kudesigner_LDADD = kudesigner.la
-
-dummy.cc:
-	echo > dummy.cc
 
 appsdir = $(kde_appsdir)/Office
 apps_DATA = kudesigner.desktop
diff -uNr koffice-1.2.94/kugar/kudesigner/main.cpp koffice-1.2.94-patched/kugar/kudesigner/main.cpp
--- koffice-1.2.94/kugar/kudesigner/main.cpp	Wed May 28 16:35:18 2003
+++ koffice-1.2.94-patched/kugar/kudesigner/main.cpp	Fri Nov  7 21:49:51 2003
@@ -32,7 +32,7 @@
 	KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KLocale::setMainCatalogue("kugar");
     KCmdLineArgs::init( argc, argv, newKudesignerAboutData() );
diff -uNr koffice-1.2.94/kugar/part/Makefile.am koffice-1.2.94-patched/kugar/part/Makefile.am
--- koffice-1.2.94/kugar/part/Makefile.am	Mon Nov 25 16:08:11 2002
+++ koffice-1.2.94-patched/kugar/part/Makefile.am	Fri Nov  7 21:51:02 2003
@@ -24,18 +24,11 @@
 
 CLEANFILES = kugarpart_meta_unload.cpp
 
+bin_PROGRAMS =
+lib_LTLIBRARIES =
 
-## The kdeinit loadable module
-lib_LTLIBRARIES = kugar.la
+kdeinit_LTLIBRARIES = kugar.la
 kugar_la_SOURCES = main.cpp
 kugar_la_LDFLAGS = $(all_libraries) -module -avoid-version
 kugar_la_LIBADD = $(LIB_KOFFICECORE)
 
-## The executable
-bin_PROGRAMS = kugar
-kugar_SOURCES = dummy.cc
-kugar_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kugar_LDADD = kugar.la
-
-dummy.cc:
-	echo > dummy.cc
diff -uNr koffice-1.2.94/kugar/part/main.cpp koffice-1.2.94-patched/kugar/part/main.cpp
--- koffice-1.2.94/kugar/part/main.cpp	Thu May 15 08:31:45 2003
+++ koffice-1.2.94-patched/kugar/part/main.cpp	Fri Nov  7 21:51:13 2003
@@ -28,7 +28,7 @@
   // INSERT YOUR COMMANDLINE OPTIONS HERE
 };
 
-int main(int argc, char *argv[])
+extern "C" int kdemain(int argc, char *argv[])
 {
 
 	KCmdLineArgs::init( argc, argv, newKugarAboutData() );
diff -uNr koffice-1.2.94/kugar/shell/Makefile.am koffice-1.2.94-patched/kugar/shell/Makefile.am
--- koffice-1.2.94/kugar/shell/Makefile.am	Thu Mar 29 07:32:02 2001
+++ koffice-1.2.94-patched/kugar/shell/Makefile.am	Fri Nov  7 21:52:11 2003
@@ -1,9 +1,13 @@
 INCLUDES = -I$(srcdir)/../lib $(KOFFICE_INCLUDES) $(all_includes)
 
-bin_PROGRAMS = kugar
-kugar_SOURCES = main.cpp report.cpp
-kugar_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kugar_LDADD = ../lib/libkugar.la $(LIB_KIO) $(LIB_KDEPRINT)
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+
+kdeinit_LTLIBRARIES = kugar.la
+
+kugar_la_SOURCES = main.cpp report.cpp
+kugar_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+kugar_la_LIBADD = ../lib/libkugar.la $(LIB_KIO) $(LIB_KDEPRINT)
 
 kugar_METASOURCES = AUTO
 
diff -uNr koffice-1.2.94/kugar/shell/main.cpp koffice-1.2.94-patched/kugar/shell/main.cpp
--- koffice-1.2.94/kugar/shell/main.cpp	Mon Apr 21 07:11:18 2003
+++ koffice-1.2.94-patched/kugar/shell/main.cpp	Fri Nov  7 21:52:22 2003
@@ -16,7 +16,7 @@
 #include "report.h"
 
 
-int main(int argc,char **argv)
+extern "C" int kdemain(int argc,char **argv)
 {
 	KAboutData about("kugar", I18N_NOOP("Kugar"), VERSION,
 		I18N_NOOP("A template driven report viewer for XML data."),
diff -uNr koffice-1.2.94/kword/Makefile.am koffice-1.2.94-patched/kword/Makefile.am
--- koffice-1.2.94/kword/Makefile.am	Wed Sep 24 07:52:14 2003
+++ koffice-1.2.94-patched/kword/Makefile.am	Fri Nov  7 21:53:19 2003
@@ -49,7 +49,8 @@
 libkwordpart_la_LIBADD = $(LIB_KOFFICEUI) $(LIB_KOTEXT) ../lib/kformula/libkformula.la -lkspell $(LIBKOSPELL) ./libkwmailmerge_interface.la
 METASOURCES = AUTO
 
-lib_LTLIBRARIES = kword.la libkwmailmerge_interface.la
+lib_LTLIBRARIES = ibkwmailmerge_interface.la
+bin_PROGRAMS =
 
 ## The mailmerge interface library
 libkwmailmerge_interface_la_SOURCES = mailmerge_interface.cc mailmerge_interface.skel
@@ -61,19 +62,10 @@
 kwmailmerge_servicetype_DATA=kwmailmerge.desktop
 kwmailmerge_servicetypedir=$(kde_servicetypesdir)
 
-## The kdeinit loadable module
+kdeinit_LTLIBRARIES = kword.la
 kword_la_SOURCES = main.cc
 kword_la_LDFLAGS = $(all_libraries) -avoid-version -module
 kword_la_LIBADD = ../lib/kofficecore/libkofficecore.la
-
-## The executable
-bin_PROGRAMS = kword
-kword_SOURCES = dummy.cc
-kword_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kword_LDADD = kword.la
-
-dummy.cc:
-	echo > dummy.cc
 
 kdelnk_DATA = kword.desktop
 kdelnkdir = $(kde_appsdir)/Office
diff -uNr koffice-1.2.94/kword/main.cc koffice-1.2.94-patched/kword/main.cc
--- koffice-1.2.94/kword/main.cc	Thu Jan 23 04:10:24 2003
+++ koffice-1.2.94-patched/kword/main.cc	Fri Nov  7 21:53:33 2003
@@ -28,7 +28,7 @@
 	KCmdLineLastOption
 };
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KCmdLineArgs::init( argc, argv, newKWordAboutData());
     KCmdLineArgs::addCmdLineOptions( options );
diff -uNr koffice-1.2.94/lib/koscript/Makefile.am koffice-1.2.94-patched/lib/koscript/Makefile.am
--- koffice-1.2.94/lib/koscript/Makefile.am	Sat May 18 03:58:18 2002
+++ koffice-1.2.94-patched/lib/koscript/Makefile.am	Fri Nov  7 21:54:54 2003
@@ -4,19 +4,22 @@
 
 ####### Files
 
-lib_LTLIBRARIES = libkoscript.la
-libkoscript_la_SOURCES = koscript_locale.cc \
+lib_LTLIBRARIES = libkoscriptcommon.la
+bin_PROGRAMS =
+
+kdeinit_LTLIBRARIES = libkoscript.la
+
+libkoscriptcommon_la_SOURCES = koscript_locale.cc \
 		  koscript_eval.cc koscript_func.cc koscript_property.cc koscript_method.cc \
 		  koscript_context.cc koscript_value.cc koscript_parser.cc koscript_parsenode.cc yacc.cc \
                   scanner.cc koscript.cc koscript_util.cc koscript_struct.cc
-libkoscript_la_METASOURCES = AUTO
-libkoscript_la_LDFLAGS = -version-info 2:0:0 -no-undefined $(all_libraries)
-libkoscript_la_LIBADD = $(LIB_KDEUI)
+libkoscriptcommon_la_METASOURCES = AUTO
+libkoscriptcommon_la_LDFLAGS = -version-info 2:0:0 -no-undefined $(all_libraries)
+libkoscriptcommon_la_LIBADD = $(LIB_KDEUI)
 
-bin_PROGRAMS = koscript
-koscript_SOURCES = main.cc
-koscript_LDADD = ./libkoscript.la $(all_libraries)
-koscript_LDFLAGS = $(KDE_RPATH)
+koscript_la_SOURCES = main.cc
+koscript_la_LIBADD = libkoscriptcommon.la $(all_libraries)
+koscript_la_LDFLAGS = $(KDE_RPATH) -module -avoid-version
 
 noinst_HEADERS = koscript_locale.h \
 		 koscript_eval.h koscript_func.h koscript_context.h koscript_value.h \
diff -uNr koffice-1.2.94/lib/koscript/main.cc koffice-1.2.94-patched/lib/koscript/main.cc
--- koffice-1.2.94/lib/koscript/main.cc	Thu Jan 23 04:10:24 2003
+++ koffice-1.2.94-patched/lib/koscript/main.cc	Fri Nov  7 21:55:06 2003
@@ -36,7 +36,7 @@
   KCmdLineLastOption
 };
 
-int main( int argc, char** argv )
+extern "C" int kdemain( int argc, char** argv )
 {
   const char *appName = (argc > 1) ? argv[1] : "koscript";
   KCmdLineArgs::init(argc, argv, appName,
diff -uNr koffice-1.2.94/tools/converter/Makefile.am koffice-1.2.94-patched/tools/converter/Makefile.am
--- koffice-1.2.94/tools/converter/Makefile.am	Wed May 29 03:37:33 2002
+++ koffice-1.2.94-patched/tools/converter/Makefile.am	Fri Nov  7 21:56:10 2003
@@ -1,9 +1,12 @@
 INCLUDES = $(KOFFICE_INCLUDES) $(all_includes)
 
-bin_PROGRAMS = koconverter
-koconverter_SOURCES = koconverter.cc
-koconverter_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-koconverter_LDADD = $(top_builddir)/lib/kofficecore/libkofficecore.la
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+
+kdeinit_LTLIBRARIES = koconverter.la
+koconverter_la_SOURCES = koconverter.cc
+koconverter_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+koconverter_la_LIBADD = $(top_builddir)/lib/kofficecore/libkofficecore.la
 
 METASOURCES = AUTO
 
diff -uNr koffice-1.2.94/tools/converter/koconverter.cc koffice-1.2.94-patched/tools/converter/koconverter.cc
--- koffice-1.2.94/tools/converter/koconverter.cc	Mon Oct 27 08:22:57 2003
+++ koffice-1.2.94-patched/tools/converter/koconverter.cc	Fri Nov  7 21:56:24 2003
@@ -58,7 +58,7 @@
     //kdDebug() << "ProgressObject::slotProgress " << progress << endl;
 }
 
-int main( int argc, char **argv )
+extern "C" int kdemain( int argc, char **argv )
 {
     KAboutData aboutData( "koconverter", I18N_NOOP("KOConverter"), "1.1",
                           I18N_NOOP("KOffice Document Converter"),
diff -uNr koffice-1.2.94/tools/kthesaurus/Makefile.am koffice-1.2.94-patched/tools/kthesaurus/Makefile.am
--- koffice-1.2.94/tools/kthesaurus/Makefile.am	Sat Jun  8 21:22:54 2002
+++ koffice-1.2.94-patched/tools/kthesaurus/Makefile.am	Fri Nov  7 21:57:02 2003
@@ -1,11 +1,13 @@
 
 INCLUDES = $(all_includes)
 
-bin_PROGRAMS = kthesaurus
+bin_PROGRAMS =
+lib_LTLIBRARIES =
+kdeinit_LTLIBRARIES = kthesaurus.la
 
-kthesaurus_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kthesaurus_SOURCES = main.cc
-kthesaurus_LDADD = $(LIB_KSYCOCA)
+kthesaurus_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+kthesaurus_la_SOURCES = main.cc
+kthesaurus_la_LIBADD = $(LIB_KSYCOCA)
  
 appsdir = $(kde_appsdir)/Office
 apps_DATA = KThesaurus.desktop
diff -uNr koffice-1.2.94/tools/kthesaurus/main.cc koffice-1.2.94-patched/tools/kthesaurus/main.cc
--- koffice-1.2.94/tools/kthesaurus/main.cc	Thu Jan 23 04:10:24 2003
+++ koffice-1.2.94-patched/tools/kthesaurus/main.cc	Fri Nov  7 21:57:12 2003
@@ -32,7 +32,7 @@
 	KCmdLineLastOption
 };
 
-int main(int argc, char **argv)
+extern "C" int kdemain(int argc, char **argv)
 {
 
 	KAboutData aboutData("kthesaurus", I18N_NOOP("KThesaurus"), "1.0",
