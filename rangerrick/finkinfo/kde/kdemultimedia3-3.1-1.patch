
--- ./aktion/Makefile.am	2 Oct 2002 23:57:49 -0000	1.1.1.2
+++ ./aktion/Makefile.am	27 Nov 2002 23:17:18 -0000	1.4
@@ -12,16 +12,23 @@
 
 # since the "real" aktion is a library, we start constructing the
 # stuff for it
-lib_LTLIBRARIES = libaktion.la
+lib_LTLIBRARIES = libaktion_main.la aktion.la
 
-libaktion_la_SOURCES = principal.cpp aktionConf.cpp capture.cpp \
+libaktion_main_la_SOURCES = principal.cpp aktionConf.cpp capture.cpp \
 	aktionVm.cpp kxanim.cpp aktion_part.cpp
-libaktion_la_LDFLAGS = $(all_libraries) -version-info 1:0:0 -module -no-undefined
-libaktion_la_LIBADD  = $(LIB_KFILE) $(LIBVM) -lkparts
+libaktion_main_la_LDFLAGS = $(all_libraries) -version-info 1:0:0 -no-undefined
+libaktion_main_la_LIBADD  = $(LIB_KFILE) $(LIBVM) -lkparts
+
+aktion_la_LDFLAGS = $(all_libraries) -avoid-version -module
+aktion_la_SOURCES = aktion_la_main.cpp
+aktion_la_LIBADD  = libaktion_main.la
+
+aktion_la_main.cpp: main.cpp
+	cat main.cpp > aktion_la_main.cpp
 
 aktion_LDFLAGS = $(KDE_RPATH) $(all_libraries)
 aktion_SOURCES = main.cpp
-aktion_LDADD   = libaktion.la
+aktion_LDADD   = libaktion_main.la
 
 # these are the headers for your project
 noinst_HEADERS = principal.h aktionConf.h kxanim.h capture.h aktionVm.h \
@@ -39,13 +46,8 @@
 partdir   = $(kde_datadir)/aktion
 part_DATA = aktion_part.rc
 
-# this is where the desktop file will go 
-lnkdir   = $(kde_appsdir)/Multimedia/More
-lnk_DATA = aktion.desktop
-
-install-data-local: uninstall.desktop
-	$(mkinstalldirs) $(DESTDIR)$(kde_appsdir)/Multimedia
-	$(INSTALL_DATA) $(srcdir)/uninstall.desktop $(DESTDIR)$(kde_appsdir)/Multimedia/aktion.desktop
+desktopdir = $(kde_appsdir)/Multimedia/More
+desktop_DATA = aktion.desktop
 
 rcdir   = $(kde_confdir)
 rc_DATA = aktionrc
--- ./arts/gui/common/Makefile.am	10 Jul 2002 04:58:27 -0000	1.1.1.2
+++ ./arts/gui/common/Makefile.am	29 Nov 2002 18:19:33 -0000	1.3
@@ -1,15 +1,22 @@
-lib_LTLIBRARIES = libartsgui_idl.la libartsgui.la
+lib_LTLIBRARIES = libartsgui_idl.la libartsgui.la libartsgui_shared.la
 
 INCLUDES= -I$(arts_includes) -I$(top_builddir)/arts/runtime $(all_includes)
 
 libartsgui_idl_la_SOURCES = artsgui.cc
 libartsgui_idl_la_LIBADD = -lmcop $(LIBDL)
 libartsgui_idl_la_LDFLAGS = $(all_libraries) -L$(arts_libraries) \
-  -no-undefined -module
+  -no-undefined -avoid-version
 
-libartsgui_la_SOURCES = genericguifactory_impl.cc
-libartsgui_la_LIBADD = libartsgui_idl.la
-libartsgui_la_LDFLAGS = $(all_libraries) -no-undefined -module
+libartsgui_shared_la_SOURCES = genericguifactory_impl.cc
+libartsgui_shared_la_LIBADD = libartsgui_idl.la
+libartsgui_shared_la_LDFLAGS = $(all_libraries) -no-undefined -avoid-version
+
+libartsgui_la_SOURCES = libartsgui_la_dummy.cpp
+libartsgui_la_LIBADD = libartsgui_shared.la
+libartsgui_la_LDFLAGS = $(all_libraries) -no-undefined -avoid-version -module
+
+libartsgui_la_dummy.cpp:
+	echo > libartsgui_la_dummy.cpp
 
 artsgui.cc artsgui.h: $(srcdir)/artsgui.idl $(MCOPIDL)
 	$(MCOPIDL) -t -I$(includedir)/arts $(srcdir)/artsgui.idl
--- ./arts/gui/kde/Makefile.am	10 Jul 2002 04:58:42 -0000	1.1.1.2
+++ ./arts/gui/kde/Makefile.am	29 Nov 2002 18:19:33 -0000	1.3
@@ -1,20 +1,27 @@
 SUBDIRS = mcopclass
 
-lib_LTLIBRARIES = libartsgui_kde.la
+lib_LTLIBRARIES = libartsgui_kde.la libartsgui_kde_shared.la
 
 check_PROGRAMS = artstestgui
 
 INCLUDES= -I$(top_builddir)/arts/runtime -I$(top_builddir)/arts/gui/common -I$(arts_includes) $(all_includes)
 
-libartsgui_kde_la_SOURCES = kwidget_impl.cpp kbutton_impl.cpp \
+libartsgui_kde_shared_la_SOURCES = kwidget_impl.cpp kbutton_impl.cpp \
   kpoti_impl.cpp kpoti.cpp kwidgetrepo.cpp kartswidget.cpp \
   klineedit_impl.cpp khbox_impl.cpp kvbox_impl.cpp kspinbox_impl.cpp \
   kcombobox_impl.cpp kfader.cpp kfader_impl.cpp kgraph_impl.cpp kgraph.cpp \
   kgraphline_impl.cpp
 
-libartsgui_kde_la_LIBADD = $(LIB_KIO) -lkdecore -lkdeui \
+libartsgui_kde_shared_la_LIBADD = $(LIB_KIO) -lkdecore -lkdeui \
   $(top_builddir)/arts/gui/common/libartsgui_idl.la
-libartsgui_kde_la_LDFLAGS = $(all_libraries) -no-undefined -module
+libartsgui_kde_shared_la_LDFLAGS = $(all_libraries) -no-undefined -avoid-version
+
+libartsgui_kde_la_SOURCES = dummy.cpp
+libartsgui_kde_la_LIBADD  = libartsgui_kde_shared.la
+libartsgui_kde_la_LDFLAGS = $(all_libraries) -no-undefined -avoid-version -module
+
+dummy.cpp:
+	echo > dummy.cpp
 
 artstestgui_SOURCES = artstestgui.cpp
 artstestgui_LDADD = -lqtmcop -lkdecore -lartsflow \
--- ./arts/midi/Makefile.am	10 Jul 2002 04:58:50 -0000	1.1.1.2
+++ ./arts/midi/Makefile.am	29 Nov 2002 18:19:33 -0000	1.3
@@ -3,7 +3,7 @@
 SUBDIRS = mcopclass
 INCLUDES= -I$(top_builddir)/arts/runtime -I$(srcdir)/freeverb -I$(arts_includes) $(all_includes)
 
-lib_LTLIBRARIES = libartsmidi_idl.la libartsmidi.la
+lib_LTLIBRARIES = libartsmidi_idl.la libartsmidi.la libartsmidi_shared.la
 
 bin_PROGRAMS = midisend
 noinst_PROGRAMS = midisynctest
@@ -14,22 +14,29 @@
 
 midisynctest_SOURCES = midisynctest.cc
 midisynctest_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-midisynctest_LDADD   = libartsmidi.la -lsoundserver_idl
+midisynctest_LDADD   = libartsmidi_shared.la -lsoundserver_idl
 
 libartsmidi_idl_la_SOURCES = artsmidi.cc
 libartsmidi_idl_la_LIBADD = -lmcop -lartsflow_idl
 libartsmidi_idl_la_LDFLAGS = $(all_libraries) -L$(arts_libraries) \
-  -no-undefined -module
+  -no-undefined -avoid-version
 
-libartsmidi_la_SOURCES = midimanager_impl.cc midiclient_impl.cc \
+libartsmidi_shared_la_SOURCES = midimanager_impl.cc midiclient_impl.cc \
 	miditest_impl.cc midimanagerport_impl.cc rawmidiport_impl.cc \
 	systemmiditimer_impl.cc audiomiditimer_impl.cc miditimercommon.cc \
 	audiosync_impl.cc audiotimer.cc alsamidigateway_impl.cc \
 	alsamidiport_impl.cc midisyncgroup_impl.cc timestampmath.cc
 
-libartsmidi_la_LIBADD = libartsmidi_idl.la -lartsflow $(ARTS_LIBASOUND)
-libartsmidi_la_LDFLAGS = $(all_libraries) -L$(arts_libraries) \
-  -no-undefined -module
+libartsmidi_shared_la_LIBADD = libartsmidi_idl.la -lartsflow $(ARTS_LIBASOUND)
+libartsmidi_shared_la_LDFLAGS = $(all_libraries) -L$(arts_libraries) \
+  -no-undefined -avoid-version
+
+libartsmidi_la_SOURCES = libartsmidi_la_dummy.cpp
+libartsmidi_la_LIBADD  = libartsmidi_shared.la
+libartsmidi_la_LDFLAGS = $(all_libraries) -no-undefined -avoid-version -module
+
+libartsmidi_la_dummy.cpp:
+	echo > libartsmidi_la_dummy.cpp
 
 artsmidi.mcopclass: artsmidi.h
 artsmidi.mcoptype: artsmidi.h
--- ./arts/modules/Makefile.am	2 Oct 2002 23:57:58 -0000	1.1.1.4
+++ ./arts/modules/Makefile.am	29 Nov 2002 18:19:33 -0000	1.8
@@ -3,9 +3,9 @@
 SUBDIRS = mcopclass freeverb
 INCLUDES= -I$(top_builddir)/arts/runtime -I$(top_builddir)/arts/midi -I$(top_srcdir)/arts/midi -I$(top_srcdir)/arts/gui/common -I$(top_builddir)/arts/gui/common -I$(srcdir)/freeverb -I$(arts_includes) $(all_includes)
 
-lib_LTLIBRARIES = libartsmodules.la
+lib_LTLIBRARIES = libartsmodules.la libartsmodules_shared.la
 
-libartsmodules_la_SOURCES = artsmodules.cc synth_wave_tri_impl.cc \
+libartsmodules_shared_la_SOURCES = artsmodules.cc synth_wave_tri_impl.cc \
 	synth_envelope_adsr_impl.cc synth_shelve_cutoff_impl.cc \
 	synth_xfade_impl.cc synth_noise_impl.cc synth_midi_test_impl.cc \
 	c_filter_stuff.c objectcache_impl.cc synth_wave_square_impl.cc \
@@ -31,14 +31,21 @@
 	synth_stereo_compressor_impl.cc stereocompressorguifactory_impl.cc
 
 
-libartsmodules_la_LIBADD = \
+libartsmodules_shared_la_LIBADD = \
    $(top_builddir)/arts/runtime/libartsbuilder.la \
    $(top_builddir)/arts/midi/libartsmidi_idl.la \
    $(top_builddir)/arts/gui/common/libartsgui_idl.la \
    $(top_builddir)/arts/modules/freeverb/libfreeverb.la \
    -lartsflow -lmcop $(LIB_KDECORE) $(LIBDL)
-libartsmodules_la_LDFLAGS = $(all_libraries) -L$(arts_libraries) \
-   -no-undefined -module
+libartsmodules_shared_la_LDFLAGS = $(all_libraries) -L$(arts_libraries) \
+   -no-undefined -avoid-version
+
+libartsmodules_la_SOURCES = libartsmodules_la_dummy.cpp
+libartsmodules_la_LIBADD  = libartsmodules_shared.la
+libartsmodules_la_LDFLAGS = $(all_libraries) -L$(arts_libraries) -no-undefined -avoid-version -module
+
+libartsmodules_la_dummy.cpp:
+	echo > libartsmodules_la_dummy.cpp
 
 artsmodules.mcopclass: artsmodules.h
 artsmodules.mcoptype: artsmodules.h
--- ./arts/modules/synth_midi_test_impl.cc	25 Jun 2002 03:08:46 -0000	1.1.1.1
+++ ./arts/modules/synth_midi_test_impl.cc	18 Aug 2002 06:30:37 -0000	1.3
@@ -50,7 +50,7 @@
 		: param(param)
 	{
 		/* put the string into the any */
-		value.type = "string";
+		value.type.append("string");
 
 		Buffer b;
 		b.writeString(strValue);
--- ./arts/runtime/Makefile.am	14 Aug 2002 18:59:48 -0000	1.1.1.3
+++ ./arts/runtime/Makefile.am	27 Nov 2002 23:17:19 -0000	1.2
@@ -14,7 +14,7 @@
 libartsbuilder_la_LIBADD = -lmcop -lartsflow $(LIBDL)
 libartsbuilder_la_COMPILE_FIRST = artsbuilder.h
 libartsbuilder_la_LDFLAGS = $(all_libraries) -L$(arts_libraries) \
-  -no-undefined -module
+  -no-undefined -avoid-version
 
 artsbuilder.lo: artsbuilder.h
 artsbuilder.mcopclass: artsbuilder.h
--- ./arts/tools/Makefile.am	10 Jul 2002 04:59:35 -0000	1.1.1.2
+++ ./arts/tools/Makefile.am	27 Nov 2002 23:17:19 -0000	1.2
@@ -12,8 +12,8 @@
 
 artscontrol_LDADD	= $(LIB_KDEUI) $(LIB_KSYCOCA) $(LIB_KFILE) \
      -lqtmcop -lartsflow_idl -lsoundserver_idl -lartskde \
-	 $(top_builddir)/arts/gui/kde/libartsgui_kde.la \
-	 $(top_builddir)/arts/modules/libartsmodules.la \
+	 $(top_builddir)/arts/gui/kde/libartsgui_kde_shared.la \
+	 $(top_builddir)/arts/modules/libartsmodules_shared.la \
 	 $(top_builddir)/arts/midi/libartsmidi_idl.la
 
 artscontrol_LDFLAGS	= $(all_libraries) $(KDE_RPATH)
--- ./kaboodle/main.cpp	29 Oct 2002 17:26:43 -0000	1.1.1.3
+++ ./kaboodle/main.cpp	27 Nov 2002 23:17:19 -0000	1.2
@@ -42,7 +42,9 @@
 	{ 0, 0, 0}
 };
 
-int main(int argc, char **argv)
+extern "C" kdemain(int, char**);
+
+int kdemain(int argc, char **argv)
 {
 	KCmdLineArgs::init(argc, argv, Kaboodle::KaboodleFactory::aboutData());
 	KCmdLineArgs::addCmdLineOptions(options);
--- ./kaboodle/Makefile.am	2 Oct 2002 23:58:15 -0000	1.1.1.3
+++ ./kaboodle/Makefile.am	29 Nov 2002 18:19:34 -0000	1.3
@@ -2,39 +2,48 @@
 
 SUBDIRS = pics actions
 
-lib_LTLIBRARIES = kaboodle.la
+lib_LTLIBRARIES = libkaboodlepart_shared.la libkaboodlepart.la libkaboodle_shared.la kaboodle.la
 
-kde_module_LTLIBRARIES = libkaboodlepart.la
-
-libkaboodlepart_la_SOURCES = conf.cpp \
+libkaboodlepart_shared_la_METASOURCES = AUTO
+libkaboodlepart_shared_la_SOURCES = conf.cpp \
 	controls.cpp \
 	engine.cpp \
 	kaboodle_factory.cpp \
 	player.cpp \
 	view.cpp
+libkaboodlepart_shared_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version
+libkaboodlepart_shared_la_LIBADD  = $(LIB_KFILE) $(LIB_KPARTS) -lqtmcop -lkmedia2_idl -lsoundserver_idl -lartskde -lkmediaplayer $(LIB_QT) -lDCOP -lkdecore -lkdeui -lmcop
+
+libkaboodlepart_la_SOURCES = libkaboodlepart_la_dummy.cpp
+libkaboodlepart_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version -module
+libkaboodlepart_la_LIBADD  = libkaboodle_shared.la
 
-libkaboodlepart_la_LDFLAGS = $(all_libraries) -module $(KDE_PLUGIN)
-libkaboodlepart_la_LIBADD = $(LIB_KFILE) $(LIB_KPARTS) -lqtmcop -lkmedia2_idl -lsoundserver_idl -lartskde -lkmediaplayer
+libkaboodlepart_la_dummy.cpp:
+	echo > libkaboodlepart_la_dummy.cpp
 
-kaboodle_la_SOURCES = main.cpp \
+libkaboodle_shared_la_SOURCES = main.cpp \
 	kaboodleapp.cpp \
 	userinterface.cpp
+libkaboodle_shared_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version
+libkaboodle_shared_la_LIBADD  = libkaboodlepart_shared.la
 
-kaboodle_la_LIBADD = libkaboodlepart.la
-kaboodle_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -module -avoid-version
+kaboodle_la_SOURCES = kaboodle_la_main.cpp
+kaboodle_la_LIBADD  = libkaboodle_shared.la
+kaboodle_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version -module
+
+kaboodle_la_main.cpp: stub_main.cpp
+	cat stub_main.cpp > kaboodle_la_main.cpp
 
 bin_PROGRAMS = kaboodle
 
-kaboodle_LDADD = kaboodle.la
+kaboodle_SOURCES = kaboodle_main.cpp
+kaboodle_LDADD   = libkaboodle_shared.la
 kaboodle_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kaboodle_SOURCES = dummy.cpp
-
-libkaboodlepart_la_METASOURCES = AUTO
 
-CLEANFILES = dummy.cpp
+kaboodle_main.cpp: stub_main.cpp
+	cat stub_main.cpp > kaboodle_main.cpp
 
-dummy.cpp:
-	echo > dummy.cpp
+CLEANFILES = kaboodle_main.cpp kaboodle_la_main.cpp libkaboodlepart_la_dummy.cpp
 
 applnk_DATA = kaboodle.desktop
 applnkdir = $(kde_appsdir)/Multimedia
===================================================================
diff -N ./kaboodle/stub_main.cpp
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ ./kaboodle/stub_main.cpp	27 Nov 2002 23:17:19 -0000	1.1
@@ -0,0 +1,28 @@
+/*
+ *
+ * Copyright (c) 2001 Nick Hudson <skrll@netbsd.org>
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
+ * AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN
+ * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
+ * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+extern "C" int kdemain(int, char* []);
+
+int main( int argc, char* argv[] )
+{
+        return kdemain(argc, argv);
+}
+
--- ./kmid/Makefile.am	2 Oct 2002 23:58:22 -0000	1.1.1.4
+++ ./kmid/Makefile.am	27 Nov 2002 23:17:19 -0000	1.2
@@ -1,11 +1,11 @@
 INCLUDES = $(all_includes)
 
-kde_module_LTLIBRARIES = libkmidpart.la
+kde_module_LTLIBRARIES = libkmidpart_shared.la libkmidpart.la kmid.la
 
-libkmidpart_la_LDFLAGS = $(all_libraries) $(KDE_PLUGIN) -module
-libkmidpart_la_LIBADD = $(LIB_KFILE) $(LIB_KPARTS) $(LIB_KIO) -lkmid
+libkmidpart_shared_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version
+libkmidpart_shared_la_LIBADD = $(LIB_KFILE) $(LIB_KPARTS) $(LIB_KIO) -lkmid $(LIB_QT) -lkdecore -lDCOP -lkdeui
 
-libkmidpart_la_SOURCES = kmidframe.cpp kmidclient.cpp kdisptext.cpp \
+libkmidpart_shared_la_SOURCES = kmidframe.cpp kmidclient.cpp kdisptext.cpp \
 	qslidertime.cpp klcdnumber.cpp ktrianglebutton.cpp \
 	midicfgdlg.cpp collectdlg.cpp randomlist.cpp \
 	channelview.cpp channel.cpp channel3d.cpp channel4d.cpp \
@@ -19,9 +19,23 @@
         channelcfgdlg.h instrname.h rhythmview.h \
         songlist.h slman.h kmid_part.h
 
+libkmidpart_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version -module
+libkmidpart_la_SOURCES = libkmidpart_la_dummy.cpp
+libkmidpart_la_LIBADD  = libkmidpart_shared.la
+
+libkmidpart_la_dummy.cpp:
+	echo > libkmidpart_la_dummy.cpp
+
+kmid_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version -module
+kmid_la_SOURCES = kmid_la_main.cpp
+kmid_la_LIBADD  = libkmidpart_shared.la
+
+kmid_la_main.cpp: main.cpp
+	cat main.cpp > kmid_la_main.cpp
+
 kmid_LDFLAGS = $(all_libraries) $(KDE_RPATH)
 kmid_SOURCES = main.cpp
-kmid_LDADD   = libkmidpart.la
+kmid_LDADD   = libkmidpart_shared.la
 
 bin_PROGRAMS = kmid
 METASOURCES = AUTO
--- ./kmidi/Makefile.am	27 Nov 2002 01:30:41 -0000	1.1.1.4
+++ ./kmidi/Makefile.am	27 Nov 2002 23:17:19 -0000	1.2
@@ -13,7 +13,7 @@
 INCLUDES = `$(ARTSCCONFIG) --cflags` $(all_includes)
 AM_CPPFLAGS = -DDEFAULT_PATH=\"$(TIMID_DIR)\" -DKMIDI $(EXTRADEFS) $(CPPFLAGS)
 if GXXOPTIMIZE
-KDE_CXXFLAGS = -O3 -fomit-frame-pointer -ffast-math
+KDE_CXXFLAGS = -fomit-frame-pointer -ffast-math
 endif
 LDFLAGS = $(all_libraries) $(ARTSFLAGS) $(KDE_RPATH)
 #LDADD = $(LIB_KFILE) $(LIBALIB) $(LIBAUDIO) $(LIBMME) $(EXTRALIBS) -lsoundserver_idl -lartsflow
--- ./kmix/Makefile.am	29 Oct 2002 17:27:29 -0000	1.1.1.4
+++ ./kmix/Makefile.am	29 Nov 2002 18:19:34 -0000	1.8
@@ -2,7 +2,7 @@
 INCLUDES= $(all_includes)
 
 bin_PROGRAMS = kmix kmixctrl
-lib_LTLIBRARIES = kmix.la kmixctrl.la
+lib_LTLIBRARIES = libkmix_main.la kmix.la libkmixctrl_main.la kmixctrl.la
 kde_module_LTLIBRARIES = kmix_panelapplet.la
 
 
@@ -12,22 +12,36 @@
 
 
 METASOURCES = AUTO
-kmix_la_SOURCES = main.cpp kmix.cpp kmixdockwidget.cpp kmixprefdlg.cpp \
+libkmix_main_la_SOURCES = kmix.cpp kmixdockwidget.cpp kmixprefdlg.cpp \
 	kmixerwidget.cpp channel.cpp mixer.cpp ksmallslider.cpp \
 	volume.cpp kledbutton.cpp mixdevicewidget.cpp mixerIface.skel
-kmix_la_LIBADD = $(LIB_KDEUI) $(LIBALIB) $(LIBOSSAUDIO) $(LIBASOUND)
-kmix_la_LDFLAGS = $(all_libraries) -module -avoid-version
+libkmix_main_la_LIBADD = $(LIB_KDEUI) $(LIBALIB) $(LIBOSSAUDIO) $(LIBASOUND) $(LIB_QT) -lkdecore -lDCOP
+libkmix_main_la_LDFLAGS = $(all_libraries) -avoid-version
 
-kmix_SOURCES = dummy.cpp
-kmix_LDADD = kmix.la
+kmix_la_SOURCES = main.cpp
+kmix_la_LIBADD  = libkmix_main.la
+kmix_la_LDFLAGS = $(all_libraries) $(KDE_RPATH) -avoid-version -module
+
+kmix_SOURCES = kmix_main.cpp
+kmix_LDADD   = libkmix_main.la
 kmix_LDFLAGS = $(all_libraries) $(KDE_RPATH)
 
-kmixctrl_la_SOURCES = kmixctrl.cpp channel.cpp mixer.cpp volume.cpp mixerIface.skel
-kmixctrl_la_LIBADD = $(LIB_KDEUI) $(LIBALIB) $(LIBOSSAUDIO) $(LIBASOUND)
-kmixctrl_la_LDFLAGS = $(all_libraries) -module -avoid-version
+kmix_main.cpp: main.cpp
+	cat main.cpp > kmix_main.cpp
+
+libkmixctrl_main_la_SOURCES = channel.cpp mixer.cpp volume.cpp mixerIface.skel
+libkmixctrl_main_la_LIBADD  = $(LIB_KDEUI) $(LIBALIB) $(LIBOSSAUDIO) $(LIBASOUND) $(LIB_QT) -lkdecore -lDCOP
+libkmixctrl_main_la_LDFLAGS = $(all_libraries) -avoid-version
+
+kmixctrl_la_SOURCES = kmixctrl_la_main.cpp
+kmixctrl_la_LIBADD  = libkmixctrl_main.la
+kmixctrl_la_LDFLAGS = $(all_libraries) -avoid-version -module
 
-kmixctrl_SOURCES = dummy.cpp
-kmixctrl_LDADD = kmixctrl.la
+kmixctrl_la_main.cpp: kmixctrl.cpp
+	cat kmixctrl.cpp > kmixctrl_la_main.cpp
+
+kmixctrl_SOURCES = kmixctrl.cpp
+kmixctrl_LDADD = libkmixctrl_main.la
 kmixctrl_LDFLAGS = $(all_libraries) $(KDE_RPATH)
 
 kmix_panelapplet_la_SOURCES = kmixapplet.cpp kmixerwidget.cpp channel.cpp \
@@ -57,6 +71,3 @@
 
 messages: rc.cpp
 	$(XGETTEXT) *.cpp -o $(podir)/kmix.pot
-
-dummy.cpp:
-	echo > dummy.cpp
--- ./krec/Makefile.am	2 Oct 2002 23:59:03 -0000	1.1.1.2
+++ ./krec/Makefile.am	29 Nov 2002 18:19:34 -0000	1.6
@@ -5,22 +5,29 @@
 
 METASOURCES = AUTO
 
-lib_LTLIBRARIES = krec.la
-krec_la_SOURCES = \
+lib_LTLIBRARIES = krec.la libkrec_main.la
+
+libkrec_main_la_SOURCES = \
 		krecord.cpp \
 		akbytestreamsender.cpp \
 		recordfile.cpp \
 		session.cpp \
 		startupwindow.cpp \
-		vumeter.cpp \
-		main.cpp
-krec_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -L$(top_builddir)/arts/gui/common -module -avoid-version
-krec_la_LIBADD = $(top_builddir)/arts/modules/libartsmodules.la $(top_builddir)/arts/gui/kde/libartsgui_kde.la -lartskde $(LIBDL) $(LIB_KIO)
+		vumeter.cpp
+libkrec_main_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -L$(top_builddir)/arts/gui/common -avoid-version
+libkrec_main_la_LIBADD = $(top_builddir)/arts/modules/libartsmodules_shared.la $(top_builddir)/arts/gui/kde/libartsgui_kde_shared.la -lartskde $(LIBDL) $(LIB_KIO) -lsoundserver_idl
+
+krec_la_SOURCES = main.cpp
+krec_la_LIBADD  = libkrec_main.la
+krec_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -avoid-version -module
 
 bin_PROGRAMS = krec
-krec_SOURCES = dummy.cpp
+krec_SOURCES = krec_main.cpp
 krec_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-krec_LDADD   = krec.la
+krec_LDADD   = libkrec_main.la
+
+krec_main.cpp: main.cpp
+	cat main.cpp > krec_main.cpp
 
 rcdir = $(kde_datadir)/krec
 rc_DATA = krecui.rc
@@ -35,12 +42,6 @@
 	rm -f tips.cpp
 
 KDE_ICON = krec
-
-dummy.cpp:
-	echo > dummy.cpp
-
-clean-local:
-	rm -f dummy.cpp
 
 datadir=$(kde_datadir)/krec
 data_DATA=tips
--- ./kscd/configure.in.in	29 Oct 2002 17:27:32 -0000	1.1.1.2
+++ ./kscd/configure.in.in	29 Oct 2002 17:38:01 -0000	1.3
@@ -55,6 +55,8 @@
   *-*-*freebsd*) kscd_compile=yes;;
   *-*-*netbsd*) kscd_compile=yes;;
   *-*-*openbsd*) kscd_compile=yes;;
+  *-*-*bsd*) kscd_compile=no;;
+  *-*-*darwin*) kscd_compile=no;;
   *) kscd_compile=yes;;
 esac
 AC_MSG_RESULT($kscd_compile)
--- ./mpg123_artsplugin/configure.in.in	25 Jun 2002 03:08:51 -0000	1.1.1.1
+++ ./mpg123_artsplugin/configure.in.in	29 Nov 2002 18:19:34 -0000	1.4
@@ -18,7 +18,7 @@
 		OPTIMIZED_ARCH="YES"
 		#EXTRA_CPU_CFLAGS=$(if $CC -march=i686 -S -o /dev/null -xc /dev/null > /dev/null; then echo "-march=i686"; fi)
 	;;
-	ppc)
+	ppc|"Power Macintosh")
 		AC_DEFINE(ARCH_PPC, 1, [WE ARE BUILDING FOR A POWERPC])
 		OPTIMIZED_ARCH="YES"
 	;;
@@ -60,6 +60,10 @@
 # ARCH_PPC
 if test "$ARCH_TYPE" = "ppc"; then
 	ARCH_CFLAGS="$ARCH_CFLAGS -mcpu=ppc"
+	MPG123_PLAT_LIB=libmpppc.la
+fi
+if test "$ARCH_TYPE" = "Power Macintosh"; then
+	ARCH_CFLAGS="$ARCH_CFLAGS -mcpu=750 -mtune=750"
 	MPG123_PLAT_LIB=libmpppc.la
 fi
 # ARCH_ULTRA
--- ./mpg123_artsplugin/mpg123/Makefile.am	14 Aug 2002 19:00:52 -0000	1.1.1.3
+++ ./mpg123_artsplugin/mpg123/Makefile.am	29 Nov 2002 18:19:35 -0000	1.2
@@ -27,7 +27,7 @@
 AM_CFLAGS = $(COMMON_CFLAGS) $(ARCH_CFLAGS)
 
 lib_LTLIBRARIES = libmpg123.la
-libmpg123_la_LDFLAGS = -module -avoid-version
+libmpg123_la_LDFLAGS = -avoid-version -Xlinker -undefined -Xlinker suppress -Xlinker -flat_namespace
 libmpg123_la_LIBADD = ./$(MPG123_PLAT_LIB)
 libmpg123_la_DEPENDENCIES = ./$(MPG123_PLAT_LIB)
 
--- ./noatun/Makefile.am	29 Oct 2002 17:27:51 -0000	1.1.1.3
+++ ./noatun/Makefile.am	27 Nov 2002 23:17:20 -0000	1.2
@@ -4,22 +4,25 @@
 
 KDE_ICON = AUTO
 
-kde_module_LTLIBRARIES = noatun.la
-noatun_la_SOURCES = main.cpp joinhandler.cpp joinhandler.skel
-noatun_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -module -avoid-version
-noatun_la_LIBADD = -lqtmcop -lkmedia2_idl -lsoundserver_idl $(top_builddir)/noatun/library/libnoatun.la
+kde_module_LTLIBRARIES = noatun.la libnoatun_main.la
+
+libnoatun_main_la_SOURCES = joinhandler.cpp joinhandler.skel
+libnoatun_main_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -avoid-version
+libnoatun_main_la_LIBADD = -lqtmcop -lkmedia2_idl -lsoundserver_idl $(top_builddir)/noatun/library/libnoatun.la $(LIB_KIO)
+
+noatun_la_SOURCES = main.cpp
+noatun_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -avoid-version -module
+noatun_la_LIBADD  = libnoatun_main.la
 
 bin_PROGRAMS = noatun
-noatun_SOURCES = dummy.cpp
+noatun_SOURCES = noatun_main.cpp
 noatun_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-noatun_LDADD = $(LIB_KIO) noatun.la
+noatun_LDADD = libnoatun_main.la
 
-METASOURCES = AUTO
+noatun_main.cpp: main.cpp
+	cat main.cpp > noatun_main.cpp
 
-CLEANFILES = dummy.cpp
-
-dummy.cpp:
-	echo > dummy.cpp
+METASOURCES = AUTO
 
 applnk_DATA = noatun.desktop
 applnkdir = $(kde_appsdir)/Multimedia
--- ./noatun/library/Makefile.am	2 Oct 2002 23:59:23 -0000	1.1.1.2
+++ ./noatun/library/Makefile.am	29 Nov 2002 18:19:35 -0000	1.6
@@ -23,19 +23,20 @@
 
 include_HEADERS  = cmodule.h plugin_deps.h equalizerview.h effectview.h mimetypetree.h ksaver.h
 
-libnoatun_la_LDFLAGS     = -L$(top_builddir)/noatun/library/noatunarts \
+libnoatun_la_LDFLAGS = -L$(top_builddir)/noatun/library/noatunarts \
 $(KDE_RPATH) $(all_libraries) -L$(top_builddir)/arts/gui/common \
--L$(top_builddir)/arts/gui/kde
+-L$(top_builddir)/arts/gui/kde -avoid-version
 	
-libnoatun_la_LIBADD      = $(top_builddir)/arts/gui/common/libartsgui.la	\
-	$(top_builddir)/arts/gui/kde/libartsgui_kde.la			\
-	$(top_builddir)/arts/modules/libartsmodules.la			\
-	-lkio -lqtmcop -lkmedia2_idl -lnoatunarts			\
-	-lartsflow -lsoundserver_idl -lartskde $(LIBDL) $(LIBPNG)
+libnoatun_la_LIBADD = $(top_builddir)/arts/gui/common/libartsgui_shared.la \
+	$(top_builddir)/arts/gui/kde/libartsgui_kde_shared.la \
+	$(top_builddir)/arts/modules/libartsmodules_shared.la \
+	$(top_builddir)/noatun/library/noatunarts/libnoatunarts_shared.la \
+	-lkio -lqtmcop -lkmedia2_idl -lartsflow -lsoundserver_idl -lartskde \
+	$(LIBDL) $(LIBPNG)
 
 libnoatuncontrols_la_SOURCES = controls.cpp scrollinglabel.cpp
-libnoatuncontrols_la_LDFLAGS = $(KDE_RPATH) $(all_libraries)
-libnoatuncontrols_la_LIBADD  = $(LIBDL)
+libnoatuncontrols_la_LDFLAGS = $(KDE_RPATH) $(all_libraries) -avoid-version
+libnoatuncontrols_la_LIBADD  = $(LIBDL) $(LIB_QT) $(LIB_KDECORE) $(LIB_KDEUI)
 
 METASOURCES = AUTO
 
--- ./noatun/library/noatun/Makefile.am	2 Oct 2002 23:59:24 -0000	1.1.1.2
+++ ./noatun/library/noatun/Makefile.am	29 Nov 2002 18:19:35 -0000	1.2
@@ -2,6 +2,7 @@
 lib_LTLIBRARIES = libdummy.la
 
 libdummy_la_SOURCES = mocs.cpp
+libdummy_la_LDFLAGS = -avoid-version
 
 noatuninclude_HEADERS = \
 	effects.h playlist.h plugin.h  \
--- ./noatun/library/noatunarts/Makefile.am	10 Jul 2002 05:04:20 -0000	1.1.1.2
+++ ./noatun/library/noatunarts/Makefile.am	29 Nov 2002 18:19:35 -0000	1.3
@@ -1,14 +1,22 @@
 INCLUDES= -I$(kde_includes)/arts $(all_includes)
 KDE_OPTIONS = nofinal
 
-lib_LTLIBRARIES = libnoatunarts.la
-libnoatunarts_la_SOURCES = noatunarts.cc fft.c Equalizer_impl.cpp \
+lib_LTLIBRARIES = libnoatunarts.la libnoatunarts_shared.la
+
+libnoatunarts_shared_la_SOURCES = noatunarts.cc fft.c Equalizer_impl.cpp \
                            FFTScopes.cpp StereoEffectStack_impl.cpp \
                            StereoVolumeControl_impl.cpp Session_impl.cpp
 
-libnoatunarts_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
-libnoatunarts_la_LIBADD =  -lkmedia2_idl -lsoundserver_idl -lartsflow
-libnoatunarts_la_METASOURCES = AUTO
+libnoatunarts_shared_la_LDFLAGS = $(all_libraries) -avoid-version -no-undefined
+libnoatunarts_shared_la_LIBADD =  -lkmedia2_idl -lsoundserver_idl -lartsflow
+libnoatunarts_shared_la_METASOURCES = AUTO
+
+libnoatunarts_la_SOURCES = libnoatunarts_dummy.cpp
+libnoatunarts_la_LIBADD  = libnoatunarts_shared.la
+libnoatunarts_la_LDFLAGS = $(all_libraries) -avoid-version -no-undefined -module
+
+libnoatunarts_dummy.cpp:
+	echo > libnoatunarts_dummy.cpp
 
 noatunarts.mcoptype: noatunarts.h
 noatunarts.mcopclass: noatunarts.h
--- ./noatun/library/noatuntags/Makefile.am	25 Jun 2002 03:08:51 -0000	1.1.1.1
+++ ./noatun/library/noatuntags/Makefile.am	29 Nov 2002 18:19:35 -0000	1.2
@@ -3,7 +3,7 @@
 lib_LTLIBRARIES = libnoatuntags.la
 
 libnoatuntags_la_SOURCES = tags.cpp
-libnoatuntags_la_LDFLAGS = -L$(top_builddir)/noatun/library
+libnoatuntags_la_LDFLAGS = -L$(top_builddir)/noatun/library -avoid-version
 libnoatuntags_la_LIBADD = $(top_builddir)/noatun/library/libnoatun.la
 
 libnoatuntags_la_METASOURCES = AUTO
--- ./noatun/modules/kjofol-skin/Makefile.am	10 Jul 2002 05:04:48 -0000	1.1.1.2
+++ ./noatun/modules/kjofol-skin/Makefile.am	29 Nov 2002 18:19:36 -0000	1.2
@@ -16,7 +16,7 @@
 noatun_kjofol_la_LDFLAGS = $(all_libraries) -module -avoid-version -no-undefined
 noatun_kjofol_la_LIBADD = $(LIB_KFILE) $(top_builddir)/noatun/library/libnoatun.la \
                         $(LIB_KIO) -lm \
-                        $(top_builddir)/arts/modules/libartsmodules.la
+                        $(top_builddir)/arts/modules/libartsmodules_shared.la
 
 noatun_kjofol_la_METASOURCES = AUTO
 
--- ./noatun/modules/winskin/Makefile.am	29 Oct 2002 17:28:37 -0000	1.1.1.3
+++ ./noatun/modules/winskin/Makefile.am	27 Nov 2002 23:17:20 -0000	1.2
@@ -40,7 +40,7 @@
 					-module -avoid-version -no-undefined 
 
 noatun_winskin_la_LIBADD		= $(top_builddir)/noatun/library/libnoatun.la \
-					$(top_builddir)/noatun/modules/winskin/vis/libwinskinvis.la
+					$(top_builddir)/noatun/modules/winskin/vis/libwinskinvis_shared.la
 
 noatun_winskin_la_METASOURCES	=	AUTO
 
--- ./noatun/modules/winskin/vis/Makefile.am	3 Oct 2002 00:00:13 -0000	1.1.1.3
+++ ./noatun/modules/winskin/vis/Makefile.am	29 Nov 2002 18:19:36 -0000	1.3
@@ -6,20 +6,22 @@
 winskinvis.cc winskinvis.h :	$(srcdir)/winskinvis.idl
 	$(MCOPIDL) -t -I$(kde_includes)/arts $(srcdir)/winskinvis.idl
 
-lib_LTLIBRARIES		=	libwinskinvis.la
-libwinskinvis_la_SOURCES=	winskinvis.cc \
-				winSkinFFT_impl.cpp realFFT.cpp \
-				realFFTFilter.cpp visQueue.cpp
+lib_LTLIBRARIES = libwinskinvis.la libwinskinvis_shared.la
 
+libwinskinvis_shared_la_SOURCES = winskinvis.cc \
+	winSkinFFT_impl.cpp realFFT.cpp \
+	realFFTFilter.cpp visQueue.cpp
+libwinskinvis_shared_la_LDFLAGS = $(all_libraries) -avoid-version -no-undefined
+libwinskinvis_shared_la_LIBADD  = -lkmedia2_idl -lsoundserver_idl -lartsflow
+libwinskinvis_shared_la_COMPILE_FIRST = winskinvis.cc
+libwinskinvis_shared_la_METASOURCES   = AUTO
 
-libwinskinvis_la_LDFLAGS=	$(all_libraries) -module -avoid-version \
-				-no-undefined
-
-libwinskinvis_la_LIBADD =	-lkmedia2_idl -lsoundserver_idl -lartsflow
-libwinskinvis_la_COMPILE_FIRST = winskinvis.cc
-libwinskinvis_la_METASOURCES =	AUTO
-
+libwinskinvis_la_SOURCES = dummy.cpp
+libwinskinvis_la_LDFLAGS = $(all_libraries) -avoid-version -no-undefined -module
+libwinskinvis_la_LIBADD  = libwinskinvis_shared.la
 
+dummy.cpp:
+	echo > dummy.cpp
 
 mcoptypedir		=	$(libdir)/mcop
 mcoptype_DATA		=	winskinvis.mcoptype winskinvis.mcopclass
--- ./oggvorbis_artsplugin/oggPlayObject_impl.h	29 Oct 2002 17:28:43 -0000	1.1.1.2
+++ ./oggvorbis_artsplugin/oggPlayObject_impl.h	29 Oct 2002 17:38:01 -0000	1.3
@@ -1,7 +1,7 @@
 #ifndef OGGPLAYER_IMPL_H
 #define OGGPLAYER_IMPL_H "$Id$"
 
-#if defined(__GNU_LIBRARY__) && !defined(_SEM_SEMUN_UNDEFINED)
+#if (defined(__GNU_LIBRARY__) || (defined __APPLE__)) && !defined(_SEM_SEMUN_UNDEFINED)
 /* union semun is defined by including <sys/sem.h> */
 #else
 /* according to X/OPEN we have to define it ourselves */
--- ./xine_artsplugin/Makefile.am	29 Oct 2002 17:28:43 -0000	1.1.1.3
+++ ./xine_artsplugin/Makefile.am	27 Nov 2002 23:17:21 -0000	1.6
@@ -8,9 +8,9 @@
 			  xinePlayObject_impl.cpp \
 			  audio_fifo_out.c \
 			  video_fifo_out.c
-libarts_xine_la_LDFLAGS = $(all_libraries) -module -avoid-version -pthread
+libarts_xine_la_LDFLAGS = $(all_libraries) -module -avoid-version
 libarts_xine_la_LIBADD = $(XINE_LIBS) $(LIB_X11) $(LIB_XEXT) \
-			 -lkmedia2_idl -lsoundserver_idl -lartsflow
+			 -lkmedia2_idl -lsoundserver_idl -lartsflow -lmcop -lartsflow_idl
 
 libarts_xine_la_METASOURCES = AUTO
 
