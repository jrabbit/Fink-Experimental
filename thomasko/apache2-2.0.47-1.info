Package: apache2
Version: 2.0.47
Revision: 1
###
Conflicts: apache, apr
Replaces: apache
BuildDepends: db4, expat, gdbm3, dlcompat-dev, libiconv-dev
Depends: daemonic, db4-shlibs, expat-shlibs, gdbm3-shlibs
###
CustomMirror: <<
  Primary: http://www.apache.org/dist/httpd/
  Secondary: http://www.apache.org/dist/httpd/old/
<<
###
Source: mirror:custom:httpd-%v.tar.gz
Source-MD5: 63f16638c18b140b649fab32b54d7f9c
###
Patch: %f.patch
PatchScript: <<
  rm -rf srclib/apr-util/xml/expat
<<
###
GCC: 3.1
###
ConfFiles: <<
  %p/etc/apache2/httpd.conf
  %p/etc/apache2/magic
  %p/etc/apache2/mime.types
<<
###
CompileScript: <<
  ./configure --prefix=%p/share/apache2 --exec-prefix=%p/share/apache2 --bindir=%p/bin --sbindir=%p/sbin --libexecdir=%p/share/apache2 --datadir=%p/share/apache2 --sysconfdir=%p/etc/apache2 --sharedstatedir=%p/share/apache2 --libdir=%p/lib/apache2 --includedir=%p/include/apache2 --oldincludedir=%p/include/apache2 --mandir=%p/share/man --infodir=%p/share/info --enable-modules=all --enable-mods-shared=all --enable-modules=extension --enable-so --with-expat=%p --with-mpm=prefork --enable-rewrite --enable-dav-fs --enable-cgi --enable-suexec --enable-info --enable-dav --enable-usertrack --enable-headers --enable-expires --enable-mime-magic --enable-logio --enable-deflate
  make EXTRA_CFLAGS="-O2"
<<
#  --with-ssl=%p --enable-http --enable-ssl --enable-mem-cache --enable-disk-cache --enable-cache --enable-isapi --enable-auth-digest --enable-auth-dbm
InstallScript: <<
  make install DESTDIR=%d

  install -d -m 755 %d%p/etc/apache2/include
  printf "\nInclude %p/etc/apache2/include/\n" >> %d%p/etc/apache2/httpd.conf
<<
###
DaemonicName: apache2
DaemonicFile: <<
 <service>
  <description>Apache2 web server</description>
  <message>Apache2 web server</message>

  <daemon name="httpd">
    <executable background="yes">%p/sbin/apachectl</executable>
    <parameters> -k start</parameters>
  </daemon>
 </service>
<<
###
Description: Powerful HTTP Web Server
DescDetail: <<
  Apache is a powerful web source which is highly flexable. It has support
  for modules, and is used on many large web sites throughout the net. It
  used httpd.conf for all of it's configuration options, which are well
  documented.
<<
DescUsage: <<
  The htdocs, and cgi-bin folders are installed in share/apache2 folder.
  You can configure the server to suit your needs by editing the 
  etc/apache2/httpd.conf file. It doesn't effect the built in apache
  webserver which is included with Mac OS X, but it will conflict if one, or 
  the other is running at the same time.  Base and Extension modules
  are the only ones that are built, and should be fine for most setups.  The
  apachectl command included with this package will be used instead of the
  one that it included with OSX. If you should need to use the OSX one, type
  /usr/sbin/apachectl, and use it like you normally would.
<<
DescPackaging: <<
  Apache2's prefix chooses the location of serveral directories that can't
  be change with other configure options. Using the CompileScript option,
  I overwrote Fink's defaults of ./configure --prefix option, and set the 
  correct prefix manually.

  Moved 'make' to the CompileScript so that apache2-config gives the proper
  values.  Also updated the pkg to add a custom mirror to avoid breakage when
  they move he tarballs and updated to current release.  Also fixed the
  daemonic script. Also added DSO building.  Addes a PatchScript to remove
  the internal expat in favor of fink's expat as there is no switch or way
  to disable it.  - Justin F. Hallett (Feb 7, 2003)

  Many to the original package maintainer:
  Sonic McTails <sonicmctails@projectnemesis.ibforums.com>
<<
DocFiles: ABOUT_APACHE CHANGES INSTALL LAYOUT LICENSE README* VERSIONING
License: BSD
Homepage: http://www.apache.org
Maintainer: Thomas Kotzian <thomas.kotzian@gmx.at>
SplitOff: <<
  Package: %N-shlibs
  Depends: daemonic, db3-shlibs | db4-shlibs, expat-shlibs, gdbm-shlibs | gdbm3-shlibs
  Files: lib
  Shlibs: << 
    %p/lib/apache2/libapr-0.0.9.4.dylib 0.9.4 %n (>= 2.0.47-1)
    %p/lib/apache2/libaprutil-0.0.9.4.dylib 0.9.4 %n (>= 2.0.47-1)
  <<
  DocFiles: ABOUT_APACHE CHANGES INSTALL LAYOUT LICENSE README* VERSIONING
  Description: Powerful HTTP Web Server - shared libraries
<<
SplitOff2: <<
  Package: %N-dev
  Depends: %N-shlibs (= %v-%r)
  BuildDependsOnly: true
  Files: include sbin/apxs
  DocFiles: ABOUT_APACHE CHANGES INSTALL LAYOUT LICENSE README* VERSIONING
  Description: Powerful HTTP Web Server - development libraries and headers
<<
SplitOff3: <<
  Package: %N-doc
  Files: share/apache2/manual
  DocFiles: ABOUT_APACHE CHANGES INSTALL LAYOUT LICENSE README* VERSIONING
  Description: Powerful HTTP Web Server - complete manual
<<