diff -uNr Python-2.3.4/Lib/distutils/util.py Python-2.3.4-new/Lib/distutils/util.py
--- Python-2.3.4/Lib/distutils/util.py	2003-01-06 08:28:12.000000000 -0500
+++ Python-2.3.4-new/Lib/distutils/util.py	2004-11-09 09:50:56.000000000 -0500
@@ -39,6 +39,12 @@
     # Try to distinguish various flavours of Unix
 
     (osname, host, release, version, machine) = os.uname()
+ 
+    # On MacOS X, remove space from machine name
+ 
+    if machine == "Power Macintosh":
+    	machine = "PowerMacintosh"
+
 
     # Convert the OS name to lowercase, remove '/' characters
     # (to accommodate BSD/OS), and translate spaces (for "Power Macintosh")
diff -uNr Python-2.3.4/Lib/idlelib/EditorWindow.py Python-2.3.4-new/Lib/idlelib/EditorWindow.py
--- Python-2.3.4/Lib/idlelib/EditorWindow.py	2003-09-22 10:56:11.000000000 -0400
+++ Python-2.3.4-new/Lib/idlelib/EditorWindow.py	2004-11-09 09:50:57.000000000 -0500
@@ -60,7 +60,7 @@
                     basepath = '/usr/share/doc/'  # standard location
                     dochome = os.path.join(basepath, pyver,
                                            'Doc', 'index.html')
-            elif sys.platform.count('win') or sys.platform.count('nt'):
+            elif sys.platform.count('nt'):
                 # Try the HTMLHelp file
                 chmpath = os.path.join(sys.prefix, 'Doc',
                                        'Python%d%d.chm' % sys.version_info[:2])
@@ -311,20 +311,11 @@
         textView.TextViewer(self.top,'Help',fn)
 
     def python_docs(self, event=None):
-        if sys.platform.count('win') or sys.platform.count('nt'):
-            os.startfile(self.help_url)
-            return "break"
-        else:
-            webbrowser.open(self.help_url)
-            return "break"
+        webbrowser.open(self.help_url)
+        return "break"
 
     def display_docs(self, url):
-        if not (url.startswith('www') or url.startswith('http')):
-            url = os.path.normpath(url)
-        if sys.platform.count('win') or sys.platform.count('nt'):
-            os.startfile(url)
-        else:
-            webbrowser.open(url)
+        webbrowser.open(url)
 
     def cut(self,event):
         self.text.event_generate("<<Cut>>")
diff -uNr Python-2.3.4/Lib/idlelib/configHelpSourceEdit.py Python-2.3.4-new/Lib/idlelib/configHelpSourceEdit.py
--- Python-2.3.4/Lib/idlelib/configHelpSourceEdit.py	2003-01-26 21:36:18.000000000 -0500
+++ Python-2.3.4-new/Lib/idlelib/configHelpSourceEdit.py	2004-11-09 09:50:57.000000000 -0500
@@ -1,6 +1,7 @@
 "Dialog to specify or edit the parameters for a user configured help source."
 
 import os
+import sys
 
 from Tkinter import *
 import tkMessageBox
@@ -84,7 +85,7 @@
             dir, base = os.path.split(path)
         else:
             base = None
-            if sys.platform.count('win') or sys.platform.count('nt'):
+            if sys.platform.count('nt'):
                 dir = os.path.join(os.path.dirname(sys.executable), 'Doc')
                 if not os.path.isdir(dir):
                     dir = os.getcwd()
@@ -128,6 +129,15 @@
             pathOk = False
         elif path.startswith('www.') or path.startswith('http'):
             pathOk = True
+        elif path.startswith('file:'):
+            if os.path.exists( path[5:]):
+                pathOk = True
+            else:
+                tkMessageBox.showerror(title='File Path Error',
+                                   message='Help file path does not exist.',
+                                   parent=self)
+                self.entryPath.focus_set()
+                pathOk = False
         elif not os.path.exists(path):
             tkMessageBox.showerror(title='File Path Error',
                                    message='Help file path does not exist.',
@@ -140,6 +150,12 @@
         if self.MenuOk() and self.PathOk():
             self.result = (self.menu.get().strip(),
                            self.path.get().strip())
+            if sys.platform == 'darwin' and not (
+	                self.result[1].startswith('www') 
+	    		or self.result[1].startswith('file')
+                        or self.result[1].startswith('http')):
+		# Mac Safari insists on using the URI form for local files.
+                self.result = (self.result[0], "file://" + self.result[1])
             self.destroy()
 
     def Cancel(self, event=None):
diff -uNr Python-2.3.4/Makefile.pre.in Python-2.3.4-new/Makefile.pre.in
--- Python-2.3.4/Makefile.pre.in	2003-11-18 14:54:00.000000000 -0500
+++ Python-2.3.4-new/Makefile.pre.in	2004-11-09 09:50:56.000000000 -0500
@@ -56,7 +56,7 @@
 OPT=		@OPT@
 BASECFLAGS=	@BASECFLAGS@
 CFLAGS=		$(BASECFLAGS) $(OPT)
-CPPFLAGS=	-I. -I$(srcdir)/Include
+CPPFLAGS=	-I. -I$(srcdir)/Include -I@PREFIX@/include
 LDFLAGS=	@LDFLAGS@
 LDLAST=		@LDLAST@
 SGI_ABI=	@SGI_ABI@
diff -uNr Python-2.3.4/Misc/setuid-prog.c Python-2.3.4-new/Misc/setuid-prog.c
--- Python-2.3.4/Misc/setuid-prog.c	1998-09-10 16:18:09.000000000 -0400
+++ Python-2.3.4-new/Misc/setuid-prog.c	2004-11-09 09:50:56.000000000 -0500
@@ -70,6 +70,12 @@
 #define environ _environ
 #endif
 
+#if defined(__APPLE__)
+# include <sys/time.h>
+# include <crt_externs.h>
+# define environ (*_NSGetEnviron())
+#endif /* __APPLE__ */
+
 /* don't change def_IFS */
 char def_IFS[] = "IFS= \t\n";
 /* you may want to change def_PATH, but you should really change it in */
Binary files Python-2.3.4/Modules/.nismodule.c.swp and Python-2.3.4-new/Modules/.nismodule.c.swp differ
diff -uNr Python-2.3.4/Modules/posixmodule.c Python-2.3.4-new/Modules/posixmodule.c
--- Python-2.3.4/Modules/posixmodule.c	2004-05-04 04:07:49.000000000 -0400
+++ Python-2.3.4-new/Modules/posixmodule.c	2004-11-09 09:50:56.000000000 -0500
@@ -304,7 +304,7 @@
 #endif
 
 /* Return a dictionary corresponding to the POSIX environment table */
-#ifdef WITH_NEXT_FRAMEWORK
+#ifdef __APPLE__
 /* On Darwin/MacOSX a shared library or framework has no access to
 ** environ directly, we must obtain it with _NSGetEnviron().
 */
@@ -322,7 +322,7 @@
 	d = PyDict_New();
 	if (d == NULL)
 		return NULL;
-#ifdef WITH_NEXT_FRAMEWORK
+#ifdef __APPLE__
 	if (environ == NULL)
 		environ = *_NSGetEnviron();
 #endif
diff -uNr Python-2.3.4/configure Python-2.3.4-new/configure
--- Python-2.3.4/configure	2004-05-07 15:13:40.000000000 -0400
+++ Python-2.3.4-new/configure	2004-11-09 09:52:57.000000000 -0500
@@ -1457,7 +1457,8 @@
   # it craps out if _XOPEN_EXTENDED_SOURCE is defined. Apparently,
   # this is fixed in 10.3, which identifies itself as Darwin/7.*
   # This should hopefully be fixed in FreeBSD 4.9
-  FreeBSD/4.8* | Darwin/6* )
+  # Darwin/8.* does freaky things if the POSIX_C stuff exists
+  FreeBSD/4.8* | Darwin/6* | Darwin/* )
     define_xopen_source=no;;
   # On AIX 4, mbstate_t is defined only when _XOPEN_SOURCE == 500 but used in
   # wcsnrtombs() and mbsnrtowcs() even if _XOPEN_SOURCE is not defined or
@@ -4021,7 +4022,7 @@
 	    ;;
 	# is there any other compiler on Darwin besides gcc?
 	Darwin*)
-	    BASECFLAGS="$BASECFLAGS -Wno-long-double -no-cpp-precomp -mno-fused-madd"
+	    BASECFLAGS="$BASECFLAGS -fno-common -Wno-long-double -no-cpp-precomp -mno-fused-madd"
 	    ;;
     esac
     ;;
@@ -10082,7 +10083,7 @@
 			LDSHARED="$LDSHARED "'-framework $(PYTHONFRAMEWORK)'
 		else
 			# No framework. Ignore undefined symbols, assuming they come from Python
-			LDSHARED="$LDSHARED -undefined suppress"
+			LDSHARED="$LDSHARED -flat_namespace -undefined suppress"
 		fi ;;
 	Darwin/*)
 		LDSHARED='$(CC) $(LDFLAGS) -bundle'
@@ -10091,8 +10092,8 @@
 			LDSHARED="$LDSHARED "'-framework $(PYTHONFRAMEWORK)'
 		else
 			# No framework, use the Python app as bundle-loader
-			BLDSHARED="$LDSHARED "'-bundle_loader $(BUILDPYTHON)'
-			LDSHARED="$LDSHARED "'-bundle_loader $(BINDIR)/python$(VERSION)$(EXE)'
+			BLDSHARED="$LDSHARED -flat_namespace -undefined suppress"
+			LDSHARED="$LDSHARED -flat_namespace -undefined suppress"
 		fi ;;
 	Linux*|GNU*) LDSHARED='$(CC) -shared';;
 	dgux*) LDSHARED="ld -G";;
diff -uNr Python-2.3.4/setup.py Python-2.3.4-new/setup.py
--- Python-2.3.4/setup.py	2003-10-21 16:01:21.000000000 -0400
+++ Python-2.3.4-new/setup.py	2004-11-09 09:50:57.000000000 -0500
@@ -244,11 +244,11 @@
         add_dir_to_list(self.compiler.library_dirs, '/usr/local/lib')
         add_dir_to_list(self.compiler.include_dirs, '/usr/local/include')
 
-        # fink installs lots of goodies in /sw/... - make sure we
+        # fink installs lots of goodies in @PREFIX@/... - make sure we
         # check there
         if sys.platform == "darwin":
-            add_dir_to_list(self.compiler.library_dirs, '/sw/lib')
-            add_dir_to_list(self.compiler.include_dirs, '/sw/include')
+            add_dir_to_list(self.compiler.library_dirs, '@PREFIX@/lib')
+            add_dir_to_list(self.compiler.include_dirs, '@PREFIX@/include')
 
         if os.path.normpath(sys.prefix) != '/usr':
             add_dir_to_list(self.compiler.library_dirs,
@@ -449,7 +449,7 @@
                                      ['/usr/local/ssl/lib',
                                       '/usr/contrib/ssl/lib/'
                                      ] )
-
+        ssl_incs = None
         if (ssl_incs is not None and
             ssl_libs is not None):
             exts.append( Extension('_ssl', ['_ssl.c'],
@@ -486,7 +486,7 @@
                                 '/usr/local/BerkeleyDB.4.0/lib',
                                 '/usr/local/lib',
                                 '/opt/sfw',
-                                '/sw/lib',
+                                '@PREFIX@/lib',
                                 ),
                     'incdirs': ('/usr/local/BerkeleyDB.4.2/include',
                                 '/usr/local/include/db42',
@@ -495,7 +495,7 @@
                                 '/usr/local/BerkeleyDB.4.0/include',
                                 '/usr/local/include/db4',
                                 '/opt/sfw/include/db4',
-                                '/sw/include/db4',
+                                '@PREFIX@/include/db4',
                                 '/usr/include/db4',
                                 )},
             'db3': {'libs': ('db-3.3', 'db-3.2', 'db-3.1', 'db3',),
@@ -504,14 +504,14 @@
                                 '/usr/local/BerkeleyDB.3.1/lib',
                                 '/usr/local/lib',
                                 '/opt/sfw/lib',
-                                '/sw/lib',
+                                '@PREFIX@/lib',
                                 ),
                     'incdirs': ('/usr/local/BerkeleyDB.3.3/include',
                                 '/usr/local/BerkeleyDB.3.2/include',
                                 '/usr/local/BerkeleyDB.3.1/include',
                                 '/usr/local/include/db3',
                                 '/opt/sfw/include/db3',
-                                '/sw/include/db3',
+                                '@PREFIX@/include/db3',
                                 '/usr/include/db3',
                                 )},
             }
@@ -942,9 +942,9 @@
         # AquaTk is a separate method. Only one Tkinter will be built on
         # Darwin - either AquaTk, if it is found, or X11 based Tk.
         platform = self.get_platform()
-        if platform == 'darwin' and \
-           self.detect_tkinter_darwin(inc_dirs, lib_dirs):
-            return
+#       if platform == 'darwin' and \
+#          self.detect_tkinter_darwin(inc_dirs, lib_dirs):
+#           return
 
         # Assume we haven't found any of the libraries or include files
         # The versions with dots are used on Unix, and the versions without
