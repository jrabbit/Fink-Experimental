Package: ghostscript-esp
Version: 7.07.1
Revision: 18
Description: Enhanced GNU Ghostscript with better CJK and printer support
Source: mirror:sourceforge:espgs/espgs-%v-source.tar.bz2
Source2: mirror:ctan:support/ghostscript/3rdparty/jpegsrc.v6b.tar.gz
Source3: ftp://ftp.gyve.org/pub/gs-cjk/adobe-cmaps-200406.tar.gz
Source4: ftp://ftp.t.ring.gr.jp/pub/text/TeX/ptex-win32/gs/acro5-cmaps-2001.zip
Source5: http://tagoh.jp/junk/ghostscript-7.07-bigposttable.patch
Source6: http://tagoh.jp/junk/ghostscript-7.07-gsublookuptable.patch
Source7: http://tagoh.jp/junk/ghostscript-7.07-coverage-glyphcount.patch
Source8: http://www.aihara.co.jp/~taiji/gyve/tmp/fix_rename_font_gs_cidfn.ps.patch
Source9: http://www.aihara.co.jp/~taiji/gyve/tmp/fix_cidfontname_Encoding_CIDToGIDMap_DW_W.patch
Source10: http://www.aihara.co.jp/~taiji/gyve/tmp/modify_ps2pdfwr.patch
Source11: http://www.aihara.co.jp/~taiji/gyve/tmp/ghostscript-7.07-bigcmaptable.patch
Source12: http://www.aihara.co.jp/~taiji/gyve/tmp/ghostscript-7.07-noglyph-gid0.patch
Source13: http://www.aihara.co.jp/~taiji/gyve/tmp/fix_cidfonttype2_Adobe-CNS1-4.patch
Source14: http://www.aihara.co.jp/~taiji/gyve/tmp/ghostscript-7.07-seekCFFtable.patch
Source15: http://www.aihara.co.jp/~taiji/gyve/tmp/ghostscript-7.07-readFDSelect.patch
Source16: http://www.aihara.co.jp/~taiji/gyve/tmp/ghostscript-7.07-write_GSubrs.patch
Source17: http://www.aihara.co.jp/~taiji/gyve/tmp/ghostscript-7.07-nosyoffsetcheck.patch
Source18: http://www.aihara.co.jp/~taiji/gyve/tmp/fix_cidfonttype2_Adobe-Japan1-6.patch
Source19: http://www.aihara.co.jp/~taiji/gyve/tmp/modify_ps2pdfwr-20050921.patch
Source-MD5:  d30bf5c09f2c7caa8291f6305cf03044
Source2-MD5: dbd5f3b47ed13132f04c685d608a7547
Source3-MD5: dfc93dd2aaaf2b86d2fd55f654c13261
Source4-MD5: 5fd9d1a0c61692551b01b8f153c313a4
Source5-MD5: f834d056ca972c457a2ff3b1e839e562
Source6-MD5: b37c0dc9f85205da6e8675d4a8bfd21a
Source7-MD5: 55146a1eafc4ad3a26d99121ae0777fe
Source8-MD5: e0da7576378dc87fa53a16dfd1774789
Source9-MD5: c73ad916d49df447de59358ffdc495eb
Source10-MD5: a72863d1612c99333c7ab10b20ec2dff
Source11-MD5: 4d4984b9af90cb30306e019d544282d9
Source12-MD5: 9eae4b050f80f3c361650a1e509745c3
Source13-MD5: 34841bf4efbf795864730d851a491032
Source14-MD5: 1be0971f5cd18a7f899d7d149f25377c
Source15-MD5: 54b7d24542d669715cd509f1658363eb
Source16-MD5: c074d77cfe65307cdba9a0c503eabaa0
Source17-MD5: bb72072d807ad0358b2850dead480c98
Source18-MD5: 8bac43d7cdd1c503557b3209469c06d5
Source19-MD5: 27903349daf2046d4e244d3d6f81bfaf
SourceDirectory: espgs-%v
Source3ExtractDir: Resource
Source4ExtractDir: Resource
Depends: x11, ghostscript-fonts, libpng3-shlibs (>= 1.2.5-3), gettext, applesystemfonts, appleotffonts
BuildDepends: x11-dev, libpng3 (>= 1.2.5-3), gimp-print-dev | gimp-print7-dev, cups-dev, gettext-dev
Conflicts: ghostscript, ghostscript-nox, ghostscript6, ghostscript6-nox, ghostscript7, system-ghostscript, system-ghostscript8, system-ghostscript6
Replaces: ghostscript, ghostscript-nox, ghostscript6, ghostscript6-nox, ghostscript7
Provides: ghostscript
License: Restrictive/Distributable
PatchScript: <<
 mv ../jpeg-6b jpeg

 # apply tagoh-san's patch series, required for NeverEmbed
 patch -p1 < ../ghostscript-7.07-bigposttable.patch
 patch -p1 < ../ghostscript-7.07-gsublookuptable.patch
 patch -p1 < ../ghostscript-7.07-coverage-glyphcount.patch

 # to handle NeverEmbed CJK TrueType into PDF
 patch -p0 < ../fix_rename_font_gs_cidfn.ps.patch

 # to write correct glyph widths of CJK TrueType into PDF, and not to write
 # CIDToGIDMap of NeverEmbed CJK TrueType and Encoding of CIDFont into PDF
 patch -p0 < ../fix_cidfontname_Encoding_CIDToGIDMap_DW_W.patch

 # modify ps2pdfwr to use NeverEmbed
 (cd lib && patch -p0 < ../../modify_ps2pdfwr.patch)

 # to handle TrueType fonts which have a big cmap table
 patch -p0 < ../ghostscript-7.07-bigcmaptable.patch

 # to avoid putting illegal not-defined glyph on mapping table for CIDs 
 patch -p0 < ../ghostscript-7.07-noglyph-gid0.patch

 # to increase CIDCount of Adobe-CNS1
 patch -p0 < ../fix_cidfonttype2_Adobe-CNS1-4.patch

 # to fix seeking CFF table
 patch -p0 < ../ghostscript-7.07-seekCFFtable.patch

 # to fix the operand stack overflow at readFDSelect
 patch -p0 < ../ghostscript-7.07-readFDSelect.patch

 # to fix the problem of creating PDF with OpenType fonts
 patch -p0 < ../ghostscript-7.07-write_GSubrs.patch

 # to avoid return_error caused by incomplete offset check at creating PDF with OpenType fonts
 patch -p0 < ../ghostscript-7.07-nosyoffsetcheck.patch

 # recommended with adobe-cmaps-200406
 patch -p0 < ../fix_cidfonttype2_Adobe-Japan1-6.patch

 # add NeverEmbedCIDFontList and AlwaysEmbedCIDFontList
 (cd lib && sed 's|\(Sazanami-.*\)-Regular|\1|g' \
	< ../../modify_ps2pdfwr-20050921.patch | patch -p0)

 sed 's|<PREFIX>|%p|g' < %a/%n.patch | patch -p1
<<
NoSetMAKEFLAGS: true
SetMAKEFLAGS: -j1
SetCFLAGS: -I%p/include
ConfigureParams: --mandir='${prefix}/share/man' --with-x --with-gimp-print --with-cups --without-omni
CompileScript: <<
 ./configure %c
 make CFLAGS_STANDARD="-O2 -I%p/include" XLDFLAGS="-L%p/lib -lintl"
<<
InstallScript: <<
 make install_prefix=%i prefix=%i datadir=%i/share infodir=%i/share/info mandir=%i/share/man sysconfdir=%i/etc install
 install -m 755 -d %i/share/ghostscript
 cp -R ../Resource %i/share/ghostscript/
 install -m 755 -d %i/share/ghostscript/Resource/Font
 install -m 755 -d %i/share/ghostscript/Resource/CIDFont
<<
PostInstScript: <<
# if [ `which cups-config` ]
# then
# CUPSSERVER=`cups-config --serverbin`
# CUPSCONFIG=`cups-config --serverroot`
# CUPSDATA=`cups-config --datadir`
#
#   mkdir -p ${CUPSSERVER}/filter
#   for file in %p/lib/cups/filter/*
#   do
#     ln -s ${file} ${CUPSSERVER}/filter
#   done
#
#   mkdir -p ${CUPSCONFIG}
#   for file in %p/etc/cups/*
#   do
#     ln -s ${file} ${CUPSCONFIG} 
#   done
#
#   mkdir -p ${CUPSDATA}/model
#   for file in %p/share/cups/model/*
#   do
#     ln -s ${file} ${CUPSDATA}/model
#   done
#
# fi
<<
PreRmScript: <<
# if [ `which cups-config` ]
# then
# CUPSSERVER=`cups-config --serverbin`
# CUPSCONFIG=`cups-config --serverroot`
# CUPSDATA=`cups-config --datadir`
#
#   for file in %p/lib/cups/filter/*
#   do
#     rm -f ${CUPSSERVER}/filter/`basename ${file}`
#   done
#
#   for file in %p/etc/cups/*
#   do
#     rm -f ${CUPSCONFIG}/`basename ${file}` 
#   done
#
#   for file in %p/share/cups/model/*
#   do
#     rm -f ${CUPSDATA}/model/`basename ${file}`
#   done
#
# fi
<<
DescUsage: <<
 ESP Ghostscript now supports for applesystemfonts and appleotffonts.
 In the case of previewing Japanese documents, however, very long time
 may be taken until the letters appear. This is because we use OTF fonts
 (Hiragino) as Japanese fonts by default.

 If you don't like that, use TTF fonts instead of OTF fonts.
 For example, install sazanami:
  $ fink install sazanami
 Then modify CIDFnmap and CIDFnmap.CJK in %p/share/ghostscript/7.07/lib/.
<<
DescPackaging: <<
 Patches to CIDFnmap, CIDFnmap.CJK, CIDFnmap.OSX and
 patches from Web are based on Mr. Yamada's Web page:
 http://www.aihara.co.jp/~taiji/gyve/

 A patch to ps2ps is based on Gentoo Linux's gs7.07.1-ps2ps.patch.
 A patch to gs.1 is based on Gentoo Linux's ghostscript-7.05.6.man.patch.
 A patch to gs_res.ps.in is based on Gentoo Linux's gs7.07.1-cjk.diff.
 A patch to CIDFnmap.Saz is also based on Gentoo Linux's gs7.07.1-cjk.diff.
 A patch to gdevpx.c is based on Gentoo Linux's gs7.05.6-gdevpx.patch.
 Patches to gxalloc.h, gxobj.h and ialloc.c are based on Gentoo Linux's
 gs-fix-gc.patch.

 A patch to unixinst.mak adds CIDFnmap.Saz and CIDFnmap.OSX to install list.
 A patch to configure.ac handles problems of encryption library.
 A patch to cups.mak changes install location of files related to cups.
<<
Maintainer: Todai Fink Team <fink@sodan.ecc.u-tokyo.ac.jp>
Homepage: http://www.cups.org/ghostscript.php
