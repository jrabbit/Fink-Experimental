--- espgs-7.07.1/lib/ps2epsi.org	2003-11-15 18:45:26.123092511 +0100
+++ espgs-7.07.1/lib/ps2epsi	2003-11-15 18:45:43.224353499 +0100
@@ -1,7 +1,7 @@
 #!/bin/sh
 # $Id$
 
-tmpfile=/tmp/ps2epsi$$
+tmpfile=$(tempfile --prefix=ps2ep)
 rm -f $tmpfile
 if test -e $tmpfile; then
 	echo "$0: Our temporary file $tmpfile already exists." 1>&2
--- espgs-7.05.5/man/gs.1	2002-04-23 07:58:37.000000000 -0400
+++ espgs-7.05.5/man/gs.1.new	2003-01-18 14:22:46.000000000 -0500
@@ -257,7 +257,7 @@
 the directories specified by the \fBGS_LIB_DEFAULT\fR macro in the
 Ghostscript makefile when the executable was built.  When \fBgs\fR is built
 on Unix, \fBGS_LIB_DEFAULT\fR is usually
-"/usr/local/share/ghostscript/#.##:/usr/local/share/ghostscript/fonts"
+"<PREFIX>/share/ghostscript/#.##:<PREFIX>/share/ghostscript/fonts"
 where "#.##" represents the Ghostscript version number.
 .PP
 Each of these (\fBGS_LIB_DEFAULT\fR, \fBGS_LIB\fR, and \fB\-I\fR parameter)
@@ -432,16 +432,16 @@
 location of Ghostscript documentation on your system, from which you can
 get more details.
 .TP
-.B /usr/local/share/ghostscript/#.##/*
+.B <PREFIX>/share/ghostscript/#.##/*
 Startup files, utilities, and basic font definitions
 .TP
-.B /usr/local/share/ghostscript/fonts/*
+.B <PREFIX>/share/ghostscript/#.##/fonts/*
 More font definitions
 .TP
-.B /usr/local/share/ghostscript/#.##/examples/*
+.B <PREFIX>/share/ghostscript-#.##/examples/*
 Ghostscript demonstration files
 .TP
-.B /usr/local/share/ghostscript/#.##/doc/*
+.B <PREFIX>/share/doc/ghostscript-#.##/html/*
 Diverse document files
 .SH ENVIRONMENT
 .TP

diff -Naur espgs-7.05.6.orig/lib/CIDFnmap espgs-7.05.6/lib/CIDFnmap
--- espgs-7.05.6.orig/lib/CIDFnmap	2002-04-23 20:58:33.000000000 +0900
+++ espgs-7.05.6/lib/CIDFnmap	2003-01-09 03:09:00.000000000 +0900
@@ -135,14 +135,15 @@
 % in particular, you must leave at least one space or tab between each
 % field in the entry.  
 
-%(CIDFnmap.Ore) .runlibfile
-%(CIDFnmap.ARP) .runlibfile
-%(CIDFnmap.Bae) .runlibfile
-%(CIDFnmap.Koc) .runlibfile
+(CIDFnmap.Ore) .runlibfile
+(CIDFnmap.ARP) .runlibfile
+(CIDFnmap.Bae) .runlibfile
+(CIDFnmap.Koc) .runlibfile
+(CIDFnmap.Saz) .runlibfile
 %(CIDFnmap.Sol) .runlibfile
 %(CIDFnmap.Win) .runlibfile
 
-%(CIDFnmap.CJK) .runlibfile
+(CIDFnmap.CJK) .runlibfile
 
 % native CIDFontName (BIG5) in traditional Chinese
 %(CIDFnmap.b5) .runlibfile

diff -Naur espgs-7.05.6.orig/lib/CIDFnmap.ARP espgs-7.05.6/lib/CIDFnmap.ARP
--- espgs-7.05.6.orig/lib/CIDFnmap.ARP	2002-04-23 20:58:33.000000000 +0900
+++ espgs-7.05.6/lib/CIDFnmap.ARP	2003-01-09 02:26:43.000000000 +0900
@@ -25,10 +25,10 @@
 
 % Adobe-CNS1
 
-/ZenKai-Medium		(bkai00mp.ttf)		;
-/ShanHeiSun-Light	(bsmi00lp.ttf)		;
+/ZenKai-Medium		(/usr/share/fonts/ttf/zh_TW/bkai00mp.ttf)	;
+/ShanHeiSun-Light	(/usr/share/fonts/ttf/zh_TW/bsmi00lp.ttf)	;
 
 % Adobe-GB1
 
-/BousungEG-Light-GB	(gbsn00lp.ttf)		;
-/GBZenKai-Medium	(gkai00mp.ttf)		;
+/BousungEG-Light-GB	(/usr/share/fonts/ttf/zh_CN/gbsn00lp.ttf)	;
+/GBZenKai-Medium	(/usr/share/fonts/ttf/zh_CN/gkai00mp.ttf)	;

diff -Naur espgs-7.05.6.orig/lib/CIDFnmap.Bae espgs-7.05.6/lib/CIDFnmap.Bae
--- espgs-7.05.6.orig/lib/CIDFnmap.Bae	2002-04-23 20:58:33.000000000 +0900
+++ espgs-7.05.6/lib/CIDFnmap.Bae	2003-01-09 02:29:32.000000000 +0900
@@ -25,7 +25,7 @@
 
 % Adobe-Korea1
 
-/Baekmuk-Batang		(batang.ttf)		;
-/Baekmuk-Dotum		(dotum.ttf)		;
-/Baekmuk-Gulim		(gulim.ttf)		;
-/Baekmuk-Headline	(hline.ttf)		;
+/Baekmuk-Batang		(/usr/share/fonts/ttf/korean/baekmuk/batang.ttf);
+/Baekmuk-Dotum		(/usr/share/fonts/ttf/korean/baekmuk/dotum.ttf)	;
+/Baekmuk-Gulim		(/usr/share/fonts/ttf/korean/baekmuk/gulim.ttf)	;
+/Baekmuk-Headline	(/usr/share/fonts/ttf/korean/baekmuk/hline.ttf)	;

diff -Naur espgs-7.05.6.orig/lib/CIDFnmap.CJK espgs-7.05.6/lib/CIDFnmap.CJK
--- espgs-7.07.1/lib/CIDFnmap.CJK	Tue Apr 23 20:58:33 2002
+++ espgs-7.07.1-patched/lib/CIDFnmap.CJK	Tue Mar 22 14:31:46 2005
@@ -24,51 +24,52 @@
 % Fallback aliases for CJK PDF files
 %
 %/Adobe-CNS1		/MOESung-Regular	; % CIDFnmap.Ore
-%/Adobe-CNS1		/ShanHeiSun-Light	; % CIDFnmap.ARP
+/Adobe-CNS1		/ShanHeiSun-Light	; % CIDFnmap.ARP
 %/Adobe-CNS1		/ming			; % CIDFnmap.Sol
 %/Adobe-CNS1		/MingLiU		; % CIDFnmap.Win
 %/Adobe-CNS1		/SimSun-18030-Adobe-CNS1	; % CIDFnmap.Win
 
-%/Adobe-GB1		/BousungEG-Light-GB	; % CIDFnmap.ARP
+/Adobe-GB1		/BousungEG-Light-GB	; % CIDFnmap.ARP
 %/Adobe-GB1		/zycjksun		; % CIDFnmap.Sol
 %/Adobe-GB1		/SimSun			; % CIDFnmap.Win
 
 %/Adobe-Japan1		/WadaMin-Regular	; % CIDFnmap.Ore
 %/Adobe-Japan1		/HG-MinchoL		; % CIDFnmap.Sol
 %/Adobe-Japan1		/Kochi-Mincho		; % CIDFnmap.Koc
+/Adobe-Japan1		/Sazanami-Mincho	; % CIDFnmap.Saz
 %/Adobe-Japan1		/MS-Mincho		; % CIDFnmap.Win
 
-%/Adobe-Japan2		/WadaMin-RegularH	; % CIDFnmap.Ore
+/Adobe-Japan2		/WadaMin-RegularH	; % CIDFnmap.Ore
 %/Adobe-Japan2		/HeiseiMin-W3H		; % CIDFnmap.Sol
 %/Adobe-Japan2		/MS-Mincho-Adobe-Japan2		; % CIDFnmap.Win
 
 %/Adobe-Korea1		/Munhwa-Regular		; % CIDFnmap.Ore
-%/Adobe-Korea1		/Baekmuk-Batang		; % CIDFnmap.Bae
+/Adobe-Korea1		/Baekmuk-Batang		; % CIDFnmap.Bae
 %/Adobe-Korea1		/Myeongjo		; % CIDFnmap.Sol
 %/Adobe-Korea1		/Batang			; % CIDFnmap.Win
 
 %
 % Convenient aliases for PS files on Traditional Chinese PostScript printer
 %
-%/MSung-Light		/MOESung-Regular	; % CIDFnmap.Ore
+/MSung-Light		/MOESung-Regular	; % CIDFnmap.Ore
 %/MSung-Light		/SimSun-18030-Adobe-CNS1	; % CIDFnmap.Win
-%/MSung-Medium		/ShanHeiSun-Light	; % CIDFnmap.ARP
-%/MHei-Medium		/ShanHeiSun-Light	; % CIDFnmap.ARP
+/MSung-Medium		/ShanHeiSun-Light	; % CIDFnmap.ARP
+/MHei-Medium		/ShanHeiSun-Light	; % CIDFnmap.ARP
 %/MHei-Medium		/hei			; % CIDFnmap.Sol
-%/MKai-Medium		/ZenKai-Medium		; % CIDFnmap.ARP
+/MKai-Medium		/ZenKai-Medium		; % CIDFnmap.ARP
 %/MKai-Medium		/kai			; % CIDFnmap.Sol
 
 %
 % Convenient aliases for PS files on Simplified Chinese PostScript printer
 %
-%/STSong-Light		/BousungEG-Light-GB	; % CIDFnmap.ARP
+/STSong-Light		/BousungEG-Light-GB	; % CIDFnmap.ARP
 %/STSong-Light		/zycjksun		; % CIDFnmap.Sol
 %/STSong-Light		/SimSun			; % CIDFnmap.Win
 %/STFangsong-Light	/zycjkfangs		; % CIDFnmap.Sol
 %/STFangsong-Light	/SimSun			; % CIDFnmap.Win
 %/STHeiti-Regular	/zycjkhei		; % CIDFnmap.Sol
 %/STHeiti-Regular	/SimHei			; % CIDFnmap.Win
-%/STKaiti-Regular	/GBZenKai-Medium	; % CIDFnmap.ARP
+/STKaiti-Regular	/GBZenKai-Medium	; % CIDFnmap.ARP
 %/STKaiti-Regular	/zycjkkai		; % CIDFnmap.Sol
 
 %
@@ -77,17 +78,19 @@
 %/Ryumin-Light		/WadaMin-Regular	; % CIDFnmap.Ore
 %/Ryumin-Light		/HG-MinchoL		; % CIDFnmap.Sol
 %/Ryumin-Light		/Kochi-Mincho		; % CIDFnmap.Koc
+/Ryumin-Light		/Sazanami-Mincho	; % CIDFnmap.Saz
 %/Ryumin-Light		/MS-Mincho		; % CIDFnmap.Win
 %/GothicBBB-Medium	/WadaGo-Bold		; % CIDFnmap.Ore
 %/GothicBBB-Medium	/HG-GothicB		; % CIDFnmap.Sol
 %/GothicBBB-Medium	/Kochi-Gothic		; % CIDFnmap.Koc
+/GothicBBB-Medium	/Sazanami-Gothic	; % CIDFnmap.Saz
 %/GothicBBB-Medium	/MS-Gothic		; % CIDFnmap.Win
 %/HeiseiMin-W3		/MS-Mincho		; % CIDFnmap.Win
 %/HeiseiKakuGo-W5	/MS-Gothic		; % CIDFnmap.Win
 
-%/HeiseiMin-W3H		/WadaMin-RegularH	; % CIDFnmap.Ore
+/HeiseiMin-W3H		/WadaMin-RegularH	; % CIDFnmap.Ore
 %/HeiseiMin-W3H		/MS-Mincho-Adobe-Japan2	; % CIDFnmap.Win
-%/HeiseiKakuGo-W5H	/WadaMaruGo-RegularH	; % CIDFnmap.Ore
+/HeiseiKakuGo-W5H	/WadaMaruGo-RegularH	; % CIDFnmap.Ore
 %/HeiseiKakuGo-W5H	/MS-Gothic-Adobe-Japan2	; % CIDFnmap.Win
 
 %/KozMin-Regular	/MS-Mincho		; % CIDFnmap.Win
@@ -97,193 +100,193 @@
 % Convenient aliases for PS files on Korean PostScript printer
 %
 %/HYGoThic-Medium	/MunhwaGothic-Regular	; % CIDFnmap.Ore
-%/HYGoThic-Medium	/Baekmuk-Dotum		; % CIDFnmap.Bae
+/HYGoThic-Medium	/Baekmuk-Dotum		; % CIDFnmap.Bae
 %/HYGoThic-Medium	/Gothic			; % CIDFnmap.Sol
 %/HYGoThic-Medium	/Dotum			; % CIDFnmap.Win
 %/HYGungSo-Bold		/Gungsuh		; % CIDFnmap.Win
-%/HYKHeadLine-Bold	/Baekmuk-Headline	; % CIDFnmap.Bae
-%/HYKHeadLine-Medium	/Baekmuk-Headline	; % CIDFnmap.Bae
+/HYKHeadLine-Bold	/Baekmuk-Headline	; % CIDFnmap.Bae
+/HYKHeadLine-Medium	/Baekmuk-Headline	; % CIDFnmap.Bae
 %/HYSMyeongJo-Medium	/Munhwa-Regular		; % CIDFnmap.Ore
-%/HYSMyeongJo-Medium	/Baekmuk-Batang		; % CIDFnmap.Bae
+/HYSMyeongJo-Medium	/Baekmuk-Batang		; % CIDFnmap.Bae
 %/HYSMyeongJo-Medium	/Myeongjo		; % CIDFnmap.Sol
 %/HYSMyeongJo-Medium	/Batang			; % CIDFnmap.Win
-%/HYRGoThic-Medium	/Baekmuk-Gulim		; % CIDFnmap.Bae
+/HYRGoThic-Medium	/Baekmuk-Gulim		; % CIDFnmap.Bae
 %/HYRGoThic-Medium	/RoundedGothic		; % CIDFnmap.Sol
 %/HYRGoThic-Medium	/Gulim			; % CIDFnmap.Win
 
 %
 % Convenient aliases for PS files on Traditional Chinese Acrobat Distiller
 %
-%/DFKaiShu-SB-Estd-BF	/MKai-Medium		;
-%/LiGothicMed		/MKai-Medium		;
-%/LiSungLight		/MSung-Light		;
-%/Taipei		/Adobe-CNS1		;
+/DFKaiShu-SB-Estd-BF	/MKai-Medium		;
+/LiGothicMed		/MKai-Medium		;
+/LiSungLight		/MSung-Light		;
+/Taipei			/Adobe-CNS1		;
 
 %
 % Convenient aliases for PS files on Simplified Chinese Acrobat Distiller
 %
-%/Beijing		/Adobe-GB1		;
-%/SIL-FangSong-		/STFangsong-Light	;
-%/SIL-FangSong-Reg-Jian	/STFangsong-Light	;
-%/SIL-Hei-Med-Jian	/STHeiti-Regular	;
-%/SIL-Kai-		/STKaiti-Regular	;
-%/SIL-Kai-Reg-Jian	/STKaiti-Regular	;
-%/SIL-Song-Reg-Jian	/STSong-Light		;
+/Beijing		/Adobe-GB1		;
+/SIL-FangSong-		/STFangsong-Light	;
+/SIL-FangSong-Reg-Jian	/STFangsong-Light	;
+/SIL-Hei-Med-Jian	/STHeiti-Regular	;
+/SIL-Kai-		/STKaiti-Regular	;
+/SIL-Kai-Reg-Jian	/STKaiti-Regular	;
+/SIL-Song-Reg-Jian	/STSong-Light		;
 
 %
 % Convenient aliases for PS files on Japanese Acrobat Distiller
 %
-%/ChuGothicBBB-Medium	/GothicBBB-Medium	;
+/ChuGothicBBB-Medium	/GothicBBB-Medium	;
 %/ChuGothicBBB-Medium-Mono	/MS-Gothic	; % CIDFnmap.Win
-%/FutoGoB101-Bold	/GothicBBB-Medium	;
-%/FutoMinA101-Bold	/Ryumin-Light		;
-%/GothicMB101-Bold	/GothicBBB-Medium	;
-%/GothicMB101-hea	/GothicBBB-Medium	;
-%/GothicMB101-Ult	/GothicBBB-Medium	;
-%/HeiseiKakuGo-W3	/HeiseiKakuGo-W5	;
-%/HeiseiKakuGo-W7	/HeiseiKakuGo-W5	;
-%/HeiseiKakuGo-W9	/HeiseiKakuGo-W5	;
-%/HeiseiKakuGothic-W5	/HeiseiKakuGo-W5	;
-%/HeiseiMaruGo-W4	/HeiseiKakuGo-W5	;
-%/HeiseiMin-W5		/HeiseiMin-W3		;
-%/HeiseiMin-W7		/HeiseiMin-W3		;
-%/HeiseiMin-W9		/HeiseiMin-W3		;
-%/HeiseiMincho-W3	/HeiseiMin-W3		;
-%/HonMincho-M		/Ryumin-Light		;
-%/Jun34-Medium		/Ryumin-Light		;
-%/Jun101-Light		/Ryumin-Light		;
-%/Jun501-Bold		/Ryumin-Light		;
-%/KozMin-Bold		/GothicBBB-Medium	;
-%/KozMin-ExtraLight	/Ryumin-Light		;
-%/KozMin-Heavy		/GothicBBB-Medium	;
-%/KozMin-Light		/Ryumin-Light		;
-%/KozMin-Medium		/Ryumin-Light		;
-%/KyokaICA-Light	/Adobe-Japan1		;
-%/KyokaICA-Medium	/Adobe-Japan1		;
-%/KyokaICA-regular	/Adobe-Japan1		;
-%/LogoArl-Bold		/Adobe-Japan1		;
-%/LogoArl-Light		/Adobe-Japan1		;
-%/LogoArl-Medium	/Adobe-Japan1		;
-%/LogoArl-Ultra		/Adobe-Japan1		;
-%/LogoCut-Bold		/Adobe-Japan1		;
-%/LogoCut-Light		/Adobe-Japan1		;
-%/LogoCut-Medium	/Adobe-Japan1		;
-%/LogoCut-Ultra		/Adobe-Japan1		;
-%/LogoLine-Bold		/Adobe-Japan1		;
-%/LogoLine-Light	/Adobe-Japan1		;
-%/LogoLine-Medium	/Adobe-Japan1		;
-%/LogoLine-Ultra	/Adobe-Japan1		;
-%/MaruGothic-M		/GothicBBB-Medium	;
-%/MidashiGo-MB31	/GothicBBB-Medium	;
-%/MidashiMin-MA31	/Ryumin-Light		;
-%/Osaka			/Ryumin-Light		;
+/FutoGoB101-Bold	/GothicBBB-Medium	;
+/FutoMinA101-Bold	/Ryumin-Light		;
+/GothicMB101-Bold	/GothicBBB-Medium	;
+/GothicMB101-hea	/GothicBBB-Medium	;
+/GothicMB101-Ult	/GothicBBB-Medium	;
+/HeiseiKakuGo-W3	/HeiseiKakuGo-W5	;
+/HeiseiKakuGo-W7	/HeiseiKakuGo-W5	;
+/HeiseiKakuGo-W9	/HeiseiKakuGo-W5	;
+/HeiseiKakuGothic-W5	/HeiseiKakuGo-W5	;
+/HeiseiMaruGo-W4	/HeiseiKakuGo-W5	;
+/HeiseiMin-W5		/HeiseiMin-W3		;
+/HeiseiMin-W7		/HeiseiMin-W3		;
+/HeiseiMin-W9		/HeiseiMin-W3		;
+/HeiseiMincho-W3	/HeiseiMin-W3		;
+/HonMincho-M		/Ryumin-Light		;
+/Jun34-Medium		/Ryumin-Light		;
+/Jun101-Light		/Ryumin-Light		;
+/Jun501-Bold		/Ryumin-Light		;
+/KozMin-Bold		/GothicBBB-Medium	;
+/KozMin-ExtraLight	/Ryumin-Light		;
+/KozMin-Heavy		/GothicBBB-Medium	;
+/KozMin-Light		/Ryumin-Light		;
+/KozMin-Medium		/Ryumin-Light		;
+/KyokaICA-Light		/Adobe-Japan1		;
+/KyokaICA-Medium	/Adobe-Japan1		;
+/KyokaICA-regular	/Adobe-Japan1		;
+/LogoArl-Bold		/Adobe-Japan1		;
+/LogoArl-Light		/Adobe-Japan1		;
+/LogoArl-Medium		/Adobe-Japan1		;
+/LogoArl-Ultra		/Adobe-Japan1		;
+/LogoCut-Bold		/Adobe-Japan1		;
+/LogoCut-Light		/Adobe-Japan1		;
+/LogoCut-Medium		/Adobe-Japan1		;
+/LogoCut-Ultra		/Adobe-Japan1		;
+/LogoLine-Bold		/Adobe-Japan1		;
+/LogoLine-Light		/Adobe-Japan1		;
+/LogoLine-Medium	/Adobe-Japan1		;
+/LogoLine-Ultra		/Adobe-Japan1		;
+/MaruGothic-M		/GothicBBB-Medium	;
+/MidashiGo-MB31		/GothicBBB-Medium	;
+/MidashiMin-MA31	/Ryumin-Light		;
+/Osaka			/Ryumin-Light		;
 %/Osaka-Mono		/MS-Mincho		; % CIDFnmap.Win
-%/Ryumin-Bold		/Ryumin-Light		;
-%/Ryumin-heavy		/Ryumin-Light		;
-%/Ryumin-Light-KL	/Ryumin-Light		;
+/Ryumin-Bold		/Ryumin-Light		;
+/Ryumin-heavy		/Ryumin-Light		;
+/Ryumin-Light-KL	/Ryumin-Light		;
 %/Ryumin-Light-KL-Mono	/MS-Mincho		; % CIDFnmap.Win
-%/Ryumin-Medium		/Ryumin-Light		;
-%/Ryumin-regular	/Ryumin-Light		;
-%/Ryumin-Ultra		/Ryumin-Light		;
-%/ShinGo-Bold		/GothicBBB-Medium	;
-%/ShinGo-Light		/GothicBBB-Medium	;
-%/ShinGo-Medium		/GothicBBB-Medium	;
-%/ShinGo-regular	/GothicBBB-Medium	;
-%/ShinGo-Ultra		/GothicBBB-Medium	;
-%/ShinseiKai-CBSK1	/Ryumin-Light		;
-%/TBKomachiG-B		/Adobe-Japan1		;
-%/TBKomachiG-DB		/Adobe-Japan1		;
-%/TBKomachiG-E		/Adobe-Japan1		;
-%/TBKomachiG-hv		/Adobe-Japan1		;
-%/TBKomachiG-M		/Adobe-Japan1		;
-%/TBKomachiG-R		/Adobe-Japan1		;
-%/TBKomachiM-DE		/Adobe-Japan1		;
-%/TBKomachiM-E		/Adobe-Japan1		;
-%/TBKomachiM-hv		/Adobe-Japan1		;
-%/TBKomachiM-M		/Adobe-Japan1		;
-%/TBKoudoukenG-B	/Adobe-Japan1		;
-%/TBKoudoukenG-DB	/Adobe-Japan1		;
-%/TBKoudoukenG-E	/Adobe-Japan1		;
-%/TBKoudoukenG-hv	/Adobe-Japan1		;
-%/TBKoudoukenG-M	/Adobe-Japan1		;
-%/TBKoudoukenG-R	/Adobe-Japan1		;
-%/TBKoudoukenM-DE	/Adobe-Japan1		;
-%/TBKoudoukenM-E	/Adobe-Japan1		;
-%/TBKoudoukenM-hv	/Adobe-Japan1		;
-%/TBKoudoukenM-M	/Adobe-Japan1		;
-%/TBRyokanG-B		/Adobe-Japan1		;
-%/TBRyokanG-DB		/Adobe-Japan1		;
-%/TBRyokanG-E		/Adobe-Japan1		;
-%/TBRyokanG-hv		/Adobe-Japan1		;
-%/TBRyokanG-M		/Adobe-Japan1		;
-%/TBRyokanG-R		/Adobe-Japan1		;
-%/TBRyokanM-DE		/Adobe-Japan1		;
-%/TBRyokanM-E		/Adobe-Japan1		;
-%/TBRyokanM-hv		/Adobe-Japan1		;
-%/TBRyokanM-M		/Adobe-Japan1		;
-%/TBTsukijiG-B		/Adobe-Japan1		;
-%/TBTsukijiG-DB		/Adobe-Japan1		;
-%/TBTsukijiG-E		/Adobe-Japan1		;
-%/TBTsukijiG-hv		/Adobe-Japan1		;
-%/TBTsukijiG-M		/Adobe-Japan1		;
-%/TBTsukijiG-R		/Adobe-Japan1		;
-%/TBTsukijiM-DE		/Adobe-Japan1		;
-%/TBTsukijiM-E		/Adobe-Japan1		;
-%/TBTsukijiM-hv		/Adobe-Japan1		;
-%/TBTsukijiM-M		/Adobe-Japan1		;
-%/TBYukinariG-B		/Adobe-Japan1		;
-%/TBYukinariG-DB	/Adobe-Japan1		;
-%/TBYukinariG-E		/Adobe-Japan1		;
-%/TBYukinariG-hv	/Adobe-Japan1		;
-%/TBYukinariG-M		/Adobe-Japan1		;
-%/TBYukinariG-R		/Adobe-Japan1		;
-%/TBYukinariM-DE	/Adobe-Japan1		;
-%/TBYukinariM-E		/Adobe-Japan1		;
-%/TBYukinariM-hv	/Adobe-Japan1		;
-%/TBYukinariM-M		/Adobe-Japan1		;
-%/TypeBankG-B		/Adobe-Japan1		;
-%/TypeBankG-DB		/Adobe-Japan1		;
-%/TypeBankG-E		/Adobe-Japan1		;
-%/TypeBankG-hv		/Adobe-Japan1		;
-%/TypeBankG-M		/Adobe-Japan1		;
-%/TypeBankG-R		/Adobe-Japan1		;
-%/TypeBankM-DE		/Adobe-Japan1		;
-%/TypeBankM-E		/Adobe-Japan1		;
-%/TypeBankM-hv		/Adobe-Japan1		;
-%/TypeBankM-M		/Adobe-Japan1		;
+/Ryumin-Medium		/Ryumin-Light		;
+/Ryumin-regular		/Ryumin-Light		;
+/Ryumin-Ultra		/Ryumin-Light		;
+/ShinGo-Bold		/GothicBBB-Medium	;
+/ShinGo-Light		/GothicBBB-Medium	;
+/ShinGo-Medium		/GothicBBB-Medium	;
+/ShinGo-regular		/GothicBBB-Medium	;
+/ShinGo-Ultra		/GothicBBB-Medium	;
+/ShinseiKai-CBSK1	/Ryumin-Light		;
+/TBKomachiG-B		/Adobe-Japan1		;
+/TBKomachiG-DB		/Adobe-Japan1		;
+/TBKomachiG-E		/Adobe-Japan1		;
+/TBKomachiG-hv		/Adobe-Japan1		;
+/TBKomachiG-M		/Adobe-Japan1		;
+/TBKomachiG-R		/Adobe-Japan1		;
+/TBKomachiM-DE		/Adobe-Japan1		;
+/TBKomachiM-E		/Adobe-Japan1		;
+/TBKomachiM-hv		/Adobe-Japan1		;
+/TBKomachiM-M		/Adobe-Japan1		;
+/TBKoudoukenG-B		/Adobe-Japan1		;
+/TBKoudoukenG-DB	/Adobe-Japan1		;
+/TBKoudoukenG-E		/Adobe-Japan1		;
+/TBKoudoukenG-hv	/Adobe-Japan1		;
+/TBKoudoukenG-M		/Adobe-Japan1		;
+/TBKoudoukenG-R		/Adobe-Japan1		;
+/TBKoudoukenM-DE	/Adobe-Japan1		;
+/TBKoudoukenM-E		/Adobe-Japan1		;
+/TBKoudoukenM-hv	/Adobe-Japan1		;
+/TBKoudoukenM-M		/Adobe-Japan1		;
+/TBRyokanG-B		/Adobe-Japan1		;
+/TBRyokanG-DB		/Adobe-Japan1		;
+/TBRyokanG-E		/Adobe-Japan1		;
+/TBRyokanG-hv		/Adobe-Japan1		;
+/TBRyokanG-M		/Adobe-Japan1		;
+/TBRyokanG-R		/Adobe-Japan1		;
+/TBRyokanM-DE		/Adobe-Japan1		;
+/TBRyokanM-E		/Adobe-Japan1		;
+/TBRyokanM-hv		/Adobe-Japan1		;
+/TBRyokanM-M		/Adobe-Japan1		;
+/TBTsukijiG-B		/Adobe-Japan1		;
+/TBTsukijiG-DB		/Adobe-Japan1		;
+/TBTsukijiG-E		/Adobe-Japan1		;
+/TBTsukijiG-hv		/Adobe-Japan1		;
+/TBTsukijiG-M		/Adobe-Japan1		;
+/TBTsukijiG-R		/Adobe-Japan1		;
+/TBTsukijiM-DE		/Adobe-Japan1		;
+/TBTsukijiM-E		/Adobe-Japan1		;
+/TBTsukijiM-hv		/Adobe-Japan1		;
+/TBTsukijiM-M		/Adobe-Japan1		;
+/TBYukinariG-B		/Adobe-Japan1		;
+/TBYukinariG-DB		/Adobe-Japan1		;
+/TBYukinariG-E		/Adobe-Japan1		;
+/TBYukinariG-hv		/Adobe-Japan1		;
+/TBYukinariG-M		/Adobe-Japan1		;
+/TBYukinariG-R		/Adobe-Japan1		;
+/TBYukinariM-DE		/Adobe-Japan1		;
+/TBYukinariM-E		/Adobe-Japan1		;
+/TBYukinariM-hv		/Adobe-Japan1		;
+/TBYukinariM-M		/Adobe-Japan1		;
+/TypeBankG-B		/Adobe-Japan1		;
+/TypeBankG-DB		/Adobe-Japan1		;
+/TypeBankG-E		/Adobe-Japan1		;
+/TypeBankG-hv		/Adobe-Japan1		;
+/TypeBankG-M		/Adobe-Japan1		;
+/TypeBankG-R		/Adobe-Japan1		;
+/TypeBankM-DE		/Adobe-Japan1		;
+/TypeBankM-E		/Adobe-Japan1		;
+/TypeBankM-hv		/Adobe-Japan1		;
+/TypeBankM-M		/Adobe-Japan1		;
 
 %
 % Convenient aliases for PS files on Korean Acrobat Distiller
 %
-%/AppleGothic		/HYGoThic-Medium	;
-%/AppleMyungjo		/HYSMyeongJo-Medium	;
-%/HYSinMyeongJo-Medium	/HYSMyeongJo-Medium	;
-%/JCfg			/Adobe-Korea1		;
-%/JCkg			/Adobe-Korea1		;
-%/Munhwa-Regular	/HYSMyeongJo-Medium	;
-%/MunhwaGothic-Regular	/HYGoThic-Medium	;
-%/SMAgoJ		/HYGoThic-Medium	;
-%/SMAgoK		/HYGoThic-Medium	;
-%/SMAgoSE		/HYGoThic-Medium	;
-%/SMAgoT		/HYGoThic-Medium	;
-%/SMAmu			/HYSMyeongJo-Medium	;
-%/SMAmuK		/HYSMyeongJo-Medium	;
-%/SMAmuSE		/HYSMyeongJo-Medium	;
-%/SMAmuT		/HYSMyeongJo-Medium	;
-%/SMGothic-Bold		/HYGoThic-Medium	;
-%/SMGothic-DemiBold	/HYGoThic-Medium	;
-%/SMGothic-Light	/HYGoThic-Medium	;
-%/SMGothic-Medium	/HYGoThic-Medium	;
-%/SMMyungjo-Bold	/HYSMyeongJo-Medium	;
-%/SMMyungjo-DemiBold	/HYSMyeongJo-Medium	;
-%/SMMyungjo-Light	/HYSMyeongJo-Medium	;
-%/SMMyungjo-Medium	/HYSMyeongJo-Medium	;
-%/SMgoJ			/HYGoThic-Medium	;
-%/SMgoK			/HYGoThic-Medium	;
-%/SMgoSE		/HYGoThic-Medium	;
-%/SMgoT			/HYGoThic-Medium	;
-%/SMmu			/HYSMyeongJo-Medium	;
-%/SMmuK			/HYSMyeongJo-Medium	;
-%/SMmuSE		/HYSMyeongJo-Medium	;
-%/SMmuT			/HYSMyeongJo-Medium	;
-%/Seoul			/Adobe-Korea1		;
+/AppleGothic		/HYGoThic-Medium	;
+/AppleMyungjo		/HYSMyeongJo-Medium	;
+/HYSinMyeongJo-Medium	/HYSMyeongJo-Medium	;
+/JCfg			/Adobe-Korea1		;
+/JCkg			/Adobe-Korea1		;
+/Munhwa-Regular		/HYSMyeongJo-Medium	;
+/MunhwaGothic-Regular	/HYGoThic-Medium	;
+/SMAgoJ			/HYGoThic-Medium	;
+/SMAgoK			/HYGoThic-Medium	;
+/SMAgoSE		/HYGoThic-Medium	;
+/SMAgoT			/HYGoThic-Medium	;
+/SMAmu			/HYSMyeongJo-Medium	;
+/SMAmuK			/HYSMyeongJo-Medium	;
+/SMAmuSE		/HYSMyeongJo-Medium	;
+/SMAmuT			/HYSMyeongJo-Medium	;
+/SMGothic-Bold		/HYGoThic-Medium	;
+/SMGothic-DemiBold	/HYGoThic-Medium	;
+/SMGothic-Light		/HYGoThic-Medium	;
+/SMGothic-Medium	/HYGoThic-Medium	;
+/SMMyungjo-Bold		/HYSMyeongJo-Medium	;
+/SMMyungjo-DemiBold	/HYSMyeongJo-Medium	;
+/SMMyungjo-Light	/HYSMyeongJo-Medium	;
+/SMMyungjo-Medium	/HYSMyeongJo-Medium	;
+/SMgoJ			/HYGoThic-Medium	;
+/SMgoK			/HYGoThic-Medium	;
+/SMgoSE			/HYGoThic-Medium	;
+/SMgoT			/HYGoThic-Medium	;
+/SMmu			/HYSMyeongJo-Medium	;
+/SMmuK			/HYSMyeongJo-Medium	;
+/SMmuSE			/HYSMyeongJo-Medium	;
+/SMmuT			/HYSMyeongJo-Medium	;
+/Seoul			/Adobe-Korea1		;
diff -ruN /dev/null espgs-7.07.1-patched/lib/CIDFnmap.Saz
--- /dev/null	Tue Mar 22 14:41:21 2005
+++ espgs-7.07.1-patched/lib/CIDFnmap.Saz	Tue Mar 22 14:40:13 2005
@@ -0,0 +1,6 @@
+%!
+% Sazanami-Mincho
+/Sazanami-Mincho (<PREFIX>/lib/X11/fonts/sazanami/sazanami-mincho.ttf) ;
+
+% Sazanami-Gothic
+/Sazanami-Gothic (<PREFIX>/lib/X11/fonts/sazanami/sazanami-gothic.ttf) ;
diff -Naur espgs-7.05.6.orig/lib/gs_res.ps.in espgs-7.05.6/lib/gs_res.ps.in
--- espgs-7.05.6.orig/lib/gs_res.ps.in  2002-12-28 07:01:36.000000000 +0900
+++ espgs-7.05.6/lib/gs_res.ps.in	2002-12-28 07:03:20.000000000 +0900
@@ -245,8 +245,8 @@
   /pssystemparams 10 dict readonly def
 } if
 pssystemparams begin
-  /FontResourceDir (@datadir@/ghostscript/fonts/) readonly .forcedef	% pssys'params is r-o
-  /GenericResourceDir (@datadir@/ghostscript/) readonly .forcedef	% pssys'params is r-o
+  /FontResourceDir (@datadir@/ghostscript/Resource/Font/) readonly .forcedef	% pssys'params is r-o
+  /GenericResourceDir (@datadir@/ghostscript/Resource/) readonly .forcedef	% pssys'params is r-o
   /GenericResourcePathSep (/) readonly .forcedef	% pssys'params is r-o
 end
 end

--- espgs-7.05.6/src/gdevpx.c	2002-04-23 07:58:43.000000000 -0400
+++ espgs-7.05.6/src/gdevpx.c.new	2003-11-09 15:25:16.000000000 -0500
@@ -851,8 +851,7 @@
 	    px_put_s(s, (uint)pattern[i]);
 	px_put_a(s, pxaLineDashStyle);
 	if (offset != 0) {
-	    px_put_rl(s, offset);
-	    px_put_a(s, pxaDashOffset);
+	    px_put_usa(s, (uint)offset, pxaDashOffset);
 	}
     }
     spputc(s, pxtSetLineDash);

diff -ruN ghostscript-7.07.orig/lib/gs_ttf.ps ghostscript-7.07/lib/gs_ttf.ps
--- ghostscript-7.07.orig/lib/gs_ttf.ps	2003-04-12 23:02:38.000000000 +0900
+++ ghostscript-7.07/lib/gs_ttf.ps	2003-07-24 19:00:37.000000000 +0900
@@ -575,7 +575,7 @@
   (maxp) 1 index
   (name) 1 index
   (OS/2) 1 index
-  (post) 1 index
+  (post) { .readbigtable }
   (vhea) 1 index
 	% Big tables
   (glyf) { .readbigtable }
@@ -918,10 +918,17 @@
   DEBUG { (fontname ) print fontname = } if
 		% Stack: ... /FontInfo mark key1 value1 ...
   post null ne {
-    /ItalicAngle post 4 gets32 65536.0 div
-    /isFixedPitch post 12 getu32 0 ne
-    /UnderlinePosition post 8 gets16 upem div
-    /UnderlineThickness post 10 gets16 upem div
+    post type /arraytype eq {
+      % this post table is a big table. /post should be [(...) ...]
+      % data we actually need here should be first one in array.
+      /posttable post 1 get def
+    } {
+      /posttable post def
+    } ifelse
+    /ItalicAngle posttable 4 gets32 65536.0 div
+    /isFixedPitch posttable 12 getu32 0 ne
+    /UnderlinePosition posttable 8 gets16 upem div
+    /UnderlineThickness posttable 10 gets16 upem div
   } if
   counttomark 0 ne { .dicttomark } { pop pop } ifelse
   /XUID [orgXUID 42 curxuid]

diff -ruN ghostscript-7.07.orig/lib/gs_ttf.ps ghostscript-7.07/lib/gs_ttf.ps
--- ghostscript-7.07.orig/lib/gs_ttf.ps	2003-07-29 16:51:55.000000000 +0900
+++ ghostscript-7.07/lib/gs_ttf.ps	2003-07-29 17:44:43.000000000 +0900
@@ -1117,50 +1117,77 @@
   /gsubh2v null def
   tabdict /GSUB .knownget { % if
     dup /gsubver exch 0 getu32 def
-    %dup /gsubosl exch 4 getu16 12 add def
-    %dup /gsubofl exch 6 getu16 12 add def
-    dup /gsuboll exch 8 getu16 12 add def
+    %dup /gsubosl exch 4 getu16 def
+    %dup /gsubofl exch 6 getu16 def
+    dup /gsuboll exch 8 getu16 def
     DEBUG {
       (gsubver: ) print gsubver =
       %(gsubosl: ) print gsubosl =
       %(gsubofl: ) print gsubofl =
       (gsuboll: ) print gsuboll =
     } if
-    dup /gsubfmt exch gsuboll 0 add getu16 def
+    % /gsuboll should be pointed out the LookupList table, but not Lookup table.
+    % so this is wrong:
+    % dup /gsubfmt exch gsuboll 0 add getu16 def
+    dup /gsublc exch gsuboll 0 add getu16 def
     DEBUG {
-      (gsubfmt: ) print gsubfmt =
+      (gsublc: ) print gsublc =
     } if
-%    gsubver 16#00010000 eq { % ifelse
-      gsubfmt 2 eq { % ifelse
-	dup /gsubocv exch gsuboll 2 add getu16 def
-	dup /gsubglc exch gsuboll 4 add getu16 def
-	% hacked by suzuki toshiya at 2001/3/6
-	%dup /gsubvog exch gsuboll 6 add gsubglc getinterval def
-	%dup /gsubhog exch gsuboll gsubocv add 4 add gsubglc getinterval def
-	dup /gsubvog exch gsuboll 6 add gsubglc 2 mul getinterval def
-	dup /gsubhog exch gsuboll gsubocv add 4 add gsubglc 2 mul getinterval def
+    gsublc 0 ne {
+      0 1 gsublc 1 sub {
+	2 mul /gsubolt exch 2 index exch gsuboll 2 add add getu16 gsuboll add def
+	dup /gsubltype exch gsubolt 0 add getu16 def
+	dup /gsublflag exch gsubolt 2 add getu16 def
+	dup /gsubsubc exch gsubolt 4 add getu16 def
 	DEBUG {
-	  (gsubocv: ) print gsubocv =
-	  (gsubglc: ) print gsubglc =
-
-	  (gsubhog->gsubvog ) =
-	  0 2 gsubhog length 2 sub { % for
-	    dup
-	    gsubhog exch getu16 =only
-	    (->) =only
-	    gsubvog exch getu16 =
+	  (gsubolt: ) print gsubolt =
+	  (gsubltype: ) print gsubltype =
+	  (gsublflag: ) print gsublflag =
+	  (gsubsubc: ) print gsubsubc =
+	} if
+	gsubsubc 0 ne {
+	  0 1 gsubsubc 1 sub {
+	    2 mul /gsubost exch 2 index exch gsubolt 6 add add getu16 gsubolt add def
+	    dup /substfmt exch gsubost 0 add getu16 def
+	    DEBUG {
+	      (gsubost: ) print gsubost =
+	      (substfmt: ) print substfmt =
+	    } if
+%	    gsubver 16#00010000 eq { % ifelse
+	    gsubltype 1 eq substfmt 2 eq and { % ifelse
+	      dup /gsubocv exch gsubost 2 add getu16 def
+	      dup /gsubglc exch gsubost 4 add getu16 def
+	      % hacked by suzuki toshiya at 2001/3/6
+	      %dup /gsubvog exch gsubost 6 add gsubglc getinterval def
+	      %dup /gsubhog exch gsubost gsubocv add 4 add gsubglc getinterval def
+	      dup /gsubvog exch gsubost 6 add gsubglc 2 mul getinterval def
+	      dup /gsubhog exch gsubost gsubocv add 4 add gsubglc 2 mul getinterval def
+	      DEBUG {
+		(gsubocv: ) print gsubocv =
+		(gsubglc: ) print gsubglc =
+
+		(gsubhog->gsubvog ) =
+		0 2 gsubhog length 2 sub { % for
+		  dup
+		  gsubhog exch getu16 =only
+		  (->) =only
+		  gsubvog exch getu16 =
+		} for
+	      } if
+	      /gsubh2v << 0 2 gsubhog length 2 sub {
+		dup gsubhog exch getu16
+		exch gsubvog exch getu16
+	      } for >> def
+	    } {
+	      %(UNKNOWN GSUB FORMAT.) = flush
+	    } ifelse
+%	    } {
+%	      (ILLEGAL GSUB VERSION.) = flush
+%	    } ifelse
 	  } for
 	} if
-	/gsubh2v << 0 2 gsubhog length 2 sub {
-	  dup gsubhog exch getu16
-	  exch gsubvog exch getu16
-	} for >> def
-      } {
-	%(UNKNOWN GSUB FORMAT.) = flush
-      } ifelse
-%    } {
-%      (ILLEGAL GSUB VERSION.) = flush
-%    } ifelse
+      } for
+    } if
     pop
   } if
 } bind def

diff -ruN ghostscript-7.07.orig/lib/gs_ttf.ps ghostscript-7.07/lib/gs_ttf.ps
--- ghostscript-7.07.orig/lib/gs_ttf.ps	2003-08-04 15:23:15.000000000 +0900
+++ ghostscript-7.07/lib/gs_ttf.ps	2003-08-04 15:22:23.000000000 +0900
@@ -1104,9 +1104,26 @@
 % 4	2	Offset	Coverage(--)
 % 6	2	uint16	GlyphCount
 % 8	2	GlyphID	Substitute(vertically oriented glyphs)
-% --	2	uint16	SubstFormat
-% +2	2	uint16	GlyphCount(same as above GlyphCount)
-% +4	2	GlyphID	GlyphArray(horizontally oriented glyphs)
+%
+% [Coverage Format 1, Individual glyph indices]
+% Index Size    Type    Name of Entry
+% -----------------------------------
+% 0     2       uint16  CoverageFormat (Format identifier-format = 1)
+% 2     2       uint16  GlyphCount (same as above GlyphCount)
+% 4     2       GlyphID GlyphArray (horizontally oriented glyphs)
+%
+% [Coverage Format 2, Range of glyphs
+% Index Size    Type    Name of Entry
+% -----------------------------------
+% 0     2       uint16  CoverageFormat (Format identifier-format = 2)
+% 2     2       uint16  RangeCount
+% 4     2       struct  RangeRecord[RangeCount]
+% [RangeRecord]
+% Index Size    Type    Name of Entry
+% -----------------------------------
+% 0     2       GlyphID First GlyphID in the range
+% 2     2       GlyphID Last GlyphID in the range
+% 4     2       uint16  Coverage Index of first GlpyhID in range
 % -----------------------------------
 % References
 % 1. http://www.microsoft.com/typography/OTSPEC/gsub.htm
@@ -1161,10 +1178,13 @@
 	      %dup /gsubvog exch gsubost 6 add gsubglc getinterval def
 	      %dup /gsubhog exch gsubost gsubocv add 4 add gsubglc getinterval def
 	      dup /gsubvog exch gsubost 6 add gsubglc 2 mul getinterval def
-	      dup /gsubhog exch gsubost gsubocv add 4 add gsubglc 2 mul getinterval def
+	      dup /cvfmt exch gsubost gsubocv add 0 add getu16 def
+	      dup /cvglc exch gsubost gsubocv add 2 add getu16 def
+	      dup /gsubhog exch gsubost gsubocv add 4 add cvglc 2 mul getinterval def
 	      DEBUG {
 		(gsubocv: ) print gsubocv =
 		(gsubglc: ) print gsubglc =
+		(cvfmt: ) print cvfmt =
 
 		(gsubhog->gsubvog ) =
 		0 2 gsubhog length 2 sub { % for
@@ -1174,10 +1194,31 @@
 		  gsubvog exch getu16 =
 		} for
 	      } if
-	      /gsubh2v << 0 2 gsubhog length 2 sub {
-		dup gsubhog exch getu16
-		exch gsubvog exch getu16
-	      } for >> def
+	      cvfmt 1 eq {
+		/gsubh2v << 0 2 gsubhog length 2 sub {
+		  dup gsubhog exch getu16
+		  exch gsubvog exch getu16
+		} for >> def
+	      } {
+		cvfmt 2 eq {
+		  /gsubh2v << 0 6 gsubhog length 6 sub {
+		    dup 0 add /fgid exch gsubhog exch getu16 def
+		    dup 2 add /lgid exch gsubhog exch getu16 def
+		    4 add /cvidx exch gsubhog exch getu16 def
+		    DEBUG {
+		      (fgid: ) print fgid =
+		      (lgid: ) print lgid =
+		      (cvidx: ) print cvidx =
+		    } if
+		    fgid 1 lgid {
+		      dup cvidx add fgid sub
+		      exch gsubvog exch getu16
+		    } for
+		  } for >> def
+		} {
+		  %(UNKNWON COVERAGE FORMAT.) = flush
+		} ifelse
+	      } ifelse
 	    } {
 	      %(UNKNOWN GSUB FORMAT.) = flush
 	    } ifelse

--- espgs-7.07.1/lib/ps2pdfwr.org	2003-09-01 18:39:30.000000000 +0900
+++ espgs-7.07.1/lib/ps2pdfwr	2003-09-25 18:39:14.000000000 +0900
@@ -31,6 +31,169 @@
 	outfile="$2"
 fi
 
+[ "$NeverEmbedFontList" != "" ] || NeverEmbedFontList="
+/Courier
+/Courier-Bold
+/Courier-BoldOblique
+/Courier-Oblique
+/Helvetica
+/Helvetica-Bold
+/Helvetica-BoldOblique
+/Helvetica-Oblique
+/Symbol
+/Times-Bold
+/Times-BoldItalic
+/Times-Italic
+/Times-Roman
+/ZapfDingbats
+"
+[ "$AlwaysEmbedFontList" != "" ] || AlwaysEmbedFontList="
+/AvantGarde-Book
+/AvantGarde-BookOblique
+/AvantGarde-Demi
+/AvantGarde-DemiOblique
+/Bookman-Demi
+/Bookman-DemiItalic
+/Bookman-Light
+/Bookman-LightItalic
+/Helvetica-Narrow
+/Helvetica-Narrow-Bold
+/Helvetica-Narrow-BoldOblique
+/Helvetica-Narrow-Oblique
+/Palatino-Bold
+/Palatino-BoldItalic
+/Palatino-Italic
+/Palatino-Roman
+/ZapfChancery-MediumItalic
+
+/Arial-BoldItalicMT
+/Arial-BoldMT
+/Arial-ItalicMT
+/ArialMT
+/ArialNarrow
+/ArialNarrow-Bold
+/ArialNarrow-BoldItalic
+/ArialNarrow-Italic
+/BookmanOldStyle
+/BookmanOldStyle-Bold
+/BookmanOldStyle-BoldItalic
+/BookmanOldStyle-Italic
+/CenturyGothic
+/CenturyGothic-Bold
+/CenturyGothic-BoldItalic
+/CenturyGothic-Italic
+/CourierNewPS-BoldItalicMT
+/CourierNewPS-BoldMT
+/CourierNewPS-ItalicMT
+/CourierNewPSMT
+/NewCenturySchlbk-Bold
+/NewCenturySchlbk-BoldItalic
+/NewCenturySchlbk-Italic
+/NewCenturySchlbk-Roman
+/PalatinoLinotype-Bold
+/PalatinoLinotype-BoldItalic
+/PalatinoLinotype-Italic
+/PalatinoLinotype-Roman
+/TimesNewRomanPS-BoldItalicMT
+/TimesNewRomanPS-BoldMT
+/TimesNewRomanPS-ItalicMT
+/TimesNewRomanPSMT
+"
+[ "$NeverEmbedCIDFontList" != "" ] || NeverEmbedCIDFontList="
+/MSung-Light
+/MSung-Medium
+/MHei-Medium
+/MKai-Medium
+/STSong-Light
+/STFangsong-Light
+/STHeiti-Regular
+/STKaiti-Regular
+/Ryumin-Light
+/GothicBBB-Medium
+/HeiseiMin-W3
+/HeiseiKakuGo-W5
+/KozMin-Regular
+/HYGoThic-Medium
+/HYGungSo-Bold
+/HYKHeadLine-Bold
+/HYKHeadLine-Medium
+/HYSMyeongJo-Medium
+/HYRGoThic-Medium
+
+/MOEKai-Regular
+/MOESung-Regular
+/WadaGo-Bold
+/WadaMaruGo-Regular
+/WadaMaruGo-RegularH
+/WadaMin-Bold
+/WadaMin-Regular
+/WadaMin-RegularH
+/Munhwa-Bold
+/Munhwa-Regular
+/MunhwaGothic-Bold
+/MunhwaGothic-Regular
+/MunhwaGungSeo-Bold
+/MunhwaGungSeo-Light
+/MunhwaGungSeoHeulim-Bold
+/MunhwaGungSeoHeulim-Light
+/MunhwaHoonMin-Regular
+
+/MingLiU
+/PMingLiU
+/SimHei
+/SimSun
+/NSimSun
+/HGGothicE
+/HGGothicEPRO
+/HGGothicM
+/HGGyoshotai
+/HGMarugothicMPRO
+/HGPGothicE
+/HGPGothicM
+/HGPGyoshotai
+/HGPSoeiKakugothicUB
+/HGPSoeiKakupoptai
+/HGSGothicE
+/HGSGothicM
+/HGSGyoshotai
+/HGSSoeiKakugothicUB
+/HGSSoeiKakupoptai
+/HGSeikaishotaiPRO
+/HGSoeiKakugothicUB
+/HGSoeiKakupoptai
+/Kochi-Gothic
+/Kochi-Mincho
+/MojikumiKata-EB
+/Mona
+/MS-Mincho
+/MS-PMincho
+/MS-Gothic
+/MS-PGothic
+/MS-UIGothic
+/Batang
+/BatangChe
+/Gungsuh
+/GungsuhChe
+/Gulim
+/GulimChe
+/Dotum
+/DotumChe
+/New-Gulim
+
+/MHei-Medium-Acro
+/MSung-Light-Acro
+/STSong-Light-Acro
+/HeiseiKakuGo-W5-Acro
+/HeiseiMin-W3-Acro
+/HYGoThic-Medium-Acro
+/HYSMyeongJo-Medium-Acro
+"
+[ "$AlwaysEmbedCIDFontList" != "" ] || AlwaysEmbedCIDFontList="
+/SimSun-18030-Adobe-CNS1
+/NSimSun-18030-Adobe-CNS1
+/SimSun-18030
+/NSimSun-18030
+"
 # We have to include the options twice because -I only takes effect if it
 # appears before other options.
-exec gs $OPTIONS -q -dNOPAUSE -dBATCH -sDEVICE=pdfwrite "-sOutputFile=$outfile" $OPTIONS -c .setpdfwrite -f "$infile"
+exec gs $OPTIONS -q -dNOPAUSE -dBATCH -sDEVICE=pdfwrite "-sOutputFile=$outfile" $OPTIONS -c ".setpdfwrite <</NeverEmbed [$NeverEmbedFontList $NeverEmbedCIDFontList] /AlwaysEmbed [$AlwaysEmbedFontList $AlwaysEmbedCIDFontList]>> setdistillerparams" -f "$infile"

--- espgs-7.07.1/lib/gs_cidfn.ps.org	2003-04-12 23:02:38.000000000 +0900
+++ espgs-7.07.1/lib/gs_cidfn.ps	2003-09-03 07:28:28.000000000 +0900
@@ -511,9 +511,32 @@
 
 .loadinitialcidfonts
 
+% <fontname> <font> .RenameFontForNeverEmbed <fontname> <font'>
+/.RenameFontForNeverEmbed {
+    /DEVICE where { pop DEVICE (pdfwrite) eq {
+        currentdistillerparams /NeverEmbed get {
+            2 index eq {
+                (*** unembeddable CIDFont: ) print 1 index == flush
+                dup length 1 add dict copy
+                dup /FID undef
+                dup /.orig_CIDFontName 1 index /CIDFontName get put
+                dup /CIDFontName 3 index dup type /stringtype eq {
+                    dup rcheck {
+                        dup length string 0 1 2 index length 1 sub {
+                            2 index 1 index get 3 copy put pop pop
+                        } for exch pop
+                    } if
+                } if put
+                dup /FontName 1 index /CIDFontName get put
+            } if
+        } forall
+    } if } if
+} bind def
+
 /CIDFontmapHandler <<
   /nametype {
     /CIDFont findresource
+    .RenameFontForNeverEmbed
     /CIDFont defineresource pop
   } bind
   /stringtype {
@@ -528,6 +551,7 @@
 	      pop pop
 	  } {
 	      % Give a name different from the name defined in the file
+	      .RenameFontForNeverEmbed
 	      /CIDFont defineresource pop
 	  } ifelse
       } {
@@ -546,6 +570,7 @@
 	  3 -1 roll put
 	  % Expand array
 	  aload pop .loadcjkvttcidfont
+	  .RenameFontForNeverEmbed
 	  /CIDFont defineresource pop
       } {
 	  /undefinedresource signalerror

--- espgs-7.07.1/src/gdevpdff.h.org	2003-01-17 09:49:02.000000000 +0900
+++ espgs-7.07.1/src/gdevpdff.h	2003-09-18 23:42:38.000000000 +0900
@@ -117,6 +117,12 @@
     FONT_SUBSET_NO
 } pdf_font_do_subset_t;
 
+typedef enum {
+    FONT_EMBED_STANDARD,	/* 14 standard fonts */
+    FONT_EMBED_NO,
+    FONT_EMBED_YES
+} pdf_font_embed_t;
+
 struct pdf_font_descriptor_s {
     pdf_resource_common(pdf_font_descriptor_t);
     pdf_font_name_t FontName;
@@ -198,6 +204,7 @@
     gs_font *font;		/* non-0 iff font will notify us; */
 				/* should be a weak pointer */
     int index;			/* in pdf_standard_fonts, -1 if not base 14 */
+    pdf_font_embed_t embed;	/* status of pdf_font_embed_status() */
     gs_matrix orig_matrix;	/* FontMatrix of unscaled font for embedding */
     bool is_MM_instance;	/* for Type 1/2 fonts, true iff the font */
 				/* is a Multiple Master instance */
@@ -320,12 +327,6 @@
 
 /* ---------------- Exported by gdevpdff.c ---------------- */
 
-typedef enum {
-    FONT_EMBED_STANDARD,	/* 14 standard fonts */
-    FONT_EMBED_NO,
-    FONT_EMBED_YES
-} pdf_font_embed_t;
-
 typedef struct pdf_standard_font_s {
     const char *fname;
     gs_encoding_index_t base_encoding;
--- espgs-7.07.1/src/gdevpdff.c.org	2003-01-17 09:49:02.000000000 +0900
+++ espgs-7.07.1/src/gdevpdff.c	2003-09-21 05:08:36.000000000 +0900
@@ -276,6 +276,11 @@
     const byte *chars = font->font_name.chars;
     uint size = font->font_name.size;
 
+    /* CIDFonts has null string in font_name, key_name is used */
+    if (0 == size) {
+	chars = font->key_name.chars;
+	size = font->key_name.size;
+    }
     /*
      * The behavior of Acrobat Distiller changed between 3.0 (PDF 1.2),
      * which will never embed the base 14 fonts, and 4.0 (PDF 1.3), which
@@ -720,19 +725,22 @@
 	same &= ~FONT_SAME_METRICS;
 	break;
     case FONT_EMBED_NO:
-	/*
-	 * Per the PDF 1.3 documentation, there are only 3 BaseEncoding
-	 * values allowed for non-embedded fonts.  Pick one here.
-	 */
-	BaseEncoding =
-	    ((const gs_font_base *)base_font)->nearest_encoding_index;
-	switch (BaseEncoding) {
-	default:
-	    BaseEncoding = ENCODING_INDEX_WINANSI;
-	case ENCODING_INDEX_WINANSI:
-	case ENCODING_INDEX_MACROMAN:
-	case ENCODING_INDEX_MACEXPERT:
-	    break;
+	if (!(font->FontType == ft_CID_encrypted ||
+	      font->FontType == ft_CID_TrueType)) {
+	    /*
+	     * Per the PDF 1.3 documentation, there are only 3 BaseEncoding
+	     * values allowed for non-embedded fonts.  Pick one here.
+	     */
+	    BaseEncoding =
+	        ((const gs_font_base *)base_font)->nearest_encoding_index;
+	    switch (BaseEncoding) {
+	    default:
+	        BaseEncoding = ENCODING_INDEX_WINANSI;
+	    case ENCODING_INDEX_WINANSI:
+	    case ENCODING_INDEX_MACROMAN:
+	    case ENCODING_INDEX_MACEXPERT:
+	        break;
+	    }
 	}
 	code = pdf_compute_font_descriptor(pdev, &fdesc, font, NULL);
 	if (code < 0)
@@ -888,6 +896,7 @@
 	memcpy(ppf->widths_known, ftemp_widths_known,
 	       sizeof(ftemp_widths_known));
     }
+    ppf->embed = embed;
     code = pdf_register_font(pdev, font, ppf);
 
     *pppf = ppf;
--- espgs-7.07.1/src/gdevpdfw.c.org	2003-01-17 09:49:02.000000000 +0900
+++ espgs-7.07.1/src/gdevpdfw.c	2003-09-25 17:50:54.000000000 +0900
@@ -348,18 +348,19 @@
     /* Use the most common width as DW. */
 
     {
-	ushort counts[1001];
+        ushort counts[1500*2]; /* histogram of (-1500..1500) */
 	int dw_count = 0, i;
 
 	memset(counts, 0, sizeof(counts));
 	while (!psf_enumerate_glyphs_next(&genum, &glyph)) {
-	    int width = ppf->Widths[glyph - gs_min_cid_glyph];
+	    int cid = glyph - gs_min_cid_glyph;
+	    int width = ppf->Widths[cid];
 
-	    counts[min(width, countof(counts) - 1)]++;
+	    counts[max(0,min(width+countof(counts)/2,countof(counts)-1))]++;
 	}
-	for (i = 0; i < countof(counts); ++i)
+	for (i = 0; i < countof(counts); i++)
 	    if (counts[i] > dw_count)
-		dw = i, dw_count = counts[i];
+		dw = i - countof(counts)/2, dw_count = counts[i];
 	if (dw != 0)
 	    pprintd1(s, "/DW %d\n", dw);
     }
@@ -496,14 +497,16 @@
 	if (pdf_has_subset_prefix(chars, size))
 	    chars += SUBSET_PREFIX_SIZE, size -= SUBSET_PREFIX_SIZE;
 	pdf_put_name(pdev, chars, size);
-	if (pef->sub_font_type == ft_CID_encrypted &&
+	if ((pef->sub_font_type == ft_CID_encrypted ||
+	     pef->sub_font_type == ft_CID_TrueType) &&
 	    pef->cmapname[0] == '/'
 	    ) {
 	    stream_putc(s, '-');
 	    pdf_put_name_chars(pdev, (const byte*) (pef->cmapname + 1),
 			       strlen(pef->cmapname + 1));
 	}
-	pprints1(s, "/Encoding %s", pef->cmapname);
+	pprints1(s, (pef->cmapname[0] == '/') ? "/Encoding%s" : "/Encoding %s",
+		 pef->cmapname);
 	pprintld1(s, "/DescendantFonts[%ld 0 R]",
 		pdf_resource_id((const pdf_resource_t *)pef->DescendantFont));
 	write_Widths = 0;
@@ -563,8 +566,10 @@
 	break;
     case -1:
 	pdf_write_CIDFont_widths(pdev, pef);
-	if (pef->FontType == ft_CID_TrueType)
-	    pdf_write_CIDToGIDMap(pdev, pef, &cidmap_id);
+	if (pef->FontType == ft_CID_TrueType) {
+	    if (pef->embed != FONT_EMBED_NO)
+	        pdf_write_CIDToGIDMap(pdev, pef, &cidmap_id);
+	}
 	break;
     }
     if (pef->Differences) {
--- espgs-7.07.1/src/gdevpdfs.c.org	2003-09-20 00:11:16.000000000 +0900
+++ espgs-7.07.1/src/gdevpdfs.c	2003-09-25 17:44:10.000000000 +0900
@@ -481,15 +481,21 @@
 
 	    if (cid < pfd->chars_count) {
 		int index = cid >> 3, mask = 0x80 >> (cid & 7);
+		int gid;
+
+		if (!(pfd->chars_used.data[index] & mask) ||
+		    !(psubf->widths_known[index] & mask)) {
 
-		if (!(pfd->chars_used.data[index] & mask)) {
-		    pfd->chars_used.data[index] |= mask;
 		    if (psubf->CIDToGIDMap) {
 			gs_font_cid2 *const subfont2 =
 			    (gs_font_cid2 *)subfont;
-			int gid =
-			    subfont2->cidata.CIDMap_proc(subfont2, glyph);
 
+			gid = subfont2->cidata.CIDMap_proc(subfont2, glyph);
+		    }
+		}
+		if (!(pfd->chars_used.data[index] & mask)) {
+		    pfd->chars_used.data[index] |= mask;
+		    if (psubf->CIDToGIDMap) {
 			if (gid >= 0) {
 			    psubf->CIDToGIDMap[cid] = gid;
 			    mark_glyphs_used(subfont, gid + gs_min_cid_glyph,
@@ -500,7 +506,11 @@
 		if (!(psubf->widths_known[index] & mask)) {
 		    int width;
 
-		    code = pdf_glyph_width(psubf, glyph, subfont, &width);
+		    if (psubf->CIDToGIDMap)
+			code = pdf_glyph_width(psubf, gid + gs_min_cid_glyph,
+					       subfont, &width);
+		    else
+		        code = pdf_glyph_width(psubf, glyph, subfont, &width);
 		    if (code == 0) {
 			psubf->Widths[cid] = width;
 			psubf->widths_known[index] |= mask;
diff -ruN espgs-7.07.1-orig/src/unixinst.mak espgs-7.07.1/src/unixinst.mak
--- espgs-7.07.1-orig/src/unixinst.mak	Sun Jul 21 06:03:21 2002
+++ espgs-7.07.1-patched/src/unixinst.mak	Tue Mar 22 16:49:19 2005
@@ -64,7 +64,7 @@
 	-mkdir -p $(gsdatadir)/lib
 	$(SH) -c 'for f in \
 Fontmap Fontmap.GS \
-CIDFnmap CIDFnmap.Ore CIDFnmap.ARP CIDFnmap.Bae CIDFnmap.Koc \
+CIDFnmap CIDFnmap.Ore CIDFnmap.ARP CIDFnmap.Bae CIDFnmap.Koc CIDFnmap.Saz \
 CIDFnmap.Sol CIDFnmap.Win \
 CIDFnmap.CJK \
 CIDFnmap.b5 CIDFnmap.gb CIDFnmap.ksx CIDFnmap.sj \
diff -ruN espgs-7.07.1.orig/src/configure.ac espgs-7.07.1/src/configure.ac
--- espgs-7.07.1.orig/src/configure.ac	Thu Mar 24 01:00:21 2005
+++ espgs-7.07.1/src/configure.ac	Thu Mar 24 01:15:03 2005
@@ -448,7 +448,7 @@
 	if test "x$CUPSCONFIG" != x; then
 	    dnl Use values from CUPS config...
 #	    LIBS="`$CUPSCONFIG --ldflags` `$CUPSCONFIG --static --image --libs | sed -e '1,$s/-lssl//'` $LIBS"
-	    LIBS="`$CUPSCONFIG --ldflags` `$CUPSCONFIG --image --libs` $LIBS"
+	    LIBS="`$CUPSCONFIG --ldflags` `$CUPSCONFIG --image --libs | sed -e '1,$s/-lssl//' | sed -e '1,$s/-lcrypto//'` $LIBS"
 	    CFLAGS="`$CUPSCONFIG --cflags` $CFLAGS"
 	    cups_serverroot="`$CUPSCONFIG --serverroot`"
 	    cups_serverbin="`$CUPSCONFIG --serverbin`"
diff -ruN espgs-7.07.1-orig/pstoraster/cups.mak espgs-7.07.1/pstoraster/cups.mak
--- espgs-7.07.1-orig/pstoraster/cups.mak	2003-08-21 00:12:43.000000000 +0900
+++ espgs-7.07.1/pstoraster/cups.mak	2006-02-25 15:52:09.000000000 +0900
@@ -24,9 +24,9 @@
 
 cups_=	$(GLOBJ)gdevcups.$(OBJ)
 
-CUPSSERVER= $(install_prefix)`cups-config --serverbin`
-CUPSCONFIG= $(install_prefix)`cups-config --serverroot`
-CUPSDATA= $(install_prefix)`cups-config --datadir`
+CUPSSERVER= $(libdir)/cups
+CUPSCONFIG= $(prefix)/etc/cups
+CUPSDATA= $(datadir)/cups
 
 $(DD)cups.dev:	$(cups_) $(GLD)page.dev
 	$(SETPDEV2) $(DD)cups $(cups_)
