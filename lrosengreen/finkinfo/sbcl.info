Info2: <<

Package: sbcl%type_pkg[-clc]
Version: 0.8.18
Revision: 100
Description: ANSI Common Lisp implementation
License: BSD
Maintainer: Lars Rosengreen <lars@margay.org>

# NOTE: The version of the bootstrap binary does not automatically
# change when the version field is updated!  CompileScript and Source2
# need to be updated by hand when moving to a new version of the
# bootstap binary

Depends: (%type_pkg[-clc]) common-lisp-controller
BuildDepends: gcc3.1, texinfo (>= 4.6)
Recommends: gnupg | gnupg-idea | gnupg-testing

# for common lisp controller
Type: -clc (boolean)
Conflicts: %{ni}, %{ni}-clc
Replaces: %{ni}, %{ni}-clc
PostInstScript:[ "%type_pkg[-clc]" ] && %p/sbin/register common-lisp-implementation %{ni}
PreRmScript: [ "%type_pkg[-clc]" ] && %p/sbin/unregister-common-lisp-implementation %{ni}

Source: mirror:sourceforge:%{ni}/%{ni}-%v-source.tar.bz2
Source2: mirror:sourceforge:%{ni}/%{ni}-0.8.17-powerpc-darwin-binary.tar.bz2
Source-MD5: 23d3d60e921d0c5498feed47cfcf436f
Source2-MD5: 8e2eadf069bd14be6d8391e67938f192

SourceDirectory: %{ni}-%v

PatchScript: patch -p1 < %a/%{ni}.patch


CompileScript: <<
  unset LD_PREBIND ; sh make.sh "../%{ni}-0.8.17-powerpc-darwin/src/runtime/sbcl --core ../%{ni}-0.8.17-powerpc-darwin/output/sbcl.core --disable-debugger --sysinit /dev/null --userinit /dev/null"
  cd doc/manual ; make html info
<<

InstallScript: <<
  find %b -type d -name CVS -depth -exec rm -rf {} \;
  find %b -type f -name .cvsignore -depth -exec rm -f {} \;
  unset SBCL_HOME ; INSTALL_ROOT=%i sh install.sh
  
  mv %i/bin/%{ni} %i/lib/%{ni}/%{ni}.bin
  echo '#! /bin/sh' > %i/bin/%{ni}
  echo 'SBCL_HOME=%p/lib/%{ni}/ exec %p/lib/%{ni}/%{ni}.bin "$@"' >> %i/bin/%{ni}
  chmod 755 %i/bin/%{ni}
<<

InfoDocs: sbcl.info asdf.info

DocFiles: BUGS COPYING CREDITS NEWS README

Homepage: http://www.sbcl.org/

DescDetail: <<
Steel Bank Common Lisp is an open source development system for ANSI
Common Lisp.  It provides an interactive environment including an
integrated native compiler, interpreter, and debugger.  Several
extensions, such as a foreign function interface, and support for Unix
(POSIX) system calls are also included.  SBCL is derived from CMU CL.
<< 

DescPort: <<
Uses an SBCL binary for bootstrapping.
<<
<<

# arch-tag: 0CDCDBC4-6D9C-11D9-919F-000393A5E706
