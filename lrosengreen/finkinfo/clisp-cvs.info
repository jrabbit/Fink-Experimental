Package: clisp-cvs
Version: 2.33.83-cvs
Revision: 1
License: GPL/GFDL
Description: ANSI Common Lisp implementation (CVS)
Maintainer: Lars Rosengreen <lars@margay.org>

Depends: readline-shlibs (>= 4.3-15), gettext
BuildDepends: readline (>= 4.3-15), gettext-tools, gettext-bin,  gettext-dev

Conflicts: clisp

Source: none

PatchScript: <<
  #! /bin/sh
  
  workdir=$PWD
  cachedir="%p/var/cache/fink/%n.cache"
  cvsroot=":pserver:anonymous@cvs.sourceforge.net:/cvsroot/clisp"

  if [ -f $cachedir/CVS/Root ]; then
    cd $cachedir
    echo "updating source code cache from CVS ..."
    cvs -z3 up -dAP
  else
    rm -rf $cachedir   # get rid of corrupted, unrecoverable caches
    mkdir -p %p/var/cache/fink
    cd %p/var/cache/fink
    echo "fetching source code from CVS  ..."
    echo "if you are prompted for a password, press return"
    cvs -d$cvsroot login
    cvs -z3 -d$cvsroot co -d %n.cache clisp
  fi

  echo "copying source from $cachedir to $workdir ..."
  cp -Rp $cachedir/* $workdir
<<

GCC: 3.3
SetCC: gcc-3.3
SetCXX: g++-3.3

ConfigureParams: --with-readline --with-module=clx/mit-clx build

CompileScript: <<
  ./configure %c
  cd build ; ./makemake %c > Makefile ; make config.lisp ; make
  cd build ; make check-recompile
  cd build ; make check-tests
<<

InstallScript:  cd build; make DESTDIR=%d install

PostRmScript: <<
  if [ $1 = "purge" ]; then
    rm -rf "%p/var/cache/fink/%n.cache"
  fi
<<

DescDetail: <<
A feature loaded common lisp programming environment with unicode
support, excellent ANSI compliance, a full-featured MOP.  CLISP has
the ability (at least in theory) to work with lisp images larger than
4 gigabytes on machines with a 64bit processor (untested on the G5).

This package pulls and builds source from clisp's CVS source code
repository.
<<

DescUsage: <<
Type "clisp" at a shell prompt to start clisp.  If you wish to use
one of clisp's add-on modules, you should use "clisp -K modulename"
instead, or "clisp -K full" to load all available modules.

The following add-on modules are currently built by this package:
MIT-CLX  - Low level interface to X11

To pull the latest changes from CVS and rebuild this package, type
"fink rebuild clisp-cvs" at a shell promp.

The source code cache created in %p/var/cache/fink/clisp-cvs.cache
can be safely deleted whenever you wish.  The package will regenerate
it as needed.
<<

DescPackaging: <<
14Jan2005: REGEXP, I18N and SYSCALLS moved into base image upstream

10Mar2005: Dynamic FFI works now.

09Apr2005: don't use the --build configure option; it does a full make
           check which attempts to run the (missing) ANSI and SACLA
           test suites.  There is not reason to do that here.  make
           check-recompile and make check-tests is more than enough.


To Do:
Package libsigsegv and see why dynamic-ffi doesn't seem to get built.
<<

Homepage: http://clisp.cons.org

# arch-tag: 895E7BF3-6135-11D9-92C0-000393A5E706
