diff -ru dillo-0.7.0/src/cookies.c dillo-0.7.0-patched/src/cookies.c
--- dillo-0.7.0/src/cookies.c	2003-01-12 01:25:20.000000000 +0100
+++ dillo-0.7.0-patched/src/cookies.c	2003-02-17 15:44:08.000000000 +0100
@@ -159,7 +159,7 @@
    }
 
    /* Try to get a lock from the file descriptor */
-   disabled = (lockf(fileno(file_stream), F_TLOCK, 0) == -1);
+   disabled = (flock(fileno(file_stream), LOCK_EX|LOCK_NB) == -1);
    if (disabled) {
       DEBUG_MSG(10, "The cookies file has a file lock:\n"
                     "  disabling cookies in this dillo!\n");
@@ -296,7 +296,7 @@
 
    g_hash_table_foreach_remove(cookies, Cookies_freeall_cb, NULL);
 
-   lockf(fd, F_ULOCK, 0);
+   flock(fd, LOCK_UN);
    fclose(file_stream);
 }
 
Only in dillo-0.7.0-patched/src: cookies.c~
