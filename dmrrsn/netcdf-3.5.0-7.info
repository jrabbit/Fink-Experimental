Package: netcdf
Version: 3.5.0
Revision: 7
Maintainer: Jeffrey Whitaker <jsw@cdc.noaa.gov>
Depends: %N-shlibs (= %v-%r)
Conflicts: netcdf-absoft
Replaces: netcdf-absoft
GCC: 3.1
Source: ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-%v.tar.Z
SourceDirectory: netcdf-%v/src
NoSetLDFLAGS: true
SetCXX: c++
SetCPPFLAGS: -DNDEBUG -Df2cFortran
CompileScript: <<
  CFLAGS='-O2 -fno-common' FC='%p/bin/fort77' FFLAGS='-O2 -Nx400 -w' ./configure %c
  make
<<
InstallScript: <<
 mkdir -p %i/share/man
 make install prefix=%i MANDIR=%i/share/man
 (mkdir libtmp; cd libtmp; ar -x ../libsrc/libnetcdf.a)
 (cd libtmp; objfiles=`ls -1 *.o`; cc -dynamiclib -flat_namespace -undefined suppress -o libnetcdf.%v.dylib $objfiles -install_name %p/lib/libnetcdf.3.dylib -current_version %v -compatibility_version 3.5) 
 cp libtmp/libnetcdf.%v.dylib %i/lib
 (cd %i/lib; ln -s %p/lib/libnetcdf.%v.dylib libnetcdf.3.dylib; ln -s %p/lib/libnetcdf.%v.dylib libnetcdf.dylib)
 rm -rf %i/share/man/man3f
 rm -rf %i/share/man/cat1
 rm -rf %i/share/man/cat3
 rm -f %i/share/man/whatis.db
<<
SplitOff: <<
 Package: %N-shlibs
 Conflicts: netcdf-absoft
 Replaces: %N (<= 3.5.0-6), netcdf-absoft
 Depends: fort77
 Files: lib/libnetcdf.*.dylib
 Shlibs: <<
   %p/lib/libnetcdf.3.dylib %n (>= %v-%r)
   %p/lib/libnetcdf.3.5.0.dylib %n (>= %v-%r)
 <<
 DocFiles:  COPYRIGHT README RELEASE_NOTES
<<
DocFiles: COPYRIGHT README RELEASE_NOTES
Description: Interface and library for array-oriented data access.
DescDetail: <<
The NetCDF (network Common Data Form) library defines a machine-independent
format for representing scientific data. Together, the interface, library,
and format support the creation, access, and sharing of scientific data.

Includes f2cFortran interface.
<<
DescPort: <<
 crude hack to create shared lib by extracting symbols from
 static lib (needed for some python modules). This requires adding 
 -fno-common to CFLAGS. NoSetLDFLAGS is now necessary to prevent build
 from picking up dynamic lib from previous install instead of static lib
 from new install.
<<
DeskPackaging: <<
 We list both libnetcdf.3.dylib and libnetcdf.3.5.0.dylib because earlier
 versions of this package build the library with the non-standard
 -install_name of libnetcdf.3.5.0.dylib .
<<
Homepage: http://www.unidata.ucar.edu/packages/netcdf/
License: OSI-Approved
