Package: macaulay2
Version: 0.9.20
Revision: 1002
GCC: 4.0
Source: http://www.math.uiuc.edu/Macaulay2/Downloads/Test-Versions/Macaulay2-%v-src.tar.gz
Source-MD5: 1c7a1f9aa2879b90940687d7ab675b0d
Source2: http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/src/3-0-0/Singular-3-0-0-9.tar.gz
Source2-MD5: 9bf62fa84f318361ac3e556eb52f68dd
Depends: readline5-shlibs, libncurses5-shlibs, gdbm3-shlibs, gc-shlibs (>= 6.7-1)
BuildDepends: readline5, libncurses5, gdbm3, gc (>= 6.7-1), gmp (>= 4.2.1-1), libmpfr1, ntl (>= 5.4-1001), autoconf2.5
BuildConflicts: broken-gcc, singular-factory, singular-libfac
Suggests: emacs | xemacs
SourceDirectory: Macaulay2-%v
PatchScript: <<
 sed "s|@PREFIX@|/sw|g" < %a/%n.patch | patch -p1
 mv Macaulay2/README.MacOSX Macaulay2/README.MacOSX.orig
 sed 's|/sw|%p|g' < Macaulay2/README.MacOSX.orig > Macaulay2/README.MacOSX
 cd ../Singular-3-0-0; patch -p1 < %a/singular-factory.patch
 cd ../Singular-3-0-0; patch -p1 < %a/singular-libfac.patch
<<
#ConfigureParams: --with-veclib --enable-altivec --disable-encap --with-gmplib="%p/lib/libmpfr.a %p/lib/libgmp.a" --infodir='${prefix}/share/info'
ConfigureParams: --with-veclib --enable-altivec --disable-encap --with-gmplib="%p/lib/libmpfr.a %p/lib/libgmp.a"
SetLDFLAGS: -L%b/../install/lib
SetCPPFLAGS: -I%b/../install/include
CompileScript: <<
 #!/bin/bash -ev
 export CPU=""
 if [ "%m" = "powerpc" ]; then
  export CPU="-mcpu=7450"
 fi
 cd ..
 mkdir build; mkdir install
 cd Singular-3-0-0/factory
 export CFLAGS="-mdynamic-no-pic -O3 -fschedule-insns -fschedule-insns2 -fsched-interblock -fstrict-aliasing \
   -fregmove -freorder-blocks -fast $CPU --param max-gcse-passes=3 -ffast-math"
 export CXXFLAGS="-mdynamic-no-pic -O3 -fschedule-insns -fschedule-insns2 -fsched-interblock -fstrict-aliasing \
   -fregmove -freorder-blocks -fast $CPU --param max-gcse-passes=3 -ffast-math -fno-exceptions -fno-rtti -Wno-deprecated"
 export CPATH=%p/include 
 export CC="gcc" 
 export CXX="g++" 
 ./configure --prefix=%p --enable-NTL  --with-gmp ; make
 make install prefix=%b/../install
 cd ../libfac
 export CPATH="%p/include %b/../install/include"
CPPFLAGS="-I%p/include -I%b/../install/include -Wno-deprecated" ./configure --prefix=%p --enable-NTL
 make DEFS=-DHAVE_SINGULAR_ERROR
 make install prefix=%b/../install
 ranlib %b/../install/lib/libfac.a
 cd ../../Macaulay2-%v
 export CXXFLAGS=""
 export CFLAGS=""
 make
 cd ../build
 ../Macaulay2-%v/configure %c 
 (ulimit -s 16000; make)
<<
InstallScript: <<
 cd ../build; make install prefix=%i IgnoreExampleErrors=true
 mkdir -p %i/share
 mv %i/info %i/share
<<
InfoDocs: <<
 Classic.info
 Dmodules.info
 Elimination.info
 FirstPackage.info
 FourierMotzkin.info
 GenericInitialIdeal.info
 LLLBases.info
 Macaulay2.info
 Markov.info
 PackageTemplate.info
 Parsing.info
 Points.info
 PrimaryDecomposition.info
 ReesAlgebra.info
 SchurRings.info
 SimplicialComplexes.info
 Style.info
 TangentCone.info
<<
DocFiles: <<
 Macaulay2/CHANGES Macaulay2/COPYING
<<
# Macaulay2/CHANGES Macaulay2/COPYING Macaulay2/README
License: GPL
Description: Computer algebra system for algebraic geometry
DescPackaging: <<
 The former 'singular-factory' and 'singular-libfac' packages are now obsolete;
 instead, this package compiles those libraries (statically, as before), and
 then links them in to macaulay2.  The 'singular' package provides factory
 and libfac libraries suitable for other uses.
<<
DescPort: <<
 The options for building singular-factor and singular-libfac have been
 retained as before; they match those used in an earlier version of the 
 'singular' package.

 While compiling singular-factory and singular-libfac, we now use -fast 
 instead of the obsolete -floop-transpose flag; however, on powerpc only we 
 must add -mcpu=7450 or else the compiled object will only run on G5.

 Note that libgmp and libmpfr are linked statically, so there is no need
 to depend on the -shlibs splitoffs.
<<
DescUsage: <<
 Run Macaulay2 using the command "M2".  Users should, the first time they
 run M2, call the setup function: 'setup()':
   /sw/bin/M2 -e'setup();exit 0'
 This will place Macaulay2 support for emacs into the user's ~/.emacs file, 
 backing up the file, if it already existed.
<<
Homepage: http://www.math.uiuc.edu/Macaulay2
Maintainer: Dave Morrison <dmrrsn@users.sourceforge.net>
