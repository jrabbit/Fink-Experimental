Package: tetex-beta
Version: 2.0-rc2
Revision: 1
GCC: 3.1
Depends: %N-base, %N-x11tools, texinfo
BuildDepends: t1lib1, libpng3 (>= 1.0.12-3), libtiff (>= 3.5.7-5), libwww, x11
Conflicts: system-tetex, bundle-tetex
Provides: dialog, bundle-tetex
Replaces: bundle-tetex
Recommends: detex, ifmslide, latex2html, pdfscreen, pdfslide, ppower4, tex4ht, texpower
Suggests: foiltex
Source: ftp://cam.ctan.org/tex-archive/systems/unix/teTeX/2.0/distrib/tetex-src-2.0-rc2.tar.gz
Source-MD5: db66ec2d4741cf1d225ed087212f9156
SourceDirectory: tetex-src-%v
Patch: %f.patch
SetCPPFLAGS: -no-cpp-precomp
SetLDFLAGS: -flat_namespace
ConfigureParams: --enable-shared --datadir='${prefix}/share' --infodir='${prefix}/share/info' --mandir='${prefix}/share/man' --without-texinfo --disable-multiplatform --with-system-zlib --with-system-ncurses --with-system-pnglib --with-system-wwwlib --with-system-tifflib --with-sytem-t1lib
CompileScript: <<
 ./configure %c
 export DYLD_LIBRARY_PATH="%b/texk/kpathsea/SHARED" ; make
<<
InstallScript: <<
 export DYLD_LIBRARY_PATH="%b/texk/kpathsea/SHARED" ; make install prefix=%i texmf=%i/share/texmf

echo "create a local texmf tree"
 mkdir -p %i/etc/texmf.local/web2c
 chmod 775 %i/etc/texmf.local
 chmod 775 %i/etc/texmf.local/web2c
 %i/bin/mktexlsr %i/etc/texmf.local
 mkdir -p %i/etc/ls-R
 mv %i/etc/texmf.local/ls-R %i/etc/ls-R/texmf.local
 ln -s %p/etc/ls-R/texmf.local %i/etc/texmf.local/ls-R
 mkdir -p %i/share
 ln -s %p/etc/texmf.local %i/share/texmf-local

echo "the ls-R file is supplied in tetex-texmf"
 rm -f %i/share/texmf/ls-R

echo "readlink is supplied in Fink's debianutils package"
 rm -f %i/bin/readlink
 rm -f %i/share/man/man1/readlink.1

echo "prepare texi2html for the alternatives system"
 mv %i/bin/texi2html %i/bin/texi2html.tetex-base
 mv %i/share/man/man1/texi2html.1 %i/share/man/man1/texi2html.1.tetex-base

<<
DocFiles: LICENSE ChangeLog INSTALL PROBLEMS README QuickInstall
SplitOff: <<
 Package: %N-x11tools
 Depends: x11, %N-base (= %v-%r), %N-shlibs (= %v-%r)
 Conflicts: xdvi
 Files: <<
  bin/mf-nowin
  bin/mfw
  bin/oxdvi
  bin/oxdvi.bin
  bin/t1mapper
  bin/xdvi
  bin/xdvi.bin
  bin/xdvizilla
  share/man/man1/t1mapper.1
  share/man/man1/xdvi.1
  share/man/man1/xdvizilla.1
 <<
 DocFiles: LICENSE ChangeLog INSTALL PROBLEMS README QuickInstall
<<
SplitOff2: <<
 Package: %N-base
 Depends: t1lib1-shlibs, libpng3-shlibs, libwww-bin, libtiff-bin,  ghostscript | ghostscript-nox, fink (>= 0.9.3), tetex-texmf-beta, %N-shlibs (= %v-%r)
 Conflicts: pdftex, tetex-macosx, tetex-base
 Replaces: pdftex, tetex-macosx, tetex-base
 Provides: pdftex, tetex-macosx, tetex-base
 Recommends: xdvi | %N-x11tools
 Files: bin etc share/info share/man share/texmf
 InfoDocs: kpathsea.info web2c.info dvips.info latex.info
 DocFiles: LICENSE ChangeLog INSTALL PROBLEMS README QuickInstall
 PostInstScript: <<
  update-alternatives --install %p/bin/texi2html texi2html %p/bin/texi2html.tetex-base 40
  update-alternatives --install %p/share/man/man1/texi2html.1 texi2html.1 %p/share/man/man1/texi2html.1.tetex-base 40
  mktexlsr
  fmtutil --all
  texlinks
  mktexlsr
 <<
 PreRmScript: <<
  if [ $1 != "upgrade" ]; then
    update-alternatives --remove texi2html %p/bin/texi2html.tetex-base
    update-alternatives --remove texi2html.1 %p/share/man/man1/texi2html.1.tetex-base
  fi
  rm -f %p/share/texmf/web2c/*.efmt
  rm -f %p/share/texmf/web2c/*.log
  rm -f %p/share/texmf/web2c/*.fmt
  rm -f %p/share/texmf/web2c/*.base
  rm -f %p/share/texmf/web2c/*.mem
  rm -f %p/share/texmf/web2c/*.oft
 <<
<<
SplitOff3: <<
 Package: %N-shlibs
 Depends: libpng3-shlibs
 Files: lib/libkpathsea.*.dylib
 DocFiles: LICENSE ChangeLog INSTALL PROBLEMS README QuickInstall
<<
SplitOff4: <<
 Package: %N-dev
 Depends: %N-shlibs (= %v-%r)
 Files: lib/libkpathsea.a lib/libkpathsea.dylib include
 DocFiles: LICENSE ChangeLog INSTALL PROBLEMS README QuickInstall
<<
License: OSI-Approved
Description: TeTeX is an implementation of TeX for UNIX
DescDetail: <<
TeX takes a text file and a set of formatting commands as input and 
creates a typesetter independent .dvi (DeVice Independent) file as output.
TeTeX includes higher level formatting packages such as LaTeX, since
TeX by itself is not very user-friendly.
<<
DescPort: <<
Lots of linker warnings are removed by 
   SetLDFLAGS: -flat_namespace

The Makefile is patched to prevent the mktexlsr, fmtutil, and texlinks
utilities from running during Fink's install phase.  They are run in the
PostInstall script.

To build shared libraries, we give the configure flag --enable-shared, set
the DYLD_LIBRARY_PATH environment variable, and patch klibtool.

We use update-alternatives for texi2html to allow users to install a
more up-to-date version if they choose.
<<
DescPackaging: <<
 Other TeX related packages should use %p/etc/texmf.local/ as their texmf
 tree for storing files, rather than %p/share/texmf/.  In this way, the
 original texmf tree will be preserved. 

 The X11-dependent parts have been splitoff to tetex-x11tools.

 texinfo is a separate package, and one can either install xdvi or
 tetex-x11tools (which contains xdvik).

 readlink and its manpage are removed since they conflict with debianutils,
  an essential package.

 Many thanks to the original teTeX maintainer Jeff Whitaker.
<<
Maintainer: Dave Morrison <dmrrsn@users.sourceforge.net>
Homepage: http://www.tug.org/teTeX
