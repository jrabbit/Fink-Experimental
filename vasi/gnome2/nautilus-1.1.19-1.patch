diff -Naur nautilus-1.1.19/Makefile.in nautilus-new/Makefile.in
--- nautilus-1.1.19/Makefile.in	2002-06-03 19:03:01.000000000 -0400
+++ nautilus-new/Makefile.in	2002-06-09 23:44:55.000000000 -0400
@@ -142,7 +142,7 @@
 DESKTOP_IN_FILES = nautilus.desktop.in
 DESKTOP_FILES = $(DESKTOP_IN_FILES:.desktop.in=.desktop)
 
-SUBDIRS =  	libnautilus 			cut-n-paste-code 		libbackground			libnautilus-private 		libnautilus-adapter		src 				test 				components			po 				data 				icons 				docs				$(NULL)
+SUBDIRS =  	libnautilus 			cut-n-paste-code 		libbackground			libnautilus-private 		libnautilus-adapter		src 				components			po 				data 				icons 				docs				$(NULL)
 
 
 EXTRA_DIST =  	COPYING.LIB					COPYING-DOCS					HACKING						MAINTAINERS					nautilus.spec.in				nautilus.desktop				nautilus.desktop.in				gnome-starthere-96.png				gnome-starthere.png				ChangeLog-20000414				ChangeLog-20000625				ChangeLog-20000831				ChangeLog-20001018				intltool-extract.in				intltool-merge.in				intltool-update.in				Makefile.shared					add-include-prefix				$(DESKTOP_IN_FILES)				$(DESKTOP_FILES)				$(NULL)
diff -Naur nautilus-1.1.19/components/Makefile.in nautilus-new/components/Makefile.in
--- nautilus-1.1.19/components/Makefile.in	2002-06-03 19:03:15.000000000 -0400
+++ nautilus-new/components/Makefile.in	2002-06-09 23:45:41.000000000 -0400
@@ -138,7 +138,7 @@
 
 NULL = 
 
-SUBDIRS =  	adapter                                 	hardware 					history 					loser 						music						notes 						sample 						text 						throbber 					tree 						$(NULL)
+SUBDIRS =  	adapter                                 	hardware 					history 					loser 						music						notes 						text 						throbber 					tree 						$(NULL)
 
 mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
 CONFIG_HEADER = ../config.h
diff -Naur nautilus-1.1.19/components/history/Nautilus_View_history.server.in nautilus-new/components/history/Nautilus_View_history.server.in
--- nautilus-1.1.19/components/history/Nautilus_View_history.server.in	2002-05-17 11:34:41.000000000 -0400
+++ nautilus-new/components/history/Nautilus_View_history.server.in	2002-06-10 00:13:52.000000000 -0400
@@ -1,6 +1,6 @@
 <oaf_info>
 
-<oaf_server iid="OAFIID:Nautilus_History_View" type="shlib" location="libnautilus-history-view.so">
+<oaf_server iid="OAFIID:Nautilus_History_View" type="shlib" location="@LIBDIR@/libnautilus-history-view.so">
 	<oaf_attribute name="repo_ids" type="stringv">
  		<item value="IDL:Bonobo/Unknown:1.0"/>
 		<item value="IDL:Bonobo/Control:1.0"/>
diff -Naur nautilus-1.1.19/components/notes/Nautilus_View_notes.server.in nautilus-new/components/notes/Nautilus_View_notes.server.in
--- nautilus-1.1.19/components/notes/Nautilus_View_notes.server.in	2002-05-17 11:34:41.000000000 -0400
+++ nautilus-new/components/notes/Nautilus_View_notes.server.in	2002-06-10 00:14:13.000000000 -0400
@@ -1,6 +1,6 @@
 <oaf_info>
 
-<oaf_server iid="OAFIID:Nautilus_Notes_View" type="shlib" location="libnautilus-notes-view.so">
+<oaf_server iid="OAFIID:Nautilus_Notes_View" type="shlib" location="@LIBDIR@/libnautilus-notes-view.so">
 	<oaf_attribute name="repo_ids" type="stringv">
 		<item value="IDL:Bonobo/Unknown:1.0"/>
 		<item value="IDL:Bonobo/Control:1.0"/>
diff -Naur nautilus-1.1.19/components/tree/Nautilus_View_tree.server.in nautilus-new/components/tree/Nautilus_View_tree.server.in
--- nautilus-1.1.19/components/tree/Nautilus_View_tree.server.in	2002-04-18 16:39:49.000000000 -0400
+++ nautilus-new/components/tree/Nautilus_View_tree.server.in	2002-06-10 00:13:26.000000000 -0400
@@ -1,6 +1,6 @@
 <oaf_info>
 
-<oaf_server iid="OAFIID:Nautilus_Tree_View" type="shlib" location="libnautilus-tree-view.so">
+<oaf_server iid="OAFIID:Nautilus_Tree_View" type="shlib" location="@LIBDIR@/libnautilus-tree-view.so">
 	<oaf_attribute name="repo_ids" type="stringv">
 		<item value="IDL:Bonobo/Unknown:1.0"/>
 		<item value="IDL:Bonobo/Control:1.0"/>
diff -Naur nautilus-1.1.19/configure nautilus-new/configure
--- nautilus-1.1.19/configure	2002-06-03 17:26:05.000000000 -0400
+++ nautilus-new/configure	2002-06-15 00:57:36.000000000 -0400
@@ -5497,7 +5497,7 @@
     # FIXME: Relying on posixy $() will cause problems for
     #        cross-compilation, but unfortunately the echo tests do not
     #        yet detect zsh echo's removal of \ escapes.
-    archive_cmds='$nonopt $(test "x$module" = xyes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib $libobjs $deplibs$linker_flags -install_name $rpath/$soname $verstring'
+    archive_cmds='$nonopt $(test x$module = xyes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib $libobjs $deplibs$linker_flags $(test x$module = xyes || echo -install_name $rpath/$soname $verstring)'
     # We need to add '_' to the symbols in $export_symbols first
     #archive_expsym_cmds="$archive_cmds"' && strip -s $export_symbols'
     hardcode_direct=yes
@@ -9828,7 +9828,8 @@
      INTLTOOL_KEYS_RULE='%.keys:      %.keys.in      $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*.po) ; $(INTLTOOL_MERGE) $(top_srcdir)/po $< $@ -k -u -c $(top_builddir)/po/.intltool-merge-cache'
       INTLTOOL_OAF_RULE='%.oaf:       %.oaf.in       $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*.po) ; $(INTLTOOL_MERGE) $(top_srcdir)/po $< $@ -o -p'
      INTLTOOL_PONG_RULE='%.pong:      %.pong.in      $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*.po) ; $(INTLTOOL_MERGE) $(top_srcdir)/po $< $@ -x -u -c $(top_builddir)/po/.intltool-merge-cache'
-   INTLTOOL_SERVER_RULE='%.server:    %.server.in    $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*.po) ; $(INTLTOOL_MERGE) $(top_srcdir)/po $< $@ -o -u -c $(top_builddir)/po/.intltool-merge-cache'
+   INTLTOOL_SERVER_RULE='%.server:    %.server.in    $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*.po) ; $(INTLTOOL_MERGE) $(top_srcdir)/po $< $@ -o -u -c $(top_builddir)/po/.intltool-merge-cache\
+%.server.in: Makefile ;	sed -e "s|\@LIBDIR\@|$(libdir)|" $@ > $@.tmp; mv -f $@.tmp $@ '
     INTLTOOL_SHEET_RULE='%.sheet:     %.sheet.in     $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*.po) ; $(INTLTOOL_MERGE) $(top_srcdir)/po $< $@ -x -u -c $(top_builddir)/po/.intltool-merge-cache'
 INTLTOOL_SOUNDLIST_RULE='%.soundlist: %.soundlist.in $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*.po) ; $(INTLTOOL_MERGE) $(top_srcdir)/po $< $@ -d -u -c $(top_builddir)/po/.intltool-merge-cache'
        INTLTOOL_UI_RULE='%.ui:        %.ui.in        $(INTLTOOL_MERGE) $(wildcard $(top_srcdir)/po/*.po) ; $(INTLTOOL_MERGE) $(top_srcdir)/po $< $@ -x -u -c $(top_builddir)/po/.intltool-merge-cache'
diff -Naur nautilus-1.1.19/libnautilus-private/nautilus-medusa-support.c nautilus-new/libnautilus-private/nautilus-medusa-support.c
--- nautilus-1.1.19/libnautilus-private/nautilus-medusa-support.c	2001-10-28 15:21:46.000000000 -0500
+++ nautilus-new/libnautilus-private/nautilus-medusa-support.c	2002-06-10 00:23:41.000000000 -0400
@@ -30,6 +30,7 @@
 
 #include <eel/eel-glib-extensions.h>
 #include <eel/eel-string.h>
+#include <stdint.h>
 #include <dirent.h>
 #include <stdio.h>
 #include <sys/types.h>
diff -Naur nautilus-1.1.19/libnautilus-private/nautilus-volume-monitor.c nautilus-new/libnautilus-private/nautilus-volume-monitor.c
--- nautilus-1.1.19/libnautilus-private/nautilus-volume-monitor.c	2002-05-23 10:40:19.000000000 -0400
+++ nautilus-new/libnautilus-private/nautilus-volume-monitor.c	2002-06-10 00:40:57.000000000 -0400
@@ -95,6 +95,10 @@
 #include <sys/ucred.h>
 #endif
 
+#ifdef MACOSX
+#define HAVE_SYS_MOUNT_H
+#endif
+
 #ifdef HAVE_SYS_MOUNT_H
 #include <sys/mount.h>
 #endif
@@ -1035,6 +1039,30 @@
 static GList *
 get_mount_list (NautilusVolumeMonitor *monitor) 
 {
+#ifdef MACOSX
+	GList *volumes = NULL;
+	struct statfs *fsinfos = NULL;
+	int fsnum, fsidx;
+	
+	fsnum = getmntinfo(&fsinfos, MNT_WAIT);
+	if (fsnum == -1) {
+		g_warning ("Unable to stat filesystems.");
+		return NULL;
+	}
+	
+	for (fsidx = 0; fsidx < fsnum; ++fsidx) {
+		struct statfs afs = fsinfos[fsidx];
+		NautilusVolume *volume = NULL;
+		
+		volume = create_volume (afs.f_mntfromname, afs.f_mntonname);
+		if (afs.f_flags & MNT_RDONLY)
+			volume->is_read_only = TRUE;
+		volumes = finish_creating_volume_and_prepend
+			(monitor, volume, afs.f_fstypename, volumes);
+  	}
+  	
+  	return volumes;
+#else /* !MACOSX */
         GList *volumes;
         NautilusVolume *volume;
 	static time_t last_mtime = 0;
@@ -1119,6 +1147,7 @@
         saved_list = volumes;
 	
         return copy_mount_list (volumes);
+#endif /* !MACOSX */
 }
 
 #endif /* !SOLARIS_MNT */
diff -Naur nautilus-1.1.19/ltmain.sh nautilus-new/ltmain.sh
--- nautilus-1.1.19/ltmain.sh	2002-05-30 10:55:18.000000000 -0400
+++ nautilus-new/ltmain.sh	2002-06-14 23:00:36.000000000 -0400
@@ -1739,7 +1739,7 @@
 
 	  if test "$installed" = no; then
 	    notinst_deplibs="$notinst_deplibs $lib"
-	    need_relink=yes
+	    # need_relink=yes
 	  fi
 
 	  if test -n "$old_archive_from_expsyms_cmds"; then
@@ -2894,8 +2894,19 @@
 	if test -n "$export_symbols" && test -n "$archive_expsym_cmds"; then
 	  eval cmds=\"$archive_expsym_cmds\"
 	else
-	  eval cmds=\"$archive_cmds\"
-	fi
+      save_deplibs="$deplibs"
+      for conv in $convenience; do
+    tmp_deplibs=
+    for test_deplib in $deplibs; do
+      if test "$test_deplib" != "$conv"; then
+        tmp_deplibs="$tmp_deplibs $test_deplib"
+      fi
+    done
+    deplibs="$tmp_deplibs"
+      done
+      eval cmds=\"$archive_cmds\"
+      deplibs="$save_deplibs"
+    fi
 	save_ifs="$IFS"; IFS='~'
 	for cmd in $cmds; do
 	  IFS="$save_ifs"
