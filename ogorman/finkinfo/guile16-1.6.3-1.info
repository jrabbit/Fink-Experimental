Package: guile16
Version: 1.6.3
Revision: 1
BuildDepends: dlcompat-dev, readline
Depends: %N-shlibs (= %v-%r), %N-libs (= %v-%r)
Source: mirror:gnu:guile/guile-%v.tar.gz
Source-MD5: d29bd197ef776b339d942d82d8ba8bdf
Patch: %f.patch
ConfigureParams: --infodir=%p/share/info --program-transform-name="s|guile|guile\-1\.6|g"
NoSetCPPFLAGS: true
NoSetLDFLAGS: true
SetCPPFLAGS: -no-cpp-precomp -Dmacosx
CompileScript: <<
#! /bin/sh -ex
  export LIBRARY_PATH=/sw/lib
  export CPATH=/sw/include
  export DYLD_LIBRARY_PATH=/sw/lib
  ./configure %c
  echo "#undef LTDL_DLOPEN_DEPLIBS" >> config.h
  echo "#define LTDL_SHLIB_EXT \".so\"" >> config.h
  make
<<
InstallScript: <<
 make install DESTDIR=%d
 perl -pi -e "s|%p/bin/guile|%p/bin/guile\-1\.6|" %i/bin/guile-1.6-config
 perl -pi -e "s|GUILE,guile|GUILE,guile\-1\.6|" %i/share/aclocal/guile.m4
 perl -pi -e "s|GUILE_CONFIG,guile\-config|GUILE_CONFIG,guile\-1\.6\-config|" %i/share/aclocal/guile.m4
 perl -pi -e "s|GUILE_TOOLS,guile\-tools|GUILE_TOOLS,guile\-1\.6\-tools|" %i/share/aclocal/guile.m4  
<<
SplitOff: <<
  Package: %N-shlibs
  Depends: dlcompat-shlibs
  Files: <<
    lib/libguile.*.dylib
    lib/libguile-ltdl.1.0.0.dylib
    lib/libguile-ltdl.1.dylib
  <<
  DocFiles: COPYING
  Shlibs: <<
  %p/lib/libguile.12.dylib 16.0.0 %n (>= 1.6.3-1)
  %p/lib/libguile-ltdl.1.dylib 2.0.0 %n (>= 1.6.3-1)
  <<
  Description: Shared libraries for guile16
<<
SplitOff2: <<
  Package: %N-libs
  Files: <<
    lib/libguile-srfi-srfi-13-14-v-1.*
    lib/libguile-srfi-srfi-4-v-1.*
    lib/libguilereadline-v-12.*
    share/guile/1.6
  <<
  DocFiles: COPYING
  Depends: readline-shlibs, %N-shlibs (= %v-%r)
  Description: Scheme libraries and modules for guile16
<<
SplitOff3: <<
  Package: %N-dev
  BuildDependsOnly: True
  Depends: %N-shlibs (= %v-%r)
  Replaces: guile-dev
  Conflicts: guile-dev
  Files: <<
    include
    share/aclocal
    lib/libguile.a
    lib/libguile.la
    lib/libguile.dylib
    lib/libguile-ltdl.dylib
    lib/libguile-ltdl.la
    lib/libguile-ltdl.a
  <<
  DocFiles: COPYING
  Description: Development package for guile16  
<<
DocFiles: README COPYING AUTHORS HACKING NEWS THANKS
InfoDocs: guile.info guile-tut.info goops.info r5rs.info
#
Description: Embedable Scheme interpreter
DescPort: <<
Thread support currently disabled (configure's default).
"borrowed" a patch from darwinports to posix.c makes it
pass make check.
Patched libtool to make it build two level namespace and
ensure it links against the just built libs.
Patched makefiles to replace -export-dynamic with -module.
Made the main packages not conflict with guile-1.4
<<
License: GPL
Homepage: http://www.gnu.org/software/guile/guile.html
Maintainer: Peter O'Gorman <peter@pogma.com>