diff -Naur guile-1.6.3.old/configure guile-1.6.3/configure
--- guile-1.6.3.old/configure	Sun Feb  2 03:04:21 2003
+++ guile-1.6.3/configure	Thu Mar 13 23:31:56 2003
@@ -4355,6 +4355,7 @@
     lt_cv_file_magic_test_file='/usr/lib/libSystem.dylib'
     ;;
   esac
+  lt_cv_deplibs_check_method=pass_all
   ;;
 
 freebsd*)
@@ -6268,7 +6269,8 @@
     archive_cmds='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs && $CC $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib ${lib}-master.o $deplibs$linker_flags $(test .$module != .yes && echo -install_name $rpath/$soname $verstring)'
     # We need to add '_' to the symbols in $export_symbols first
     #archive_expsym_cmds="$archive_cmds"' && strip -s $export_symbols'
-    hardcode_direct=yes
+    hardcode_direct=no
+    hardcode_libdir_flag_spec=' '
     hardcode_shlibpath_var=no
     whole_archive_flag_spec='-all_load $convenience'
     ;;
diff -Naur guile-1.6.3.old/guile-readline/Makefile.in guile-1.6.3/guile-readline/Makefile.in
--- guile-1.6.3.old/guile-readline/Makefile.in	Sun Feb  2 03:50:53 2003
+++ guile-1.6.3/guile-readline/Makefile.in	Thu Mar 13 23:07:57 2003
@@ -132,7 +132,7 @@
 lib_LTLIBRARIES = libguilereadline-v-@LIBGUILEREADLINE_MAJOR@.la
 
 libguilereadline_v_@LIBGUILEREADLINE_MAJOR@_la_SOURCES = readline.c
-libguilereadline_v_@LIBGUILEREADLINE_MAJOR@_la_LIBADD = ../libguile/libguile.la
+libguilereadline_v_@LIBGUILEREADLINE_MAJOR@_la_LIBADD = ../libguile/libguile.la ../libguile-ltdl/libguile-ltdl.la
 libguilereadline_v_@LIBGUILEREADLINE_MAJOR@_la_LDFLAGS = -version-info @LIBGUILEREADLINE_INTERFACE@ \
-  -export-dynamic -no-undefined
+  -module -no-undefined 

diff -Naur guile-1.6.3.old/guile-readline/configure guile-1.6.3/guile-readline/configure
--- guile-1.6.3.old/guile-readline/configure	Sun Feb  2 03:04:39 2003
+++ guile-1.6.3/guile-readline/configure	Thu Mar 13 23:31:32 2003
@@ -3373,6 +3373,7 @@
     lt_cv_file_magic_test_file='/usr/lib/libSystem.dylib'
     ;;
   esac
+  lt_cv_deplibs_check_method=pass_all
   ;;
 
 freebsd*)
@@ -5759,7 +5760,8 @@
     archive_cmds='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs && $CC $(test .$module = .yes && echo -bundle || echo -dynamiclib) $allow_undefined_flag -o $lib ${lib}-master.o $deplibs$linker_flags $(test .$module != .yes && echo -install_name $rpath/$soname $verstring)'
     # We need to add '_' to the symbols in $export_symbols first
     #archive_expsym_cmds="$archive_cmds"' && strip -s $export_symbols'
-    hardcode_direct=yes
+    hardcode_direct=no
+    hardcode_libdir_flag_spec=' '
     hardcode_shlibpath_var=no
     whole_archive_flag_spec='-all_load $convenience'
     ;;
diff -Naur guile-1.6.3.old/libguile/posix.c guile-1.6.3/libguile/posix.c
--- guile-1.6.3.old/libguile/posix.c	Sun Dec  8 07:41:32 2002
+++ guile-1.6.3/libguile/posix.c	Thu Mar 13 23:06:40 2003
@@ -117,7 +117,12 @@
 
 #include <signal.h>
 
+#if defined(__APPLE__) && defined(__DYNAMIC__)
+#include <crt_externs.h>
+char ** environ = NULL;
+#else
 extern char ** environ;
+#endif
 
 #ifdef HAVE_GRP_H
 #include <grp.h>
@@ -1036,6 +1041,9 @@
 	    "then the return value is unspecified.")
 #define FUNC_NAME s_scm_environ
 {
+#if defined(__APPLE__) && defined(__DYNAMIC__)
+  environ = *_NSGetEnviron();
+#endif
   if (SCM_UNBNDP (env))
     return scm_makfromstrs (-1, environ);
   else
@@ -1213,6 +1221,13 @@
     SCM_MEMORY_ERROR;
   strncpy (ptr, SCM_STRING_CHARS (str), SCM_STRING_LENGTH (str));
   ptr[SCM_STRING_LENGTH (str)] = 0;
+#if defined(macosx)
+  if (!strchr(ptr, '=')) {
+    unsetenv(ptr);
+    rv = 0;
+  }
+  else
+#endif
   rv = putenv (ptr);
   if (rv < 0)
     SCM_SYSERROR;
diff -Naur guile-1.6.3.old/ltmain.sh guile-1.6.3/ltmain.sh
--- guile-1.6.3.old/ltmain.sh	Sun Feb  2 03:04:12 2003
+++ guile-1.6.3/ltmain.sh	Thu Mar 13 23:30:32 2003
@@ -1769,7 +1769,7 @@
 
 	  if test "$installed" = no; then
 	    notinst_deplibs="$notinst_deplibs $lib"
-	    need_relink=yes
+	    need_relink=no
 	  fi
 
 	  if test -n "$old_archive_from_expsyms_cmds"; then
diff -Naur guile-1.6.3.old/pre-inst-guile.in guile-1.6.3/pre-inst-guile.in
--- guile-1.6.3.old/pre-inst-guile.in	Sun Dec  8 07:41:28 2002
+++ guile-1.6.3/pre-inst-guile.in	Thu Mar 13 23:05:49 2003
@@ -50,6 +50,23 @@
     exit 1
 }
 
+# the load library path is needed during the install phase (when guile looks
+# for libraries in $prefix/lib, but they have not been installed yet)
+
+guile_libdir="${top_srcdir}/libguile/.libs:${top_srcdir}/libguile-ltdl/.libs"
+
+# handle DYLD_LIBRARY_PATH (no clobber)
+if [ x"$DYLD_LIBRARY_PATH" = x ] ; then
+    DYLD_LIBRARY_PATH="${guile_libdir}"
+else
+    # This hair prevents double inclusion.
+    # The ":" prevents prefix aliasing.
+    case x"$DYLD_LIBRARY_PATH" in x*${guile_libdir}:*) ;;
+      *) DYLD_LIBRARY_PATH="${guile_libdir}:$DYLD_LIBRARY_PATH" ;;
+    esac
+fi
+export DYLD_LIBRARY_PATH
+
 # handle GUILE_LOAD_PATH (no clobber)
 if [ x"$GUILE_LOAD_PATH" = x ] ; then
     GUILE_LOAD_PATH="${top_srcdir}"
diff -Naur guile-1.6.3.old/srfi/Makefile.in guile-1.6.3/srfi/Makefile.in
--- guile-1.6.3.old/srfi/Makefile.in	Sun Feb  2 03:04:35 2003
+++ guile-1.6.3/srfi/Makefile.in	Thu Mar 13 23:05:49 2003
@@ -190,14 +190,14 @@
 
 libguile_srfi_srfi_4_v_@LIBGUILE_SRFI_SRFI_4_MAJOR@_la_SOURCES = srfi-4.c
 nodist_libguile_srfi_srfi_4_v_@LIBGUILE_SRFI_SRFI_4_MAJOR@_la_SOURCES = srfi-4.x
-libguile_srfi_srfi_4_v_@LIBGUILE_SRFI_SRFI_4_MAJOR@_la_LIBADD = ../libguile/libguile.la
+libguile_srfi_srfi_4_v_@LIBGUILE_SRFI_SRFI_4_MAJOR@_la_LIBADD = ../libguile/libguile.la ../libguile-ltdl/libguile-ltdl.la
-libguile_srfi_srfi_4_v_@LIBGUILE_SRFI_SRFI_4_MAJOR@_la_LDFLAGS = -export-dynamic \
+libguile_srfi_srfi_4_v_@LIBGUILE_SRFI_SRFI_4_MAJOR@_la_LDFLAGS = -module \
   -version-info @LIBGUILE_SRFI_SRFI_4_INTERFACE@
 
 
 libguile_srfi_srfi_13_14_v_@LIBGUILE_SRFI_SRFI_13_14_MAJOR@_la_SOURCES = srfi-13.c srfi-14.c
 nodist_libguile_srfi_srfi_13_14_v_@LIBGUILE_SRFI_SRFI_13_14_MAJOR@_la_SOURCES = srfi-13.x srfi-14.x
-libguile_srfi_srfi_13_14_v_@LIBGUILE_SRFI_SRFI_13_14_MAJOR@_la_LIBADD = ../libguile/libguile.la
+libguile_srfi_srfi_13_14_v_@LIBGUILE_SRFI_SRFI_13_14_MAJOR@_la_LIBADD = ../libguile/libguile.la ../libguile-ltdl/libguile-ltdl.la
-libguile_srfi_srfi_13_14_v_@LIBGUILE_SRFI_SRFI_13_14_MAJOR@_la_LDFLAGS = -export-dynamic \
+libguile_srfi_srfi_13_14_v_@LIBGUILE_SRFI_SRFI_13_14_MAJOR@_la_LDFLAGS = -module \
   -version-info @LIBGUILE_SRFI_SRFI_13_14_INTERFACE@
 
