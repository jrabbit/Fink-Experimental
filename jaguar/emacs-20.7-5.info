Package: emacs
Version: 20.7
Revision: 5
Depends: x11
Conflicts: emacs-nox
Replaces: emacs-nox
Source: gnu
UpdateConfigGuess: true
Patch: %f.patch
SetLDFLAGS: -lncurses
PatchScript: <<
 mkdir xlibs
 cd xlibs; ln -s /usr/X11R6/lib/*.a .
<<
ConfigureParams: --with-x --with-x-toolkit=lucid --x-libraries=%b/xlibs --infodir='${prefix}/share/info' --mandir='${prefix}/share/man' --libexecdir='${prefix}/lib'
SetCPPFLAGS: -DXLIB_ILLEGAL_ACCESS
CompileScript: <<
 ./configure powerpc-apple-darwin %c
 make
<<
InstallScript: <<
 make install prefix=%i
 mv %i/bin/ctags %i/bin/ctags.emacs
 mv %i/share/man/man1/ctags.1 %i/share/man/man1/ctags.1.emacs
 mv %i/bin/etags %i/bin/etags.emacs
 mv %i/share/man/man1/etags.1 %i/share/man/man1/etags.1.emacs
 mv %i/bin/b2m %i/bin/b2m.emacs
 mv %i/bin/rcs-checkin %i/bin/rcs-checkin.emacs
 mkdir -p %i/share/doc/%n
 install -m 644 README %i/share/doc/%n/
 install -m 644 src/COPYING %i/share/doc/%n/COPYING
<<
#
InfoDocs: ccmode cl dired-x ediff emacs forms gnus info message mh-e
 reftex sc vip viper widget
PostInstScript: <<
update-alternatives --install %p/bin/ctags ctags %p/bin/ctags.emacs 40 --slave %p/share/man/man1/ctags.1 ctags.1 %p/share/man/man1/ctags.1.emacs
update-alternatives --install %p/bin/etags etags %p/bin/etags.emacs 60 --slave %p/share/man/man1/etags.1 etags.1 %p/share/man/man1/etags.1.emacs
update-alternatives --install %p/bin/b2m b2m %p/bin/b2m.emacs 40
update-alternatives --install %p/bin/rcs-checkin rcs-checkin %p/bin/rcs-checkin.emacs 40
<<
PreRmScript: <<
if [ $1 != "upgrade" ]; then
  update-alternatives --remove ctags %p/bin/ctags.emacs
  update-alternatives --remove etags %p/bin/etags.emacs
  update-alternatives --remove b2m %p/bin/b2m.emacs
  update-alternatives --remove rcs-checkin %p/bin/rcs-checkin.emacs
fi
<<
#
Description: Old, deprecated emacs package.
DescDetail: <<
This is the original fink emacs package. It is now obsolete and has 
been replaced by the emacs2x packages:

emacs20     - Version 20.7 with X11 support
emacs20-nox - Version 20.7 for terminal only
emacs21-nox - Version 21.1 for terminal only

This package will continue to exist for the indeterminate future,
but is no longer being maintained and will one day disappear. Users
are strongly encouraged to move to one of the newer packages.

--------------------

GNU Emacs is an extensible, customizable, self-documenting real-time
display editor. Through its extensibility, it is actually much more
than an editor. You can use it as a file manager, mail reader, web
browser, and for many other tasks. Some people even use it to control
their coffee machine.

This package installs GNU Emacs with support for the X window
system. If you don't want X11 support, install the emacs-nox package
instead.
<<
DescPackaging: <<
update-alternatives is used for ctags, etags, b2m and rcs-checkin to
allow parallel installation of xemacs.
<<
DescPort: <<
Uses Apple's patches to work with the Mach-O format. Needs a dirty
trick to link against the static X11 libraries; it doesn't work when
linked against the shared libraries.

Also needs a small patch to a Makefile to also link against Xpm,
which is required by the recent versions of Xaw.

The XLIB_ILLEGAL_ACCESS define seems to be needed to compile with
Xtools. There are reports that the static libraries in Xtools are
broken; if you have build problems you may want to try the binary
distribution.
<<
License: GPL
Homepage: http://www.gnu.org/software/emacs/emacs.html
Maintainer: None <fink-devel@lists.sourceforge.net>
