diff -ruN gnome-pilot-0.1.64.orig/capplet/gnome-pilot-cdialog.c gnome-pilot-0.1.64/capplet/gnome-pilot-cdialog.c
--- gnome-pilot-0.1.64.orig/capplet/gnome-pilot-cdialog.c	Thu Mar  1 16:39:07 2001
+++ gnome-pilot-0.1.64/capplet/gnome-pilot-cdialog.c	Tue Apr 23 11:38:22 2002
@@ -46,6 +46,7 @@
 
 	GtkWidget *settings_frame;
 	GtkWidget *sync_actions;
+	GtkWidget *sync_one_actions;
 	
 	GtkWidget *options_frame;;
 };
@@ -156,6 +157,7 @@
 
 	priv->settings_frame = GW ("settings_frame");
 	priv->sync_actions = GW ("sync_actions_menu");
+	priv->sync_one_actions = GW ("sync_one_actions_menu");
 	
 	priv->options_frame = GW ("options_frame");
 
@@ -196,7 +198,9 @@
 
 	if (priv->state) {
 		fill_conduit_sync_type_menu (GTK_OPTION_MENU (priv->sync_actions), priv->state);
-		
+		if (priv->state->default_sync_type != GnomePilotConduitSyncTypeCustom)
+		fill_conduit_first_sync_type_menu (GTK_OPTION_MENU (priv->sync_one_actions), priv->state);
+
 		if (!priv->state->has_settings) {
 			gtk_widget_hide (priv->options_frame);
 
@@ -228,6 +232,21 @@
 	return GPOINTER_TO_INT (gtk_object_get_data (GTK_OBJECT (menu_item), "sync_type"));
 }
 
+
+GnomePilotConduitSyncType 
+gnome_pilot_cdialog_first_sync_type (GnomePilotCDialog *gpcd)
+{
+	GnomePilotCDialogPrivate *priv;
+	GtkWidget *menu, *menu_item;
+	
+	priv = gpcd->priv;
+	
+	menu = gtk_option_menu_get_menu (GTK_OPTION_MENU (priv->sync_one_actions));
+	menu_item = gtk_menu_get_active (GTK_MENU (menu));
+	
+	return GPOINTER_TO_INT (gtk_object_get_data (GTK_OBJECT (menu_item), "sync_type"));
+}
+
 gboolean
 gnome_pilot_cdialog_run_and_close (GnomePilotCDialog *gpcd)
 {
@@ -252,6 +271,7 @@
 	
 	disable = (gnome_pilot_cdialog_sync_type (gpcd) == GnomePilotConduitSyncTypeNotSet);
 	
+	gtk_widget_set_sensitive (priv->sync_one_actions, !disable);
 	gtk_widget_set_sensitive (priv->options_frame, !disable);
 }
 
diff -ruN gnome-pilot-0.1.64.orig/capplet/gnome-pilot-conduitcap.c gnome-pilot-0.1.64/capplet/gnome-pilot-conduitcap.c
--- gnome-pilot-0.1.64.orig/capplet/gnome-pilot-conduitcap.c	Tue Apr 24 21:24:17 2001
+++ gnome-pilot-0.1.64/capplet/gnome-pilot-conduitcap.c	Tue Apr 23 11:40:35 2002
@@ -571,6 +571,7 @@
 		if (gnome_pilot_cdialog_run_and_close (GNOME_PILOT_CDIALOG (state->settings_widget2))) {
 			/* pressed ok */
 			state->sync_type = gnome_pilot_cdialog_sync_type (GNOME_PILOT_CDIALOG (state->settings_widget2));
+			state->first_sync_type = gnome_pilot_cdialog_first_sync_type (GNOME_PILOT_CDIALOG (state->settings_widget2));
 			state->enabled = (state->sync_type != GnomePilotConduitSyncTypeNotSet);
 			state->changed=TRUE;
 			
@@ -675,8 +676,10 @@
 			else
 				gnome_pilot_conduit_config_enable_with_first_sync (state->config,
 										   state->sync_type,
-										   state->sync_type,
-										   TRUE);
+										   state->first_sync_type,
+ 										   TRUE);
+			if (state->first_sync_type == GnomePilotConduitSyncTypeNotSet)
+				gnome_pilot_conduit_config_remove_first_sync (state->config);
 		}
 		
 		if (state->changed && !state->enabled)
@@ -716,6 +719,7 @@
 			
 			state->enabled = state->orig_enabled;
 			state->sync_type = state->orig_sync_type;
+			state->first_sync_type = state->orig_first_sync_type;
 		}
 		
 		if (state->changed && !state->orig_enabled) {
diff -ruN gnome-pilot-0.1.64.orig/capplet/gpilotd-capplet-strings.c gnome-pilot-0.1.64/capplet/gpilotd-capplet-strings.c
--- gnome-pilot-0.1.64.orig/capplet/gpilotd-capplet-strings.c	Tue May  8 10:23:08 2001
+++ gnome-pilot-0.1.64/capplet/gpilotd-capplet-strings.c	Tue Apr 23 11:44:31 2002
@@ -28,16 +28,12 @@
 gchar *s = N_("Name");
 gchar *s = N_("Port");
 gchar *s = N_("Speed");
-gchar *s = N_("/dev/pilot\n"
-              "/dev/ttyS0\n"
-              "/dev/ttyS1\n"
-              "/dev/ttyS2\n"
-              "/dev/ttyS3\n"
-              "/dev/ttyqe\n"
-              "");
+gchar *s = N_("/dev/ttyS0");
+gchar *s = N_("/dev/ttyS1");
+gchar *s = N_("/dev/ttyS2");
+gchar *s = N_("/dev/ttyS3");
+gchar *s = N_("/dev/ttyqe");
 gchar *s = N_("/dev/pilot");
-gchar *s = N_("\n"
-              "");
 gchar *s = N_("Type");
 gchar *s = N_("Serial");
 gchar *s = N_("Handspring USB");
@@ -56,12 +52,8 @@
 gchar *s = N_("Pilot Name");
 gchar *s = N_("Local basedir");
 gchar *s = N_("Sync Action");
-gchar *s = N_("\n"
-              "");
 gchar *s = N_("Choose Device");
 gchar *s = N_("Choose Device");
-gchar *s = N_("\n"
-              "");
 gchar *s = N_("Gnome Pilot Settings");
 gchar *s = N_("Welcome to gnome-pilot!");
 gchar *s = N_("You seem to be running gnome-pilot for the first time.\n"
@@ -75,15 +67,12 @@
 gchar *s = N_("Name");
 gchar *s = N_("Port");
 gchar *s = N_("Speed");
-gchar *s = N_("/dev/pilot\n"
-              "/dev/ttyS0\n"
-              "/dev/ttyS1\n"
-              "/dev/ttyS2\n"
-              "/dev/ttyS3\n"
-              "");
 gchar *s = N_("/dev/pilot");
-gchar *s = N_("\n"
-              "");
+gchar *s = N_("/dev/ttyS0");
+gchar *s = N_("/dev/ttyS1");
+gchar *s = N_("/dev/ttyS2");
+gchar *s = N_("/dev/ttyS3");
+gchar *s = N_("/dev/pilot");
 gchar *s = N_("Serial");
 gchar *s = N_("Handspring USB");
 gchar *s = N_("IrDA");
@@ -106,8 +95,6 @@
 gchar *s = N_("Set the root directory for all pilot files to be stored.");
 gchar *s = N_("Sync Action");
 gchar *s = N_("Default conduit action for Synchronization. In most cases you don't want to change this setting, but individual conduits instead.");
-gchar *s = N_("\n"
-              "");
 gchar *s = N_("Success");
 gchar *s = N_("Congratulations, you have succesfully configured gnome-pilot!\n"
               "\n"
@@ -121,8 +108,6 @@
 gchar *s = N_("User Name:");
 gchar *s = N_("\n"
               "");
-gchar *s = N_("\n"
-              "");
 gchar *s = N_("Conduit");
 gchar *s = N_("Sync Action");
 gchar *s = N_("Enable");
@@ -130,7 +115,9 @@
 gchar *s = N_("Settings...");
 gchar *s = N_("Conduit Description");
 gchar *s = N_("Conduit Settings");
-gchar *s = N_("Conduit Action");
-gchar *s = N_("Disabled\n"
-              "");
+gchar *s = N_("Conduit Actions");
+gchar *s = N_("Disabled");
+gchar *s = N_("Action:");
+gchar *s = N_("One Time Action:");
+gchar *s = N_("None");
 gchar *s = N_("Conduit Settings");
diff -ruN gnome-pilot-0.1.64.orig/capplet/gpilotd-capplet.glade gnome-pilot-0.1.64/capplet/gpilotd-capplet.glade
--- gnome-pilot-0.1.64.orig/capplet/gpilotd-capplet.glade	Mon Mar 12 14:19:55 2001
+++ gnome-pilot-0.1.64/capplet/gpilotd-capplet.glade	Tue Apr 23 11:52:30 2002
@@ -144,6 +144,7 @@
 	  <can_default>True</can_default>
 	  <can_focus>True</can_focus>
 	  <label>Add...</label>
+	  <relief>GTK_RELIEF_NORMAL</relief>
 	</widget>
 
 	<widget>
@@ -152,6 +153,7 @@
 	  <can_default>True</can_default>
 	  <can_focus>True</can_focus>
 	  <label>Edit...</label>
+	  <relief>GTK_RELIEF_NORMAL</relief>
 	</widget>
 
 	<widget>
@@ -160,6 +162,7 @@
 	  <can_default>True</can_default>
 	  <can_focus>True</can_focus>
 	  <label>Delete</label>
+	  <relief>GTK_RELIEF_NORMAL</relief>
 	</widget>
       </widget>
     </widget>
@@ -282,6 +285,7 @@
 	  <can_default>True</can_default>
 	  <can_focus>True</can_focus>
 	  <label>Add...</label>
+	  <relief>GTK_RELIEF_NORMAL</relief>
 	</widget>
 
 	<widget>
@@ -290,6 +294,7 @@
 	  <can_default>True</can_default>
 	  <can_focus>True</can_focus>
 	  <label>Edit...</label>
+	  <relief>GTK_RELIEF_NORMAL</relief>
 	</widget>
 
 	<widget>
@@ -298,6 +303,7 @@
 	  <can_default>True</can_default>
 	  <can_focus>True</can_focus>
 	  <label>Delete</label>
+	  <relief>GTK_RELIEF_NORMAL</relief>
 	</widget>
       </widget>
     </widget>
@@ -1044,6 +1050,7 @@
 	      <tooltip>Get User Name and ID from existing pilot that was used before.</tooltip>
 	      <can_focus>True</can_focus>
 	      <label>Get from pilot</label>
+	      <relief>GTK_RELIEF_NORMAL</relief>
 	      <child>
 		<padding>0</padding>
 		<expand>False</expand>
@@ -2395,6 +2402,7 @@
 	  <can_default>True</can_default>
 	  <can_focus>True</can_focus>
 	  <label>Enable</label>
+	  <relief>GTK_RELIEF_NORMAL</relief>
 	</widget>
 
 	<widget>
@@ -2403,6 +2411,7 @@
 	  <can_default>True</can_default>
 	  <can_focus>True</can_focus>
 	  <label>Disable</label>
+	  <relief>GTK_RELIEF_NORMAL</relief>
 	</widget>
 
 	<widget>
@@ -2516,7 +2525,7 @@
       <class>GtkFrame</class>
       <name>settings_frame</name>
       <border_width>4</border_width>
-      <label>Conduit Action</label>
+      <label>Conduit Actions</label>
       <label_xalign>0</label_xalign>
       <shadow_type>GTK_SHADOW_ETCHED_IN</shadow_type>
       <child>
@@ -2526,13 +2535,112 @@
       </child>
 
       <widget>
-	<class>GtkOptionMenu</class>
-	<name>sync_actions_menu</name>
-	<border_width>5</border_width>
-	<can_focus>True</can_focus>
-	<items>Disabled
+	<class>GtkTable</class>
+	<name>table12</name>
+	<border_width>4</border_width>
+	<rows>2</rows>
+	<columns>2</columns>
+	<homogeneous>True</homogeneous>
+	<row_spacing>0</row_spacing>
+	<column_spacing>4</column_spacing>
+
+	<widget>
+	  <class>GtkOptionMenu</class>
+	  <name>sync_actions_menu</name>
+	  <can_focus>True</can_focus>
+	  <items>Disabled
 </items>
-	<initial_choice>0</initial_choice>
+	  <initial_choice>0</initial_choice>
+	  <child>
+	    <left_attach>1</left_attach>
+	    <right_attach>2</right_attach>
+	    <top_attach>0</top_attach>
+	    <bottom_attach>1</bottom_attach>
+	    <xpad>0</xpad>
+	    <ypad>0</ypad>
+	    <xexpand>False</xexpand>
+	    <yexpand>False</yexpand>
+	    <xshrink>False</xshrink>
+	    <yshrink>False</yshrink>
+	    <xfill>True</xfill>
+	    <yfill>False</yfill>
+	  </child>
+	</widget>
+
+	<widget>
+	  <class>GtkLabel</class>
+	  <name>label150</name>
+	  <label>Action:</label>
+	  <justify>GTK_JUSTIFY_CENTER</justify>
+	  <wrap>False</wrap>
+	  <xalign>0</xalign>
+	  <yalign>0.5</yalign>
+	  <xpad>0</xpad>
+	  <ypad>0</ypad>
+	  <child>
+	    <left_attach>0</left_attach>
+	    <right_attach>1</right_attach>
+	    <top_attach>0</top_attach>
+	    <bottom_attach>1</bottom_attach>
+	    <xpad>0</xpad>
+	    <ypad>0</ypad>
+	    <xexpand>False</xexpand>
+	    <yexpand>False</yexpand>
+	    <xshrink>False</xshrink>
+	    <yshrink>False</yshrink>
+	    <xfill>True</xfill>
+	    <yfill>False</yfill>
+	  </child>
+	</widget>
+
+	<widget>
+	  <class>GtkLabel</class>
+	  <name>label151</name>
+	  <label>One Time Action:</label>
+	  <justify>GTK_JUSTIFY_CENTER</justify>
+	  <wrap>False</wrap>
+	  <xalign>0</xalign>
+	  <yalign>0.5</yalign>
+	  <xpad>0</xpad>
+	  <ypad>0</ypad>
+	  <child>
+	    <left_attach>0</left_attach>
+	    <right_attach>1</right_attach>
+	    <top_attach>1</top_attach>
+	    <bottom_attach>2</bottom_attach>
+	    <xpad>0</xpad>
+	    <ypad>0</ypad>
+	    <xexpand>False</xexpand>
+	    <yexpand>False</yexpand>
+	    <xshrink>False</xshrink>
+	    <yshrink>False</yshrink>
+	    <xfill>True</xfill>
+	    <yfill>False</yfill>
+	  </child>
+	</widget>
+
+	<widget>
+	  <class>GtkOptionMenu</class>
+	  <name>sync_one_actions_menu</name>
+	  <can_focus>True</can_focus>
+	  <items>None
+</items>
+	  <initial_choice>0</initial_choice>
+	  <child>
+	    <left_attach>1</left_attach>
+	    <right_attach>2</right_attach>
+	    <top_attach>1</top_attach>
+	    <bottom_attach>2</bottom_attach>
+	    <xpad>0</xpad>
+	    <ypad>0</ypad>
+	    <xexpand>False</xexpand>
+	    <yexpand>False</yexpand>
+	    <xshrink>False</xshrink>
+	    <yshrink>False</yshrink>
+	    <xfill>True</xfill>
+	    <yfill>False</yfill>
+	  </child>
+	</widget>
       </widget>
     </widget>
 
diff -ruN gnome-pilot-0.1.64.orig/capplet/pilot.c gnome-pilot-0.1.64/capplet/pilot.c
--- gnome-pilot-0.1.64.orig/capplet/pilot.c	Sun Sep 16 22:34:17 2001
+++ gnome-pilot-0.1.64/capplet/pilot.c	Tue Apr 23 11:54:21 2002
@@ -351,8 +351,14 @@
 
 		conduit_state->name = g_strdup ((gchar*)conduits->data);
 		conduit_state->pilot = pilot;
-		conduit_state->management = gnome_pilot_conduit_management_new (conduit_state->name, GNOME_PILOT_CONDUIT_MGMT_NAME);
-		conduit_state->config = gnome_pilot_conduit_config_new (conduit_state->management, pilot->pilot_id);
+		conduit_state->management = 
+			gnome_pilot_conduit_management_new (conduit_state->name,
+							    GNOME_PILOT_CONDUIT_MGMT_NAME);
+		conduit_state->config =
+			gnome_pilot_conduit_config_new (conduit_state->management,
+							pilot->pilot_id);
+		gnome_pilot_conduit_config_load_config (conduit_state->config);
+
 		conduit_state->description = g_strdup ((gchar*) gnome_pilot_conduit_management_get_attribute (conduit_state->management, "description", NULL));
 		conduit_state->icon = g_strdup ((gchar*)gnome_pilot_conduit_management_get_attribute (conduit_state->management, "icon", NULL));
 		if (conduit_state->icon == NULL || g_file_test (conduit_state->icon, G_FILE_TEST_ISFILE)==FALSE) {
@@ -377,6 +383,8 @@
 			conduit_state->orig_sync_type = conduit_state->sync_type;
 		else 
 			conduit_state->orig_sync_type = GnomePilotConduitSyncTypeNotSet;
+		conduit_state->first_sync_type = conduit_state->config->first_sync_type;
+		conduit_state->orig_first_sync_type = conduit_state->first_sync_type;
 		conduit_states = g_list_append (conduit_states, conduit_state);
 		conduits = conduits->next;
 			
diff -ruN gnome-pilot-0.1.64.orig/capplet/pilot.h gnome-pilot-0.1.64/capplet/pilot.h
--- gnome-pilot-0.1.64.orig/capplet/pilot.h	Tue Apr 24 21:24:17 2001
+++ gnome-pilot-0.1.64/capplet/pilot.h	Tue Apr 23 11:54:50 2002
@@ -42,6 +42,8 @@
 	gboolean                    enabled;
 	GnomePilotConduitSyncType   sync_type;
 	GnomePilotConduitSyncType   orig_sync_type;
+	GnomePilotConduitSyncType   first_sync_type;
+	GnomePilotConduitSyncType   orig_first_sync_type;
 	GnomePilotConduitSyncType   default_sync_type;
 	GnomePilotConduitManagement *management;
 	GnomePilotConduitConfig     *config;
diff -ruN gnome-pilot-0.1.64.orig/capplet/util.c gnome-pilot-0.1.64/capplet/util.c
--- gnome-pilot-0.1.64.orig/capplet/util.c	Mon Dec  3 04:00:27 2001
+++ gnome-pilot-0.1.64/capplet/util.c	Tue Apr 23 11:58:03 2002
@@ -24,8 +24,10 @@
 
 #include <stdio.h>
 #include <sys/stat.h>
+#include <errno.h>
 #include <ctype.h>
 #include <glade/glade.h>
+#include <errno.h>
 #include "util.h"
 
 static const guint speedList[] = {9600, 19200, 38400, 57600, 115200, 0};
@@ -33,8 +35,8 @@
 
 static const char *synctypes[] = {_("Use conduit settings"),
 				  _("Synchronize"),
-				  _("Copy from pilot"),
-				  _("Copy to pilot"),
+				  _("Pilot Replaces Desktop"),
+				  _("Desktop Replace Pilot"),
 				  _("Merge from pilot"),
 				  _("Merge to pilot"),
 				  NULL};
@@ -134,8 +136,37 @@
 				current = index + 1;
 		}
 	}
+
+	gtk_option_menu_set_menu (GTK_OPTION_MENU (option_menu), GTK_WIDGET (menu));
+	gtk_option_menu_set_history (GTK_OPTION_MENU (option_menu), current);
+}
+
+void 
+fill_conduit_first_sync_type_menu (GtkOptionMenu *option_menu, ConduitState *state)
+{
+	GtkWidget *menu_item;
+	GtkMenu   *menu;
+	GList *tmp;
+	int index, current=0;
 	
+	menu = GTK_MENU (gtk_menu_new ());
+
+	menu_item = gtk_menu_item_new_with_label(_("None"));
+	gtk_widget_show(menu_item);
+	gtk_object_set_data (GTK_OBJECT (menu_item), "sync_type", GINT_TO_POINTER (GnomePilotConduitSyncTypeNotSet));
+	gtk_menu_append (menu, menu_item);
 
+	tmp = state->valid_synctypes;
+	for (index = 0; tmp != NULL; tmp = tmp->next, index++) {
+		gint value = GPOINTER_TO_INT (tmp->data);
+		
+		menu_item = gtk_menu_item_new_with_label (sync_type_to_str (value));
+		gtk_widget_show (menu_item);
+		gtk_object_set_data (GTK_OBJECT (menu_item), "sync_type", GINT_TO_POINTER (value));
+		gtk_menu_append (menu,menu_item);
+		if (value == state->first_sync_type) 
+			current = index + 1;
+	}
 	gtk_option_menu_set_menu (GTK_OPTION_MENU (option_menu), GTK_WIDGET (menu));
 	gtk_option_menu_set_history (GTK_OPTION_MENU (option_menu), current);
 }
diff -ruN gnome-pilot-0.1.64.orig/capplet/util.h gnome-pilot-0.1.64/capplet/util.h
--- gnome-pilot-0.1.64.orig/capplet/util.h	Tue May  1 21:23:53 2001
+++ gnome-pilot-0.1.64/capplet/util.h	Tue Apr 23 11:58:33 2002
@@ -30,6 +30,7 @@
 void fill_speed_menu (GtkOptionMenu *optionMenu, guint default_speed);
 void fill_synctype_menu (GtkOptionMenu *optionMenu, GnomePilotConduitSyncType type);
 void fill_conduit_sync_type_menu (GtkOptionMenu *option_menu, ConduitState *state);
+void fill_conduit_first_sync_type_menu (GtkOptionMenu *option_menu, ConduitState *state);
 void show_popup_menu (GtkCList *list, GdkEventButton *event, GtkMenu *menu);
 
 /* Filtering callbacks */
diff -ruN gnome-pilot-0.1.64.orig/configure gnome-pilot-0.1.64/configure
--- gnome-pilot-0.1.64.orig/configure	Mon Dec  3 04:09:42 2001
+++ gnome-pilot-0.1.64/configure	Mon Apr 22 16:21:42 2002
@@ -2559,7 +2559,7 @@
 
 
 
-ALL_LINGUAS="az ca da de el es fi fr gl hu ja nl nn no pl pt pt_BR ru sk sv tr uk zh_TW"
+ALL_LINGUAS="az ca da de el es fi fr gl hu nl nn no pl pt pt_BR ru sk sv tr uk zh_TW"
 echo $ac_n "checking for working const""... $ac_c" 1>&6
 echo "configure:2565: checking for working const" >&5
 if eval "test \"`echo '$''{'ac_cv_c_const'+set}'`\" = set"; then
diff -ruN gnome-pilot-0.1.64.orig/configure.in gnome-pilot-0.1.64/configure.in
--- gnome-pilot-0.1.64.orig/configure.in	Mon Dec  3 04:00:26 2001
+++ gnome-pilot-0.1.64/configure.in	Tue Apr 23 11:33:59 2002
@@ -43,7 +43,7 @@
 
 dnl this should come after `AC_PROG_CC'
 
-ALL_LINGUAS="az ca da de el es fi fr gl hu ja nl nn no pl pt pt_BR ru sk sv tr uk zh_TW"
+ALL_LINGUAS="az ca da de el es fi fr gl hu nl nn no pl pt pt_BR ru sk sv tr uk zh_TW"
 AM_GNOME_GETTEXT
 dnl AM_GNU_GETTEXT
 
@@ -94,6 +94,7 @@
 
 
 AM_PATH_GLIB(1.2.0,,AC_MSG_ERROR(Test for GLIB failed.),[glib gmodule])
+AC_PILOT_LINK
 PILOT_LINK_CHECK(0.9.5)
 AC_SUBST(PILOT_LINK_VERSION)
 
diff -ruN gnome-pilot-0.1.64.orig/gpilotd/gpilotd.c gnome-pilot-0.1.64/gpilotd/gpilotd.c
--- gnome-pilot-0.1.64.orig/gpilotd/gpilotd.c	Mon Dec  3 04:00:31 2001
+++ gnome-pilot-0.1.64/gpilotd/gpilotd.c	Tue Apr 23 12:03:54 2002
@@ -38,6 +38,7 @@
 #include <sys/stat.h>
 #include <sys/wait.h>
 #include <sys/time.h>
+#include <sys/fcntl.h>
 
 #include <glib.h>
 #include <pwd.h>
@@ -118,20 +119,20 @@
 pilot_connect (GPilotDevice *device,int *error) 
 {
 	struct pi_sockaddr addr;
-	int sd;
+	int sd, listen_sd;
 	int ret;
     
 	if (device->type != PILOT_DEVICE_NETWORK) {
 		pilot_set_baud_rate (device);
 	}
 
-	if (!(sd = pi_socket (PI_AF_SLP, PI_SOCK_STREAM, PI_PF_PADP))) {
+	if (!(listen_sd = pi_socket (PI_AF_PILOT, PI_SOCK_STREAM, PI_PF_DLP))) {
 		g_warning ("pi_socket: %s",strerror (errno));
 		if (error) *error = 1;
 		return -1;
 	}
 	
-	addr.pi_family = PI_AF_SLP;
+	addr.pi_family = PI_AF_PILOT;
 
 /*
 	Most important for networking
@@ -145,29 +146,33 @@
 
 	strcpy (addr.pi_device,device->port);
 
-	ret = pi_bind (sd, (struct sockaddr*)&addr, sizeof (addr));
+	ret = pi_bind (listen_sd, (struct sockaddr*)&addr, sizeof (addr));
 	if (ret == -1) {
 		g_warning (_("Unable to bind to pilot"));
 		if (error) *error = 1;
+		pi_close(listen_sd);
 		return 0;
 	}
 
-	ret = pi_listen (sd,1);
+	ret = pi_listen (listen_sd,1);
 	if (ret != 0) {
 		g_warning ("pi_listen: %s", strerror (errno));
 		if (error) *error = 2;
+		pi_close(listen_sd);
 		return 0;
 	}
 
-	sd = pi_accept_to (sd, NULL,0, device->timeout); 
+	sd = pi_accept_to (listen_sd, NULL,0, device->timeout); 
 	if (sd == -1) {
 		g_warning ("pi_accept_to: %s", strerror (errno));
 		g_warning ("pi_accept_to: timeout was %d secs", device->timeout);
 		if (error) *error = 2;
+		pi_close(listen_sd);
 		return 0;
 	}
 
 	if (error) *error = 0;
+	pi_close(listen_sd);
 	return sd;
 }
 
@@ -634,7 +639,6 @@
 			}
 		}
 		pilot_disconnect (pfd);
-		close (pfd);
 	} else {
 		if (connect_error==1) return FALSE; /* remove this device */
 		else return TRUE;
@@ -830,6 +834,10 @@
 		if (line[0] == 'S') {
 			if (!strncmp (line + 4, "Product=Handspring Visor",
 				      24)) {
+				visor_exists = TRUE;
+				break;
+			} else if (!strncmp (line + 4, "Product=Palm Handheld",
+				      21)) {
 				visor_exists = TRUE;
 				break;
 			}
diff -ruN gnome-pilot-0.1.64.orig/utils/make-password.c gnome-pilot-0.1.64/utils/make-password.c
--- gnome-pilot-0.1.64.orig/utils/make-password.c	Sun Feb 27 05:04:00 2000
+++ gnome-pilot-0.1.64/utils/make-password.c	Tue Apr 23 12:05:07 2002
@@ -34,16 +34,16 @@
   char salt[3];
 
   if (argc < 2) {
-    fprintf(stderr,"usage:%s %s\n",argv[0],TTYPrompt);
+    fprintf(stderr,"usage:%s\n",argv[0]);
     exit(2);
   }
-  if (!(sd = pi_socket(PI_AF_SLP, PI_SOCK_STREAM, PI_PF_PADP))) {
+  if (!(sd = pi_socket(PI_AF_PILOT, PI_SOCK_STREAM, PI_PF_PADP))) {
     perror("pi_socket");
     exit(1);
   }
     
-  addr.pi_family = PI_AF_SLP;
-  strcpy(addr.pi_device,argv[1]);
+  addr.pi_family = PI_AF_PILOT;
+//  strcpy(addr.pi_device,argv[1]);
   
   ret = pi_bind(sd, (struct sockaddr*)&addr, sizeof(addr));
   if(ret == -1) {
