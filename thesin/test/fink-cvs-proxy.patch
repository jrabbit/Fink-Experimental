diff -ruN fink/perlmod/Fink/SelfUpdate.pm fink-thesin/perlmod/Fink/SelfUpdate.pm
--- fink/perlmod/Fink/SelfUpdate.pm	Sun Mar 31 12:54:00 2002
+++ fink-thesin/perlmod/Fink/SelfUpdate.pm	Thu Apr 11 13:40:12 2002
@@ -153,6 +153,7 @@
   my ($finkdir, $tempdir, $tempfinkdir);
   my ($username, $cvsuser, @testlist);
   my ($use_hardlinks, $cutoff, $cmd);
+  my ($proxy, $proxyport, $fullproxy, @fullproxy);
 
   $username = "root";
   if (exists $ENV{SUDO_USER}) {
@@ -214,13 +215,28 @@
   }
   unlink "$tempdir/README";
 
+  # find proxy info and use if present
+  $fullproxy = $config->param_default("ProxyHTTP", "");
+  if ($fullproxy) {
+    @fullproxy = split(/\s*\:\s*/, $fullproxy);
+    $proxy = $fullproxy[0];
+    $proxyport = $fullproxy[1];
+    $fullproxy = "#proxy=$proxy#proxyport=$proxyport";
+    &print_breaking("Seems you are running a proxy, make sure cvs-proxy is".
+                    "installed and fink is configured to use it properly).");
+  }
+
   # start the CVS fun
   chdir $tempdir or die "Can't cd to $tempdir: $!\n";
   if ($cvsuser eq "anonymous") {
     &print_breaking("Now logging into the CVS server. When CVS asks you ".
 		    "for a password, just press return (i.e. the password ".
 		    "is empty).");
-    $cmd = "cvs -d:pserver:anonymous\@cvs.sourceforge.net:/cvsroot/fink login";
+    if ($fullproxy) {
+      $cmd = "cvs -d:pserver$fullproxy:anonymous\@cvs.sourceforge.net:/cvsroot/fink login";
+    } else {
+      $cmd = "cvs -d:pserver:anonymous\@cvs.sourceforge.net:/cvsroot/fink login";
+    } 
     if ($username ne "root") {
       $cmd = "su $username -c '$cmd'";
     }
@@ -228,9 +244,17 @@
       die "Logging into the CVS server for anonymous read-only access failed.\n";
     }
 
-    $cmd = "cvs -z3 -d:pserver:anonymous\@cvs.sourceforge.net:/cvsroot/fink";
+    if ($fullproxy) {
+      $cmd = "cvs -z3 -d:pserver$fullproxy:anonymous\@cvs.sourceforge.net:/cvsroot/fink";
+    } else {
+      $cmd = "cvs -z3 -d:pserver:anonymous\@cvs.sourceforge.net:/cvsroot/fink";
+    }
   } else {
-    $cmd = "cvs -z3 -d:ext:$cvsuser\@cvs.sourceforge.net:/cvsroot/fink";
+    if ($fullproxy) {
+      $cmd = "cvs -z3 -d:ext$fullproxy:$cvsuser\@cvs.sourceforge.net:/cvsroot/fink";
+    } else {
+      $cmd = "cvs -z3 -d:ext:$cvsuser\@cvs.sourceforge.net:/cvsroot/fink";
+    }
     $ENV{CVS_RSH} = "ssh";
   }
   $cmd = "$cmd checkout -d fink packages";
