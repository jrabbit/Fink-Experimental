Package: cyrus21
Version: 2.1.13
Revision: 1
###
Depends: drac1-shlibs, cyrus-sasl2-shlibs, dlcompat-shlibs, net-snmp-shlibs | net-snmp-ssl-shlibs, db41-shlibs | db41-ssl-shlibs, openssl097-shlibs, %N-common
BuildDepends: drac1-dev, cyrus-sasl2-dev, dlcompat-dev, net-snmp-dev | net-snmp-ssl-dev, db41 | db41-ssl, openssl097-dev
###
CustomMirror: <<
  Primary: ftp://ftp.andrew.cmu.edu/pub/cyrus-mail/
  Secondary: ftp://ftp.andrew.cmu.edu/pub/cyrus-mail/OLD-VERSIONS/imap
<<
Source: mirror:custom:cyrus-imapd-%v.tar.gz
Source-MD5: ac3a4773c2f0fb2d0f9c5ec8669b7e65
###
UpdateConfigGuess: true
PatchScript: <<
  patch -b -p0 < contrib/drac_auth.patch
  sed -e 's,@FINKPREFIX@,%p,g' %a/%f.patch | patch -p1
<<
###
NoSetLDFLAGS: true
SetCPPFLAGS: -no-cpp-precomp
SetCFLAGS: -DDRAC_AUTH
SetLIBS: -L%p/lib -ldrac
###
DocFiles: COPYRIGHT README*
###
ConfigureParams: --with-bdb-incdir=%p/include/db4 --with-ucdsnmp=no --with-seen-db=skiplist --with-mboxlist-db=skiplist --with-syslogfacility=MAIL --with-pidfile=%p/var/run/cyrmaster.pid --with-tclsh=%p/bin/tclsh --with-cyrus-user=cyrus --with-cyrus-group=mail --with-idle=poll --with-drac=%p --enable-listext --enable-annotatemore --with-sasl=%p --with-auth=unix --enable-murder --with-openssl=%p --with-perl=/usr/bin/perl --with-lock=fcntl --with-cyrus-prefix=%p/lib/cyrus --includedir=%p/include/cyrus --datadir=%p/share/cyrus --sharedstatedir=%p/share/cyrus --localstatedir=%p/var/lib/cyrus --mandir=%p/share/man --infodir=%p/share/info --libexecdir=%p/lib
###
InstallScript: <<
  #!/bin/sh
  make install DESTDIR=%d

  # fix totaly broken location of the include files;
  # while at it, also avoid namespace colision, and move
  # lots of admin-only/system-only stuff to sbin and lib
  # also, do the renaming needed for alternatives
  # and fix the weird side-effect of setting the proper cyrus
  # location in configure.
  # make dirs and links to etc
  mkdir -p %i/etc/cron.daily
  mkdir -p %i/etc/cyrus
  mkdir -p %i/etc/defaults
  mkdir -p %i/etc/pam.d
  mkdir -p %i/etc/logcheck/ignore.d.server  
  mkdir -p %i/etc/logcheck/ignore.d.workstation  
  mkdir -p %i/include
  mkdir -p %i/lib/cyrus
  mkdir -p %i/share/icons/mini
  mkdir -p %i/share/man/man8 
  mkdir -p %i/share/snmp/mibs  
  mkdir -p %i/var/run/cyrus/socket
  mkdir -p %i/var/spool/cyrus  
  mkdir -p %i/var/spool/sieve  

  for i in master reconstruct quota deliver ; do \
     mv %i/lib/cyrus/bin/$$i %i/sbin/cyr$$i ;\
  done

  for i in mbpath ctl_mboxlist ctl_deliver ctl_cyrusdb squatter \
     tls_prune ipurge cyrdump cvt_cyrusdb chk_cyrus ; do \
     mv %i/lib/cyrus/bin/$$i %i/sbin/$$i ;\
  done

  mv %i/share/include/cyrus %i/include

  # for stuff in /etc
  install -m 644 fink/imapd.conf %i/etc
  install -m 644 fink/cyrus.conf %i/etc
  (cd fink ; for i in *.pam ;\
     do install -m 644 $$i %i/etc/pam.d/$${i%.pam} ;\
  done)

  # We rename some utils, so we need to sort out the manpages
  for i in master reconstruct quota deliver ; do \
    mv %i/share/man/man8/$$i.8 %i/share/man/man8/cyr$${i}.8 ; \
  done

  # And add our own manpages
  install -m 644 fink/cyrdump.8 %i/share/man/man8/cyrdump.8

  # SNMP files
  install -m 644 master/CYRUS-MASTER.mib %i/share/snmp/mibs/CYRUS-MASTER-MIB.txt

  # Install cyradm icons
  install -m 644 fink/cyradm-32x32.xpm %i/share/icons/cyradm.xpm
  install -m 644 fink/cyradm-16x16.xpm %i/share/icons/mini/cyradm.xpm

  # Install debian/fink-provided scripts
  install fink/cyrus-makedirs %i/sbin/cyrus-makedirs
  install -m 644 fink/get-backtrace.gdb %i/lib/cyrus/get-backtrace.gdb

  # and logcheck files
  install -m 644 fink/logcheck.ignore %i/etc/logcheck/ignore.d.workstation/cyrus21
  install -m 644 fink/logcheck.ignore %i/etc/logcheck/ignore.d.server/cyrus21

  # install Defaults
  install -m 644 fink/cyrus21.defaults %i/etc/defaults/cyrus21

  # install cron.daily script
  isntall -m 644 fink.cron.daily %i/etc/cron.daily/cyrus21

  # make links
  ln -s %p/var/spool/sieve %i/etc/sieve
  ln -s %p/sbin/cyrreconstruct %i/lib/cyrus/bin/reconstruct
  ln -s %p/sbin/cyrquota %i/lib/cyrus/bin/quota
<<
###
SplitOff: <<
  Package: %N-shlibs
  Description: Cyrus mail system (shared libraries)
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
    .
    This package contains the Cyrus shared libraries.
  <<
<<
SplitOff2: <<
  Package: %N-common
  Depends: logcheck, anacron
  Description: Cyrus mail system (common files)
  Files: <<
    etc/cron.daily
    etc/default
    etc/logcheck/ignore.d.server
    etc/logcheck/ignore.d.workstation
    var/spool/cyrus
    var/spool/sieve
    var/run/cyrus/socket
    sbin/cyrreconstruct  
    sbin/cyrquota  
    etc/*conf
    etc/pam.d/lmtp
    etc/pam.d/sieve
    etc/defaults/cyrus21
    sbin/cyr*
    sbin/ctl_*
    sbin/cvt_*
    sbin/chk_*
    sbin/ipurge
    sbin/tls_prune
    sbin/mbpath
    lib/cyrus/bin/reconstruct
    lib/cyrus/bin/quota
    lib/cyrus/bin/lmtpd
    lib/cyrus/bin/timsieved
    lib/cyrus/bin/notifyd
    lib/cyrus/bin/fud
    lib/cyrus/get-backtrace.gdb
    share/snmp
    share/man/man5/cyrus.conf.5
    share/man/man5/imapd.conf.5
    share/man/man8/cyrdump.8
    share/man/man8/cyrus-makedirs.8
    share/man/man8/mbpath.8
    share/man/man8/timsieved.8
    share/man/man8/notifyd.8
    share/man/man8/lmtpd.8
    share/man/man8/ctl_*.8
    share/man/man8/cvt_*.8
    share/man/man8/chk_*.8
    share/man/man8/fud.8
    share/man/man8/ipurge.8
    share/man/man8/tls_prune.8
    share/man/man8/cyrdeliver.8
    share/man/man8/cyrmaster.8
    share/man/man8/cyrreconstruct.8
    share/man/man8/cyrquota.8
  <<
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
     o IPv6 support
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your 
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
    .
    This package contains the common files needed by the other Cyrus
    components. The cyrus21-imapd and/or cyrus21-pop3d packages are needed
    to enable IMAP and POP3 support respectively. cyrus21-murder can be
    used to enable IMAP, POP3 and LMTP proxying.
  <<
<<
SplitOff3: <<
  Package: %N-doc
  Files: <<
    share/doc/cyrus21-doc/html/*.html
  <<
  Description: Cyrus mail system (documentation files)
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
     o IPv6 support
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your 
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
    .
    This package contains documentation for the Cyrus IMAPd suite.
  <<
<<
SplitOff4: <<
  Package: %N-imapd
  Files: <<
    etc/pam.d/imap
    lib/cyrus/bin/imapd
    sbin/squatter
    share/man/man8/idled.8
    share/man/man8/imapd.8
    share/man/man8/squatter.8
  <<
  Description: Cyrus mail system (IMAP support)
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
     o IPv6 support
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
    .
    This package contains support for IMAP (Internet Mail Access
    Protocol).
  <<
<<
SplitOff5: <<
  Package: %N-pop3d
  Files: <<
    etc/pam.d/pop
    sbin/pop3*
    lib/cyrus/bin/pop3d
    share/man/man8/pop3d*
  <<
  Description: Cyrus mail system (POP3 support)
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
     o IPv6 support
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
    .
    This package contains support for POP3 (Post Office Protocol).
  <<
<<
SplitOff6: <<
  Package: %N-admin
  Files: <<
    bin/cyradm
    bin/sieveshell
    share/icons/*
    share/man/man1/sieveshell.1
    share/man/man1/cyradm.1p
  <<
  Description: Cyrus mail system (administration tool)
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
     o IPv6 support
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
    .
    This package contains the cyradm tool which can be used to administer 
    both local and remote Cyrus mail systems.  It also contains sieveshell
    and its deprecated cousin installsieve, which can be used to manage
    sieve scripts.
  <<
<<
SplitOff7: <<
  Package: %N-murder
  Files: <<
    etc/pam.d/mupdate
    lib/cyrus/bin/*proxyd
    lib/cyrus/bin/mupdate*
  <<
  Description: Cyrus mail system (proxies and aggregator)
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
     o IPv6 support
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
    .
    This package contains Cyrus murder aggregator system, i.e. IMAP, POP3
    and LMTP proxies, and the mupdate mailbox master daemon.  It allows for
    cluster setups where there are many backend Cyrus spools and frontend
    proxy servers.
  <<
<<
SplitOff8: <<
  Package: %N-clients
  Files: <<
    bin/*test
    share/man/man1/*test.1
  <<
  Description: Cyrus mail system (test clients)
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
    .
    This package contains the mupdatetest, sivtest, smtptest, lmtptest,
    imtest and pop3test tools which can be used to interactivily talk to
    a mupdate, sieve, smtp, lmtp, imap or pop3 server.
    The clients are fully SASL-enabled for authentication.
  <<
<<
SplitOff9: <<
  Package: %N-dev
  Files: <<
    include/cyrus
    lib/*.a
    share/man/man3
  <<
  Description: Cyrus mail system (developer files)
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
     o IPv6 support
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
    .
    This package contains header files and the static library needed
    to develop IMAP applications that interface with Cyrus.
  <<
<<
SplitOff10: <<
  Package: libcyrus-imap-pm
  Files: <<
    lib/perl5
    share/man/man3/Cyrus::IMAP.3pm
    share/man/man3/Cyrus::IMAP::Admin.3pm
    share/man/man3/Cyrus::IMAP::IMSP.3pm
    share/man/man3/Cyrus::IMAP::Shell.3pm
    share/man/man3/Cyrus::SIEVE::managesieve.3pm
  <<
  Description: Interface to Cyrus imap client imclient library
  DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
     o IPv6 support
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    The Cyrus::IMAP module provides an interface to the Cyrus imclient
    library.  These are primarily useful for implementing cyradm operations
    within a Perl script; there are easier ways to implement general client
    operations, although they may be more limited in terms of authentication
    options when talking to a Cyrus imapd.
    .
    The modules that compose Cyrus::SIEVE are also included, but they are
    undocumented upstream.
  <<
<<
###
Description: Cyrus mail system
DescDetail: <<
    Cyrus is a fully-featured IMAP daemon, with a number of features not
    found in other IMAP implementations, including:
     o Designed to handle massive quantities of mail
     o No need for users to have login accounts
     o Support for POP3 in addition to IMAP
     o Sieve server-side email filtering
     o Servers don't run as root
     o Easy support for mail quotas
     o SSL support, including secure IMAP
     o DRAC support for pop/imap-before-smtp
    For more information, see http://asg.web.cmu.edu/cyrus/.
    .
    Note: Cyrus doesn't support reading from and storing mail in your
    standard mail spool - it stores mail in a separate directory in its
    own MH-like format.
<<
###
License: OSI-Approved
Maintainer: Justin F. Hallett <thesin@users.sourceforge.net>
Homepage: http://asg.web.cmu.edu/cyrus
