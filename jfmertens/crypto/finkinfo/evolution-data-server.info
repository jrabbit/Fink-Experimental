Package: evolution-data-server
Version: 1.6.2
Revision: 1
Source-MD5: 165f493eec8a2c8fc6eca3fdeb8c4885
Source: mirror:gnome:sources/%n/1.6/%n-%v.tar.bz2
BuildDepends: atk1, audiofile, cyrus-sasl2-dev, db43-ssl, esound, gconf2-dev, glib2-dev, gnome-vfs2-ssl-dev, gnutls12, gtk+2-dev, libart2, libbonobo2-dev, libgcrypt, libgettext3-dev, libglade2, libgnome2-dev, libgpg-error, libhowl-dev, libiconv-dev, libsoup2.2.8-ssl, libtasn1, libxml2, seamonkey-dev, openldap23-dev, openssl097-dev, orbit2-dev, pango1-xft2-dev, popt, pth2-dev, x11-dev, gettext-tools, scrollkeeper, pkgconfig, intltool, gtk-doc, orbit2
# db44-aes ?? ...
# gnome-keyring ? libjpeg ? libgnomecanvas2-dev ? libgnomeui2-dev ? libbonoboui2-dev ?
Depends: %N-shlibs (>= %v-%r), openldap23-shlibs
NoSetCPPFLAGS: true
SetCPPFLAGS: -no-cpp-precomp
NoSetLDFLAGS: true
SetLIBRARY_PATH: %p/lib
SetCFLAGS: -O3 -fstrict-aliasing -DLDAP_DEPRECATED=1
NoSetMAKEFLAGS: true
SetMAKEFLAGS: -j1
#  sed -i.bak -e '/^\#ifdef NEED_ADDRINFO/,/^\#endif/d' camel/camel-net-utils.h
PatchScript: <<
  perl -pi.bak -e 's,libdir\)/locale,datadir)/locale,' po/Makefile.in.in
  perl -pi.bak -e 's,unistd\.h>,$&\n#include <arpa/nameser_compat.h>,' servers/exchange/lib/e2k-autoconfig.c
<<
ConfigureParams: --enable-static --enable-ipv6=yes --enable-nntp=yes --enable-gtk-doc --with-krb4=/usr --with-krb5=/usr --with-openldap=yes --enable-smime=yes --with-nspr-includes=%p/include/seamonkey/nspr --with-nss-includes=%p/include/seamonkey/nss --with-nspr-libs=%p/lib/seamonkey --with-nss-libs=%p/lib/seamonkey --enable-reentrant --enable-maintainer-mode
CompileScript: <<
 #!/bin/sh -ev
 export CPATH=%p/include
 ./configure %c
 perl -pi -e 's,\-L/usr/lib([^/]),\2,g; s,\-I(/usr|%p)/include([^/]),\2,g' config.status
 make
<<
# Clean out '-L/usr/lib' (and maybe more ?) from the .la files _ else unsightly things in dep pkgs (eg, %N-exchange...)
# No longer necessary _ just remains the clean out of %p/lib
InstallScript: <<
 #!/bin/sh -ev
 export CPATH=%p/include
 make install prefix=%i
 find %i/lib -name '*\.la'|xargs perl -pi -e 's, \-[LR]%p/lib([^/]),\1,g'
<<
SplitOff: <<
  Package: %N-shlibs
  Depends: gnome-vfs2-ssl-shlibs, libglade2-shlibs, libgnome2-shlibs, libhowl-shlibs, libsoup2.2.8-ssl-shlibs, seamonkey-shlibs, pth2-shlibs
  Files: lib/libe*-1.2.*.dylib lib/libca*-1.2.*.dylib
  Shlibs: <<
    %p/lib/libcamel-1.2.0.dylib 1.0.0 %n (>= 1.6.0-1)
    %p/lib/libcamel-provider-1.2.8.dylib 9.0.0 %n (>= 1.6.0-1)
    %p/lib/libebook-1.2.5.dylib 8.0.0 %n (>= 1.6.0-1)
    %p/lib/libecal-1.2.3.dylib 6.0.0 %n (>= 1.6.0-1)
    %p/lib/libedata-book-1.2.2.dylib 5.0.0 %n (>= 1.6.0-1)
    %p/lib/libedata-cal-1.2.1.dylib 5.0.0 %n (>= 1.6.0-1)
    %p/lib/libedataserver-1.2.7.dylib 8.0.0 %n (>= 1.6.0-1)
    %p/lib/libedataserverui-1.2.6.dylib 8.0.0 %n (>= 1.6.0-1)
    %p/lib/libegroupwise-1.2.9.dylib 10.0.0 %n (>= 1.6.0-1)
    %p/lib/libexchange-storage-1.2.1.dylib 2.0.0 %n (>= 1.6.0-1)
  <<
  DocFiles: AUTHORS COPYING NEWS README
<<
SplitOff2: <<
  Package: %N-dev
  Depends: %N-shlibs (>= %v-%r)
  BuildDependsOnly: true
  Files: include lib/lib*-1.2.{dylib,la,a} lib/pkgconfig lib/evolution-data-server-1.2/camel-providers/*.{,l}a lib/evolution-data-server-1.2/extensions/*.{,l}a share/idl
  DocFiles: AUTHORS COPYING* ChangeLog NEWS README TODO
<<
DocFiles: AUTHORS COPYING NEWS README
Description: Evolution Data Server
Homepage: http://gnome.org/projects/evolution/
License: GPL
Maintainer: The Gnome Core Team <fink-gnome-core@lists.sourceforge.net>
